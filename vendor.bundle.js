/*! For license information please see vendor.bundle.js.LICENSE.txt */
(self.webpackChunktetfu_sp=self.webpackChunktetfu_sp||[]).push([[736],{4361:(t,e,n)=>{"use strict";n.r(e),n.d(e,{a:()=>a,abbr:()=>o,address:()=>s,area:()=>h,article:()=>u,aside:()=>l,audio:()=>c,b:()=>f,bdi:()=>d,bdo:()=>g,blockquote:()=>p,br:()=>v,button:()=>m,canvas:()=>y,caption:()=>_,cite:()=>b,code:()=>x,col:()=>w,colgroup:()=>S,data:()=>k,datalist:()=>C,dd:()=>P,del:()=>A,details:()=>T,dfn:()=>O,dialog:()=>L,div:()=>E,dl:()=>R,dt:()=>M,em:()=>G,embed:()=>I,fieldset:()=>D,figcaption:()=>F,figure:()=>N,footer:()=>j,form:()=>B,h1:()=>z,h2:()=>W,h3:()=>H,h4:()=>U,h5:()=>Y,h6:()=>q,header:()=>X,hr:()=>V,i:()=>K,iframe:()=>$,img:()=>J,input:()=>Q,ins:()=>Z,kbd:()=>tt,label:()=>et,legend:()=>nt,li:()=>rt,main:()=>it,map:()=>at,mark:()=>ot,menu:()=>st,menuitem:()=>ht,meter:()=>ut,nav:()=>lt,object:()=>ct,ol:()=>ft,optgroup:()=>dt,option:()=>gt,output:()=>pt,p:()=>vt,param:()=>mt,pre:()=>yt,progress:()=>_t,q:()=>bt,rp:()=>xt,rt:()=>wt,rtc:()=>St,ruby:()=>kt,s:()=>Ct,samp:()=>Pt,section:()=>At,select:()=>Tt,small:()=>Ot,source:()=>Lt,span:()=>Et,strong:()=>Rt,sub:()=>Mt,summary:()=>Gt,sup:()=>It,svg:()=>Dt,table:()=>Ft,tbody:()=>Nt,td:()=>jt,textarea:()=>Bt,tfoot:()=>zt,th:()=>Wt,thead:()=>Ht,time:()=>Ut,tr:()=>Yt,track:()=>qt,u:()=>Xt,ul:()=>Vt,video:()=>Kt,wbr:()=>$t});var r=n(6540);function i(t){return function(e,n){return"object"!=typeof e||Array.isArray(e)?(0,r.h)(t,{},e):(0,r.h)(t,e,n)}}function a(t,e){return i("a")(t,e)}function o(t,e){return i("abbr")(t,e)}function s(t,e){return i("address")(t,e)}function h(t,e){return i("area")(t,e)}function u(t,e){return i("article")(t,e)}function l(t,e){return i("aside")(t,e)}function c(t,e){return i("audio")(t,e)}function f(t,e){return i("b")(t,e)}function d(t,e){return i("bdi")(t,e)}function g(t,e){return i("bdo")(t,e)}function p(t,e){return i("blockquote")(t,e)}function v(t,e){return i("br")(t,e)}function m(t,e){return i("button")(t,e)}function y(t,e){return i("canvas")(t,e)}function _(t,e){return i("caption")(t,e)}function b(t,e){return i("cite")(t,e)}function x(t,e){return i("code")(t,e)}function w(t,e){return i("col")(t,e)}function S(t,e){return i("colgroup")(t,e)}function k(t,e){return i("data")(t,e)}function C(t,e){return i("datalist")(t,e)}function P(t,e){return i("dd")(t,e)}function A(t,e){return i("del")(t,e)}function T(t,e){return i("details")(t,e)}function O(t,e){return i("dfn")(t,e)}function L(t,e){return i("dialog")(t,e)}function E(t,e){return i("div")(t,e)}function R(t,e){return i("dl")(t,e)}function M(t,e){return i("dt")(t,e)}function G(t,e){return i("em")(t,e)}function I(t,e){return i("embed")(t,e)}function D(t,e){return i("fieldset")(t,e)}function F(t,e){return i("figcaption")(t,e)}function N(t,e){return i("figure")(t,e)}function j(t,e){return i("footer")(t,e)}function B(t,e){return i("form")(t,e)}function z(t,e){return i("h1")(t,e)}function W(t,e){return i("h2")(t,e)}function H(t,e){return i("h3")(t,e)}function U(t,e){return i("h4")(t,e)}function Y(t,e){return i("h5")(t,e)}function q(t,e){return i("h6")(t,e)}function X(t,e){return i("header")(t,e)}function V(t,e){return i("hr")(t,e)}function K(t,e){return i("i")(t,e)}function $(t,e){return i("iframe")(t,e)}function J(t,e){return i("img")(t,e)}function Q(t,e){return i("input")(t,e)}function Z(t,e){return i("ins")(t,e)}function tt(t,e){return i("kbd")(t,e)}function et(t,e){return i("label")(t,e)}function nt(t,e){return i("legend")(t,e)}function rt(t,e){return i("li")(t,e)}function it(t,e){return i("main")(t,e)}function at(t,e){return i("map")(t,e)}function ot(t,e){return i("mark")(t,e)}function st(t,e){return i("menu")(t,e)}function ht(t,e){return i("menuitem")(t,e)}function ut(t,e){return i("meter")(t,e)}function lt(t,e){return i("nav")(t,e)}function ct(t,e){return i("object")(t,e)}function ft(t,e){return i("ol")(t,e)}function dt(t,e){return i("optgroup")(t,e)}function gt(t,e){return i("option")(t,e)}function pt(t,e){return i("output")(t,e)}function vt(t,e){return i("p")(t,e)}function mt(t,e){return i("param")(t,e)}function yt(t,e){return i("pre")(t,e)}function _t(t,e){return i("progress")(t,e)}function bt(t,e){return i("q")(t,e)}function xt(t,e){return i("rp")(t,e)}function wt(t,e){return i("rt")(t,e)}function St(t,e){return i("rtc")(t,e)}function kt(t,e){return i("ruby")(t,e)}function Ct(t,e){return i("s")(t,e)}function Pt(t,e){return i("samp")(t,e)}function At(t,e){return i("section")(t,e)}function Tt(t,e){return i("select")(t,e)}function Ot(t,e){return i("small")(t,e)}function Lt(t,e){return i("source")(t,e)}function Et(t,e){return i("span")(t,e)}function Rt(t,e){return i("strong")(t,e)}function Mt(t,e){return i("sub")(t,e)}function Gt(t,e){return i("summary")(t,e)}function It(t,e){return i("sup")(t,e)}function Dt(t,e){return i("svg")(t,e)}function Ft(t,e){return i("table")(t,e)}function Nt(t,e){return i("tbody")(t,e)}function jt(t,e){return i("td")(t,e)}function Bt(t,e){return i("textarea")(t,e)}function zt(t,e){return i("tfoot")(t,e)}function Wt(t,e){return i("th")(t,e)}function Ht(t,e){return i("thead")(t,e)}function Ut(t,e){return i("time")(t,e)}function Yt(t,e){return i("tr")(t,e)}function qt(t,e){return i("track")(t,e)}function Xt(t,e){return i("u")(t,e)}function Vt(t,e){return i("ul")(t,e)}function Kt(t,e){return i("video")(t,e)}function $t(t,e){return i("wbr")(t,e)}},1639:(t,e,n)=>{"use strict";function r(t,e,n){console.group("%c action","color: gray; font-weight: lighter;",e.name),console.log("%c prev state","color: #9E9E9E; font-weight: bold;",t),console.log("%c data","color: #03A9F4; font-weight: bold;",e.data),console.log("%c next state","color: #4CAF50; font-weight: bold;",n),console.groupEnd()}n.r(e),n.d(e,{withLogger:()=>o});var i=function(t){return"function"==typeof t};function a(t,e){return function(n,r,i,a){var o=function e(n,r){var i=r?r+".":"";return Object.keys(n||{}).reduce((function(r,a){var o=i+a,s=n[a];return r[a]="function"==typeof s?function(e){return function(n,r){var i=s(e);return i="function"==typeof i?i(n,r):i,t(n,{name:o,data:e},i),i}}:e(s,o),r}),{})}(r);return e(n,o,i,a)}}function o(t){if(i(t))return a(r,t);var e=i(t.log)?t.log:r;return function(t){return a(e,t)}}},6540:(t,e,n)=>{"use strict";function r(t,e){for(var n=[],r=[],i=arguments.length;i-- >2;)n.push(arguments[i]);for(;n.length;){var a=n.pop();if(a&&a.pop)for(i=a.length;i--;)n.push(a[i]);else null!=a&&!0!==a&&!1!==a&&r.push(a)}return"function"==typeof t?t(e||{},r):{nodeName:t,attributes:e||{},children:r,key:e&&e.key}}function i(t,e,n,r){var i,a=[].map,o=r&&r.children[0]||null,s=o&&function t(e){return{nodeName:e.nodeName.toLowerCase(),attributes:{},children:a.call(e.childNodes,(function(e){return 3===e.nodeType?e.nodeValue:t(e)}))}}(o),h=[],u=!0,l=p(t),c=function t(e,n,r){for(var i in r)"function"==typeof r[i]?function(t,i){r[t]=function(t){var a=i(t);return"function"==typeof a&&(a=a(m(e,l),r)),a&&a!==(n=m(e,l))&&!a.then&&g(l=v(e,p(n,a),l)),a}}(i,r[i]):t(e.concat(i),n[i]=p(n[i]),r[i]=p(r[i]));return r}([],l,p(e));return g(),c;function f(t){return"function"==typeof t?f(t(l,c)):null!=t?t:""}function d(){i=!i;var t=f(n);for(r&&!i&&(o=k(r,o,s,s=t)),u=!1;h.length;)h.pop()()}function g(){i||(i=!0,setTimeout(d))}function p(t,e){var n={};for(var r in t)n[r]=t[r];for(var r in e)n[r]=e[r];return n}function v(t,e,n){var r={};return t.length?(r[t[0]]=t.length>1?v(t.slice(1),e,n[t[0]]):e,p(n,r)):e}function m(t,e){for(var n=0;n<t.length;)e=e[t[n++]];return e}function y(t){return t?t.key:null}function _(t){return t.currentTarget.events[t.type](t)}function b(t,e,n,r,i){if("key"===e);else if("style"===e)if("string"==typeof n)t.style.cssText=n;else for(var a in"string"==typeof r&&(r=t.style.cssText=""),p(r,n)){var o=null==n||null==n[a]?"":n[a];"-"===a[0]?t.style.setProperty(a,o):t.style[a]=o}else"o"===e[0]&&"n"===e[1]?(e=e.slice(2),t.events?r||(r=t.events[e]):t.events={},t.events[e]=n,n?r||t.addEventListener(e,_):t.removeEventListener(e,_)):e in t&&"list"!==e&&"type"!==e&&"draggable"!==e&&"spellcheck"!==e&&"translate"!==e&&!i?t[e]=null==n?"":n:null!=n&&!1!==n&&t.setAttribute(e,n),null!=n&&!1!==n||t.removeAttribute(e)}function x(t,e){var n="string"==typeof t||"number"==typeof t?document.createTextNode(t):(e=e||"svg"===t.nodeName)?document.createElementNS("http://www.w3.org/2000/svg",t.nodeName):document.createElement(t.nodeName),r=t.attributes;if(r){r.oncreate&&h.push((function(){r.oncreate(n)}));for(var i=0;i<t.children.length;i++)n.appendChild(x(t.children[i]=f(t.children[i]),e));for(var a in r)b(n,a,r[a],null,e)}return n}function w(t,e){var n=e.attributes;if(n){for(var r=0;r<e.children.length;r++)w(t.childNodes[r],e.children[r]);n.ondestroy&&n.ondestroy(t)}return t}function S(t,e,n){function r(){t.removeChild(w(e,n))}var i=n.attributes&&n.attributes.onremove;i?i(e,r):r()}function k(t,e,n,r,i){if(r===n);else if(null==n||n.nodeName!==r.nodeName){var a=x(r,i);t.insertBefore(a,e),null!=n&&S(t,e,n),e=a}else if(null==n.nodeName)e.nodeValue=r;else{!function(t,e,n,r){for(var i in p(e,n))n[i]!==("value"===i||"checked"===i?t[i]:e[i])&&b(t,i,n[i],e[i],r);var a=u?n.oncreate:n.onupdate;a&&h.push((function(){a(t,e)}))}(e,n.attributes,r.attributes,i=i||"svg"===r.nodeName);for(var o={},s={},l=[],c=n.children,d=r.children,g=0;g<c.length;g++)l[g]=e.childNodes[g],null!=(m=y(c[g]))&&(o[m]=[l[g],c[g]]);g=0;for(var v=0;v<d.length;){var m=y(c[g]),_=y(d[v]=f(d[v]));if(s[m])g++;else if(null==_||_!==y(c[g+1]))if(null==_||u)null==m&&(k(e,l[g],c[g],d[v],i),v++),g++;else{var w=o[_]||[];m===_?(k(e,w[0],w[1],d[v],i),g++):w[0]?k(e,e.insertBefore(w[0],l[g]),w[1],d[v],i):k(e,l[g],null,d[v],i),s[_]=d[v],v++}else null==m&&S(e,l[g],c[g]),g++}for(;g<c.length;)null==y(c[g])&&S(e,l[g],c[g]),g++;for(var g in o)s[g]||S(e,o[g][0],o[g][1])}return e}}n.r(e),n.d(e,{h:()=>r,app:()=>i})},886:(t,e,n)=>{"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.r(e),n.d(e,{default:()=>k});var a=[],o=a.forEach,s=a.slice;function h(t){return o.call(s.call(arguments,1),(function(e){if(e)for(var n in e)void 0===t[n]&&(t[n]=e[n])})),t}var u=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,l=function(t,e,n){var r=n||{};r.path=r.path||"/";var i=t+"="+encodeURIComponent(e);if(r.maxAge>0){var a=r.maxAge-0;if(isNaN(a))throw new Error("maxAge should be a Number");i+="; Max-Age="+Math.floor(a)}if(r.domain){if(!u.test(r.domain))throw new TypeError("option domain is invalid");i+="; Domain="+r.domain}if(r.path){if(!u.test(r.path))throw new TypeError("option path is invalid");i+="; Path="+r.path}if(r.expires){if("function"!=typeof r.expires.toUTCString)throw new TypeError("option expires is invalid");i+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(i+="; HttpOnly"),r.secure&&(i+="; Secure"),r.sameSite)switch("string"==typeof r.sameSite?r.sameSite.toLowerCase():r.sameSite){case!0:i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"strict":i+="; SameSite=Strict";break;case"none":i+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return i},c={name:"cookie",lookup:function(t){var e;if(t.lookupCookie&&"undefined"!=typeof document){var n=function(t){for(var e=t+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(e))return i.substring(e.length,i.length)}return null}(t.lookupCookie);n&&(e=n)}return e},cacheUserLanguage:function(t,e){e.lookupCookie&&"undefined"!=typeof document&&function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{path:"/",sameSite:"strict"};n&&(i.expires=new Date,i.expires.setTime(i.expires.getTime()+60*n*1e3)),r&&(i.domain=r),document.cookie=l(t,encodeURIComponent(e),i)}(e.lookupCookie,t,e.cookieMinutes,e.cookieDomain,e.cookieOptions)}},f={name:"querystring",lookup:function(t){var e;if("undefined"!=typeof window)for(var n=window.location.search.substring(1).split("&"),r=0;r<n.length;r++){var i=n[r].indexOf("=");i>0&&n[r].substring(0,i)===t.lookupQuerystring&&(e=n[r].substring(i+1))}return e}},d=null,g=function(){if(null!==d)return d;try{d="undefined"!==window&&null!==window.localStorage;var t="i18next.translate.boo";window.localStorage.setItem(t,"foo"),window.localStorage.removeItem(t)}catch(t){d=!1}return d},p={name:"localStorage",lookup:function(t){var e;if(t.lookupLocalStorage&&g()){var n=window.localStorage.getItem(t.lookupLocalStorage);n&&(e=n)}return e},cacheUserLanguage:function(t,e){e.lookupLocalStorage&&g()&&window.localStorage.setItem(e.lookupLocalStorage,t)}},v=null,m=function(){if(null!==v)return v;try{v="undefined"!==window&&null!==window.sessionStorage;var t="i18next.translate.boo";window.sessionStorage.setItem(t,"foo"),window.sessionStorage.removeItem(t)}catch(t){v=!1}return v},y={name:"sessionStorage",lookup:function(t){var e;if(t.lookupSessionStorage&&m()){var n=window.sessionStorage.getItem(t.lookupSessionStorage);n&&(e=n)}return e},cacheUserLanguage:function(t,e){e.lookupSessionStorage&&m()&&window.sessionStorage.setItem(e.lookupSessionStorage,t)}},_={name:"navigator",lookup:function(t){var e=[];if("undefined"!=typeof navigator){if(navigator.languages)for(var n=0;n<navigator.languages.length;n++)e.push(navigator.languages[n]);navigator.userLanguage&&e.push(navigator.userLanguage),navigator.language&&e.push(navigator.language)}return e.length>0?e:void 0}},b={name:"htmlTag",lookup:function(t){var e,n=t.htmlTag||("undefined"!=typeof document?document.documentElement:null);return n&&"function"==typeof n.getAttribute&&(e=n.getAttribute("lang")),e}},x={name:"path",lookup:function(t){var e;if("undefined"!=typeof window){var n=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(n instanceof Array)if("number"==typeof t.lookupFromPathIndex){if("string"!=typeof n[t.lookupFromPathIndex])return;e=n[t.lookupFromPathIndex].replace("/","")}else e=n[0].replace("/","")}return e}},w={name:"subdomain",lookup:function(t){var e;if("undefined"!=typeof window){var n=window.location.href.match(/(?:http[s]*\:\/\/)*(.*?)\.(?=[^\/]*\..{2,5})/gi);n instanceof Array&&(e="number"==typeof t.lookupFromSubdomainIndex?n[t.lookupFromSubdomainIndex].replace("http://","").replace("https://","").replace(".",""):n[0].replace("http://","").replace("https://","").replace(".",""))}return e}},S=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,t),this.type="languageDetector",this.detectors={},this.init(e,n)}var e,n;return e=t,(n=[{key:"init",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.services=t,this.options=h(e,this.options||{},{order:["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"]}),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=n,this.addDetector(c),this.addDetector(f),this.addDetector(p),this.addDetector(y),this.addDetector(_),this.addDetector(b),this.addDetector(x),this.addDetector(w)}},{key:"addDetector",value:function(t){this.detectors[t.name]=t}},{key:"detect",value:function(t){var e=this;t||(t=this.options.order);var n=[];return t.forEach((function(t){if(e.detectors[t]){var r=e.detectors[t].lookup(e.options);r&&"string"==typeof r&&(r=[r]),r&&(n=n.concat(r))}})),this.services.languageUtils.getBestMatchFromCodes?n:n.length>0?n[0]:null}},{key:"cacheUserLanguage",value:function(t,e){var n=this;e||(e=this.options.caches),e&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(t)>-1||e.forEach((function(e){n.detectors[e]&&n.detectors[e].cacheUserLanguage(t,n.options)})))}}])&&i(e.prototype,n),t}();S.type="languageDetector";const k=S},1224:(t,e,n)=>{"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?Object(arguments[e]):{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),r.forEach((function(e){i(t,e,n[e])}))}return t}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?u(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}n.r(e),n.d(e,{default:()=>Y});var g={type:"logger",log:function(t){this.output("log",t)},warn:function(t){this.output("warn",t)},error:function(t){this.output("error",t)},output:function(t,e){console&&console[t]&&console[t].apply(console,e)}},p=new(function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,t),this.init(e,n)}return h(t,[{key:"init",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=e.prefix||"i18next:",this.logger=t||g,this.options=e,this.debug=e.debug}},{key:"setDebug",value:function(t){this.debug=t}},{key:"log",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"log","",!0)}},{key:"warn",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"warn","",!0)}},{key:"error",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"error","")}},{key:"deprecate",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(t,e,n,r){return r&&!this.debug?null:("string"==typeof t[0]&&(t[0]="".concat(n).concat(this.prefix," ").concat(t[0])),this.logger[e](t))}},{key:"create",value:function(e){return new t(this.logger,a({},{prefix:"".concat(this.prefix,":").concat(e,":")},this.options))}}]),t}()),v=function(){function t(){o(this,t),this.observers={}}return h(t,[{key:"on",value:function(t,e){var n=this;return t.split(" ").forEach((function(t){n.observers[t]=n.observers[t]||[],n.observers[t].push(e)})),this}},{key:"off",value:function(t,e){this.observers[t]&&(e?this.observers[t]=this.observers[t].filter((function(t){return t!==e})):delete this.observers[t])}},{key:"emit",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];if(this.observers[t]){var i=[].concat(this.observers[t]);i.forEach((function(t){t.apply(void 0,n)}))}if(this.observers["*"]){var a=[].concat(this.observers["*"]);a.forEach((function(e){e.apply(e,[t].concat(n))}))}}}]),t}();function m(){var t,e,n=new Promise((function(n,r){t=n,e=r}));return n.resolve=t,n.reject=e,n}function y(t){return null==t?"":""+t}function _(t,e,n){t.forEach((function(t){e[t]&&(n[t]=e[t])}))}function b(t,e,n){function r(t){return t&&t.indexOf("###")>-1?t.replace(/###/g,"."):t}function i(){return!t||"string"==typeof t}for(var a="string"!=typeof e?[].concat(e):e.split(".");a.length>1;){if(i())return{};var o=r(a.shift());!t[o]&&n&&(t[o]=new n),t=Object.prototype.hasOwnProperty.call(t,o)?t[o]:{}}return i()?{}:{obj:t,k:r(a.shift())}}function x(t,e,n){var r=b(t,e,Object);r.obj[r.k]=n}function w(t,e){var n=b(t,e),r=n.obj,i=n.k;if(r)return r[i]}function S(t,e,n){var r=w(t,n);return void 0!==r?r:w(e,n)}function k(t,e,n){for(var r in e)"__proto__"!==r&&"constructor"!==r&&(r in t?"string"==typeof t[r]||t[r]instanceof String||"string"==typeof e[r]||e[r]instanceof String?n&&(t[r]=e[r]):k(t[r],e[r],n):t[r]=e[r]);return t}function C(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var P={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function A(t){return"string"==typeof t?t.replace(/[&<>"'\/]/g,(function(t){return P[t]})):t}var T="undefined"!=typeof window&&window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1;function O(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(t){if(t[e])return t[e];for(var r=e.split(n),i=t,a=0;a<r.length;++a){if("string"==typeof i[r[a]]&&a+1<r.length)return;if(void 0===i[r[a]]){for(var o=2,s=r.slice(a,a+o).join(n),h=i[s];void 0===h&&r.length>a+o;)o++,h=i[s=r.slice(a,a+o).join(n)];if(void 0===h)return;if("string"==typeof h)return h;if(s&&"string"==typeof h[s])return h[s];var u=r.slice(a+o).join(n);return u?O(h,u,n):void 0}i=i[r[a]]}return i}}var L=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};return o(this,e),n=l(this,c(e).call(this)),T&&v.call(u(n)),n.data=t||{},n.options=r,void 0===n.options.keySeparator&&(n.options.keySeparator="."),void 0===n.options.ignoreJSONStructure&&(n.options.ignoreJSONStructure=!0),n}return d(e,t),h(e,[{key:"addNamespaces",value:function(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}},{key:"removeNamespaces",value:function(t){var e=this.options.ns.indexOf(t);e>-1&&this.options.ns.splice(e,1)}},{key:"getResource",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=void 0!==r.keySeparator?r.keySeparator:this.options.keySeparator,a=void 0!==r.ignoreJSONStructure?r.ignoreJSONStructure:this.options.ignoreJSONStructure,o=[t,e];n&&"string"!=typeof n&&(o=o.concat(n)),n&&"string"==typeof n&&(o=o.concat(i?n.split(i):n)),t.indexOf(".")>-1&&(o=t.split("."));var s=w(this.data,o);return s||!a||"string"!=typeof n?s:O(this.data&&this.data[t]&&this.data[t][e],n,i)}},{key:"addResource",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1},a=this.options.keySeparator;void 0===a&&(a=".");var o=[t,e];n&&(o=o.concat(a?n.split(a):n)),t.indexOf(".")>-1&&(r=e,e=(o=t.split("."))[1]),this.addNamespaces(e),x(this.data,o,r),i.silent||this.emit("added",t,e,n,r)}},{key:"addResources",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(var i in n)"string"!=typeof n[i]&&"[object Array]"!==Object.prototype.toString.apply(n[i])||this.addResource(t,e,i,n[i],{silent:!0});r.silent||this.emit("added",t,e,n)}},{key:"addResourceBundle",value:function(t,e,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1},s=[t,e];t.indexOf(".")>-1&&(r=n,n=e,e=(s=t.split("."))[1]),this.addNamespaces(e);var h=w(this.data,s)||{};r?k(h,n,i):h=a({},h,n),x(this.data,s,h),o.silent||this.emit("added",t,e,n)}},{key:"removeResourceBundle",value:function(t,e){this.hasResourceBundle(t,e)&&delete this.data[t][e],this.removeNamespaces(e),this.emit("removed",t,e)}},{key:"hasResourceBundle",value:function(t,e){return void 0!==this.getResource(t,e)}},{key:"getResourceBundle",value:function(t,e){return e||(e=this.options.defaultNS),"v1"===this.options.compatibilityAPI?a({},{},this.getResource(t,e)):this.getResource(t,e)}},{key:"getDataByLanguage",value:function(t){return this.data[t]}},{key:"toJSON",value:function(){return this.data}}]),e}(v),E={processors:{},addPostProcessor:function(t){this.processors[t.name]=t},handle:function(t,e,n,r,i){var a=this;return t.forEach((function(t){a.processors[t]&&(e=a.processors[t].process(e,n,r,i))})),e}},R={},M=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o(this,e),n=l(this,c(e).call(this)),T&&v.call(u(n)),_(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,u(n)),n.options=r,void 0===n.options.keySeparator&&(n.options.keySeparator="."),n.logger=p.create("translator"),n}return d(e,t),h(e,[{key:"changeLanguage",value:function(t){t&&(this.language=t)}},{key:"exists",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==t)return!1;var n=this.resolve(t,e);return n&&void 0!==n.res}},{key:"extractFromKey",value:function(t,e){var n=void 0!==e.nsSeparator?e.nsSeparator:this.options.nsSeparator;void 0===n&&(n=":");var r=void 0!==e.keySeparator?e.keySeparator:this.options.keySeparator,i=e.ns||this.options.defaultNS;if(n&&t.indexOf(n)>-1){var a=t.match(this.interpolator.nestingRegexp);if(a&&a.length>0)return{key:t,namespaces:i};var o=t.split(n);(n!==r||n===r&&this.options.ns.indexOf(o[0])>-1)&&(i=o.shift()),t=o.join(r)}return"string"==typeof i&&(i=[i]),{key:t,namespaces:i}}},{key:"translate",value:function(t,n,i){var o=this;if("object"!==r(n)&&this.options.overloadTranslationOptionHandler&&(n=this.options.overloadTranslationOptionHandler(arguments)),n||(n={}),null==t)return"";Array.isArray(t)||(t=[String(t)]);var s=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator,h=this.extractFromKey(t[t.length-1],n),u=h.key,l=h.namespaces,c=l[l.length-1],f=n.lng||this.language,d=n.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(f&&"cimode"===f.toLowerCase()){if(d){var g=n.nsSeparator||this.options.nsSeparator;return c+g+u}return u}var p=this.resolve(t,n),v=p&&p.res,m=p&&p.usedKey||u,y=p&&p.exactUsedKey||u,_=Object.prototype.toString.apply(v),b=["[object Number]","[object Function]","[object RegExp]"],x=void 0!==n.joinArrays?n.joinArrays:this.options.joinArrays,w=!this.i18nFormat||this.i18nFormat.handleAsObject,S="string"!=typeof v&&"boolean"!=typeof v&&"number"!=typeof v;if(w&&v&&S&&b.indexOf(_)<0&&("string"!=typeof x||"[object Array]"!==_)){if(!n.returnObjects&&!this.options.returnObjects)return this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!"),this.options.returnedObjectHandler?this.options.returnedObjectHandler(m,v,a({},n,{ns:l})):"key '".concat(u," (").concat(this.language,")' returned an object instead of string.");if(s){var k="[object Array]"===_,C=k?[]:{},P=k?y:m;for(var A in v)if(Object.prototype.hasOwnProperty.call(v,A)){var T="".concat(P).concat(s).concat(A);C[A]=this.translate(T,a({},n,{joinArrays:!1,ns:l})),C[A]===T&&(C[A]=v[A])}v=C}}else if(w&&"string"==typeof x&&"[object Array]"===_)(v=v.join(x))&&(v=this.extendTranslation(v,t,n,i));else{var O=!1,L=!1,E=void 0!==n.count&&"string"!=typeof n.count,R=e.hasDefaultValue(n),M=E?this.pluralResolver.getSuffix(f,n.count):"",G=n["defaultValue".concat(M)]||n.defaultValue;!this.isValidLookup(v)&&R&&(O=!0,v=G),this.isValidLookup(v)||(L=!0,v=u);var I=R&&G!==v&&this.options.updateMissing;if(L||O||I){if(this.logger.log(I?"updateKey":"missingKey",f,c,u,I?G:v),s){var D=this.resolve(u,a({},n,{keySeparator:!1}));D&&D.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var F=[],N=this.languageUtils.getFallbackCodes(this.options.fallbackLng,n.lng||this.language);if("fallback"===this.options.saveMissingTo&&N&&N[0])for(var j=0;j<N.length;j++)F.push(N[j]);else"all"===this.options.saveMissingTo?F=this.languageUtils.toResolveHierarchy(n.lng||this.language):F.push(n.lng||this.language);var B=function(t,e,r){o.options.missingKeyHandler?o.options.missingKeyHandler(t,c,e,I?r:v,I,n):o.backendConnector&&o.backendConnector.saveMissing&&o.backendConnector.saveMissing(t,c,e,I?r:v,I,n),o.emit("missingKey",t,c,e,v)};this.options.saveMissing&&(this.options.saveMissingPlurals&&E?F.forEach((function(t){o.pluralResolver.getSuffixes(t).forEach((function(e){B([t],u+e,n["defaultValue".concat(e)]||G)}))})):B(F,u,G))}v=this.extendTranslation(v,t,n,p,i),L&&v===u&&this.options.appendNamespaceToMissingKey&&(v="".concat(c,":").concat(u)),(L||O)&&this.options.parseMissingKeyHandler&&(v=this.options.parseMissingKeyHandler(v))}return v}},{key:"extendTranslation",value:function(t,e,n,r,i){var o=this;if(this.i18nFormat&&this.i18nFormat.parse)t=this.i18nFormat.parse(t,n,r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init(a({},n,{interpolation:a({},this.options.interpolation,n.interpolation)}));var s,h=n.interpolation&&n.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables;if(h){var u=t.match(this.interpolator.nestingRegexp);s=u&&u.length}var l=n.replace&&"string"!=typeof n.replace?n.replace:n;if(this.options.interpolation.defaultVariables&&(l=a({},this.options.interpolation.defaultVariables,l)),t=this.interpolator.interpolate(t,l,n.lng||this.language,n),h){var c=t.match(this.interpolator.nestingRegexp);s<(c&&c.length)&&(n.nest=!1)}!1!==n.nest&&(t=this.interpolator.nest(t,(function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return i&&i[0]===r[0]&&!n.context?(o.logger.warn("It seems you are nesting recursively key: ".concat(r[0]," in key: ").concat(e[0])),null):o.translate.apply(o,r.concat([e]))}),n)),n.interpolation&&this.interpolator.reset()}var f=n.postProcess||this.options.postProcess,d="string"==typeof f?[f]:f;return null!=t&&d&&d.length&&!1!==n.applyPostProcessor&&(t=E.handle(d,t,e,this.options&&this.options.postProcessPassResolved?a({i18nResolved:r},n):n,this)),t}},{key:"resolve",value:function(t){var e,n,r,i,a,o=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof t&&(t=[t]),t.forEach((function(t){if(!o.isValidLookup(e)){var h=o.extractFromKey(t,s),u=h.key;n=u;var l=h.namespaces;o.options.fallbackNS&&(l=l.concat(o.options.fallbackNS));var c=void 0!==s.count&&"string"!=typeof s.count,f=void 0!==s.context&&("string"==typeof s.context||"number"==typeof s.context)&&""!==s.context,d=s.lngs?s.lngs:o.languageUtils.toResolveHierarchy(s.lng||o.language,s.fallbackLng);l.forEach((function(t){o.isValidLookup(e)||(a=t,!R["".concat(d[0],"-").concat(t)]&&o.utils&&o.utils.hasLoadedNamespace&&!o.utils.hasLoadedNamespace(a)&&(R["".concat(d[0],"-").concat(t)]=!0,o.logger.warn('key "'.concat(n,'" for languages "').concat(d.join(", "),'" won\'t get resolved as namespace "').concat(a,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),d.forEach((function(n){if(!o.isValidLookup(e)){i=n;var a,h,l=u,d=[l];for(o.i18nFormat&&o.i18nFormat.addLookupKeys?o.i18nFormat.addLookupKeys(d,u,n,t,s):(c&&(a=o.pluralResolver.getSuffix(n,s.count)),c&&f&&d.push(l+a),f&&d.push(l+="".concat(o.options.contextSeparator).concat(s.context)),c&&d.push(l+=a));h=d.pop();)o.isValidLookup(e)||(r=h,e=o.getResource(n,t,h,s))}})))}))}})),{res:e,usedKey:n,exactUsedKey:r,usedLng:i,usedNS:a}}},{key:"isValidLookup",value:function(t){return!(void 0===t||!this.options.returnNull&&null===t||!this.options.returnEmptyString&&""===t)}},{key:"getResource",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(t,e,n,r):this.resourceStore.getResource(t,e,n,r)}}],[{key:"hasDefaultValue",value:function(t){var e="defaultValue";for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e===n.substring(0,e.length)&&void 0!==t[n])return!0;return!1}}]),e}(v);function G(t){return t.charAt(0).toUpperCase()+t.slice(1)}var I=function(){function t(e){o(this,t),this.options=e,this.whitelist=this.options.supportedLngs||!1,this.supportedLngs=this.options.supportedLngs||!1,this.logger=p.create("languageUtils")}return h(t,[{key:"getScriptPartFromCode",value:function(t){if(!t||t.indexOf("-")<0)return null;var e=t.split("-");return 2===e.length?null:(e.pop(),"x"===e[e.length-1].toLowerCase()?null:this.formatLanguageCode(e.join("-")))}},{key:"getLanguagePartFromCode",value:function(t){if(!t||t.indexOf("-")<0)return t;var e=t.split("-");return this.formatLanguageCode(e[0])}},{key:"formatLanguageCode",value:function(t){if("string"==typeof t&&t.indexOf("-")>-1){var e=["hans","hant","latn","cyrl","cans","mong","arab"],n=t.split("-");return this.options.lowerCaseLng?n=n.map((function(t){return t.toLowerCase()})):2===n.length?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),e.indexOf(n[1].toLowerCase())>-1&&(n[1]=G(n[1].toLowerCase()))):3===n.length&&(n[0]=n[0].toLowerCase(),2===n[1].length&&(n[1]=n[1].toUpperCase()),"sgn"!==n[0]&&2===n[2].length&&(n[2]=n[2].toUpperCase()),e.indexOf(n[1].toLowerCase())>-1&&(n[1]=G(n[1].toLowerCase())),e.indexOf(n[2].toLowerCase())>-1&&(n[2]=G(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}},{key:"isWhitelisted",value:function(t){return this.logger.deprecate("languageUtils.isWhitelisted",'function "isWhitelisted" will be renamed to "isSupportedCode" in the next major - please make sure to rename it\'s usage asap.'),this.isSupportedCode(t)}},{key:"isSupportedCode",value:function(t){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}},{key:"getBestMatchFromCodes",value:function(t){var e,n=this;return t?(t.forEach((function(t){if(!e){var r=n.formatLanguageCode(t);n.options.supportedLngs&&!n.isSupportedCode(r)||(e=r)}})),!e&&this.options.supportedLngs&&t.forEach((function(t){if(!e){var r=n.getLanguagePartFromCode(t);if(n.isSupportedCode(r))return e=r;e=n.options.supportedLngs.find((function(t){if(0===t.indexOf(r))return t}))}})),e||(e=this.getFallbackCodes(this.options.fallbackLng)[0]),e):null}},{key:"getFallbackCodes",value:function(t,e){if(!t)return[];if("function"==typeof t&&(t=t(e)),"string"==typeof t&&(t=[t]),"[object Array]"===Object.prototype.toString.apply(t))return t;if(!e)return t.default||[];var n=t[e];return n||(n=t[this.getScriptPartFromCode(e)]),n||(n=t[this.formatLanguageCode(e)]),n||(n=t[this.getLanguagePartFromCode(e)]),n||(n=t.default),n||[]}},{key:"toResolveHierarchy",value:function(t,e){var n=this,r=this.getFallbackCodes(e||this.options.fallbackLng||[],t),i=[],a=function(t){t&&(n.isSupportedCode(t)?i.push(t):n.logger.warn("rejecting language code not found in supportedLngs: ".concat(t)))};return"string"==typeof t&&t.indexOf("-")>-1?("languageOnly"!==this.options.load&&a(this.formatLanguageCode(t)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&a(this.getScriptPartFromCode(t)),"currentOnly"!==this.options.load&&a(this.getLanguagePartFromCode(t))):"string"==typeof t&&a(this.formatLanguageCode(t)),r.forEach((function(t){i.indexOf(t)<0&&a(n.formatLanguageCode(t))})),i}}]),t}(),D=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],F={1:function(t){return Number(t>1)},2:function(t){return Number(1!=t)},3:function(t){return 0},4:function(t){return Number(t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2)},5:function(t){return Number(0==t?0:1==t?1:2==t?2:t%100>=3&&t%100<=10?3:t%100>=11?4:5)},6:function(t){return Number(1==t?0:t>=2&&t<=4?1:2)},7:function(t){return Number(1==t?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2)},8:function(t){return Number(1==t?0:2==t?1:8!=t&&11!=t?2:3)},9:function(t){return Number(t>=2)},10:function(t){return Number(1==t?0:2==t?1:t<7?2:t<11?3:4)},11:function(t){return Number(1==t||11==t?0:2==t||12==t?1:t>2&&t<20?2:3)},12:function(t){return Number(t%10!=1||t%100==11)},13:function(t){return Number(0!==t)},14:function(t){return Number(1==t?0:2==t?1:3==t?2:3)},15:function(t){return Number(t%10==1&&t%100!=11?0:t%10>=2&&(t%100<10||t%100>=20)?1:2)},16:function(t){return Number(t%10==1&&t%100!=11?0:0!==t?1:2)},17:function(t){return Number(1==t||t%10==1&&t%100!=11?0:1)},18:function(t){return Number(0==t?0:1==t?1:2)},19:function(t){return Number(1==t?0:0==t||t%100>1&&t%100<11?1:t%100>10&&t%100<20?2:3)},20:function(t){return Number(1==t?0:0==t||t%100>0&&t%100<20?1:2)},21:function(t){return Number(t%100==1?1:t%100==2?2:t%100==3||t%100==4?3:0)},22:function(t){return Number(1==t?0:2==t?1:(t<0||t>10)&&t%10==0?2:3)}};function N(){var t={};return D.forEach((function(e){e.lngs.forEach((function(n){t[n]={numbers:e.nr,plurals:F[e.fc]}}))})),t}var j=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,t),this.languageUtils=e,this.options=n,this.logger=p.create("pluralResolver"),this.rules=N()}return h(t,[{key:"addRule",value:function(t,e){this.rules[t]=e}},{key:"getRule",value:function(t){return this.rules[t]||this.rules[this.languageUtils.getLanguagePartFromCode(t)]}},{key:"needsPlural",value:function(t){var e=this.getRule(t);return e&&e.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(t,e){return this.getSuffixes(t).map((function(t){return e+t}))}},{key:"getSuffixes",value:function(t){var e=this,n=this.getRule(t);return n?n.numbers.map((function(n){return e.getSuffix(t,n)})):[]}},{key:"getSuffix",value:function(t,e){var n=this,r=this.getRule(t);if(r){var i=r.noAbs?r.plurals(e):r.plurals(Math.abs(e)),a=r.numbers[i];this.options.simplifyPluralSuffix&&2===r.numbers.length&&1===r.numbers[0]&&(2===a?a="plural":1===a&&(a=""));var o=function(){return n.options.prepend&&a.toString()?n.options.prepend+a.toString():a.toString()};return"v1"===this.options.compatibilityJSON?1===a?"":"number"==typeof a?"_plural_".concat(a.toString()):o():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===r.numbers.length&&1===r.numbers[0]?o():this.options.prepend&&i.toString()?this.options.prepend+i.toString():i.toString()}return this.logger.warn("no plural rule found for: ".concat(t)),""}}]),t}(),B=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,t),this.logger=p.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||function(t){return t},this.init(e)}return h(t,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.interpolation||(t.interpolation={escapeValue:!0});var e=t.interpolation;this.escape=void 0!==e.escape?e.escape:A,this.escapeValue=void 0===e.escapeValue||e.escapeValue,this.useRawValueToEscape=void 0!==e.useRawValueToEscape&&e.useRawValueToEscape,this.prefix=e.prefix?C(e.prefix):e.prefixEscaped||"{{",this.suffix=e.suffix?C(e.suffix):e.suffixEscaped||"}}",this.formatSeparator=e.formatSeparator?e.formatSeparator:e.formatSeparator||",",this.unescapePrefix=e.unescapeSuffix?"":e.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":e.unescapeSuffix||"",this.nestingPrefix=e.nestingPrefix?C(e.nestingPrefix):e.nestingPrefixEscaped||C("$t("),this.nestingSuffix=e.nestingSuffix?C(e.nestingSuffix):e.nestingSuffixEscaped||C(")"),this.nestingOptionsSeparator=e.nestingOptionsSeparator?e.nestingOptionsSeparator:e.nestingOptionsSeparator||",",this.maxReplaces=e.maxReplaces?e.maxReplaces:1e3,this.alwaysFormat=void 0!==e.alwaysFormat&&e.alwaysFormat,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var t="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(t,"g");var e="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(e,"g");var n="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(n,"g")}},{key:"interpolate",value:function(t,e,n,r){var i,o,s,h=this,u=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function l(t){return t.replace(/\$/g,"$$$$")}var c=function(t){if(t.indexOf(h.formatSeparator)<0){var i=S(e,u,t);return h.alwaysFormat?h.format(i,void 0,n,a({},r,e,{interpolationkey:t})):i}var o=t.split(h.formatSeparator),s=o.shift().trim(),l=o.join(h.formatSeparator).trim();return h.format(S(e,u,s),l,n,a({},r,e,{interpolationkey:s}))};this.resetRegExp();var f=r&&r.missingInterpolationHandler||this.options.missingInterpolationHandler,d=r&&r.interpolation&&r.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:function(t){return l(t)}},{regex:this.regexp,safeValue:function(t){return h.escapeValue?l(h.escape(t)):l(t)}}].forEach((function(e){for(s=0;i=e.regex.exec(t);){if(void 0===(o=c(i[1].trim())))if("function"==typeof f){var n=f(t,i,r);o="string"==typeof n?n:""}else{if(d){o=i[0];continue}h.logger.warn("missed to pass in variable ".concat(i[1]," for interpolating ").concat(t)),o=""}else"string"==typeof o||h.useRawValueToEscape||(o=y(o));var a=e.safeValue(o);if(t=t.replace(i[0],a),d?(e.regex.lastIndex+=a.length,e.regex.lastIndex-=i[0].length):e.regex.lastIndex=0,++s>=h.maxReplaces)break}})),t}},{key:"nest",value:function(t,e){var n,r,i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=a({},o);function h(t,e){var n=this.nestingOptionsSeparator;if(t.indexOf(n)<0)return t;var r=t.split(new RegExp("".concat(n,"[ ]*{"))),i="{".concat(r[1]);t=r[0],i=(i=this.interpolate(i,s)).replace(/'/g,'"');try{s=JSON.parse(i),e&&(s=a({},e,s))}catch(e){return this.logger.warn("failed parsing options string in nesting for key ".concat(t),e),"".concat(t).concat(n).concat(i)}return delete s.defaultValue,t}for(s.applyPostProcessor=!1,delete s.defaultValue;n=this.nestingRegexp.exec(t);){var u=[],l=!1;if(-1!==n[0].indexOf(this.formatSeparator)&&!/{.*}/.test(n[1])){var c=n[1].split(this.formatSeparator).map((function(t){return t.trim()}));n[1]=c.shift(),u=c,l=!0}if((r=e(h.call(this,n[1].trim(),s),s))&&n[0]===t&&"string"!=typeof r)return r;"string"!=typeof r&&(r=y(r)),r||(this.logger.warn("missed to resolve ".concat(n[1]," for nesting ").concat(t)),r=""),l&&(r=u.reduce((function(t,e){return i.format(t,e,o.lng,a({},o,{interpolationkey:n[1].trim()}))}),r.trim())),t=t.replace(n[0],r),this.regexp.lastIndex=0}return t}}]),t}(),z=function(t){function e(t,n,r){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return o(this,e),i=l(this,c(e).call(this)),T&&v.call(u(i)),i.backend=t,i.store=n,i.services=r,i.languageUtils=r.languageUtils,i.options=a,i.logger=p.create("backendConnector"),i.state={},i.queue=[],i.backend&&i.backend.init&&i.backend.init(r,a.backend,a),i}return d(e,t),h(e,[{key:"queueLoad",value:function(t,e,n,r){var i=this,a=[],o=[],s=[],h=[];return t.forEach((function(t){var r=!0;e.forEach((function(e){var s="".concat(t,"|").concat(e);!n.reload&&i.store.hasResourceBundle(t,e)?i.state[s]=2:i.state[s]<0||(1===i.state[s]?o.indexOf(s)<0&&o.push(s):(i.state[s]=1,r=!1,o.indexOf(s)<0&&o.push(s),a.indexOf(s)<0&&a.push(s),h.indexOf(e)<0&&h.push(e)))})),r||s.push(t)})),(a.length||o.length)&&this.queue.push({pending:o,loaded:{},errors:[],callback:r}),{toLoad:a,pending:o,toLoadLanguages:s,toLoadNamespaces:h}}},{key:"loaded",value:function(t,e,n){var r=t.split("|"),i=r[0],a=r[1];e&&this.emit("failedLoading",i,a,e),n&&this.store.addResourceBundle(i,a,n),this.state[t]=e?-1:2;var o={};this.queue.forEach((function(n){var r,s,h,u,l;r=n.loaded,s=a,(u=(h=b(r,[i],Object)).obj)[l=h.k]=u[l]||[],u[l].push(s),function(t,e){for(var n=t.indexOf(e);-1!==n;)t.splice(n,1),n=t.indexOf(e)}(n.pending,t),e&&n.errors.push(e),0!==n.pending.length||n.done||(Object.keys(n.loaded).forEach((function(t){o[t]||(o[t]=[]),n.loaded[t].length&&n.loaded[t].forEach((function(e){o[t].indexOf(e)<0&&o[t].push(e)}))})),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())})),this.emit("loaded",o),this.queue=this.queue.filter((function(t){return!t.done}))}},{key:"read",value:function(t,e,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:350,o=arguments.length>5?arguments[5]:void 0;return t.length?this.backend[n](t,e,(function(s,h){s&&h&&i<5?setTimeout((function(){r.read.call(r,t,e,n,i+1,2*a,o)}),a):o(s,h)})):o(null,{})}},{key:"prepareLoading",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();"string"==typeof t&&(t=this.languageUtils.toResolveHierarchy(t)),"string"==typeof e&&(e=[e]);var a=this.queueLoad(t,e,r,i);if(!a.toLoad.length)return a.pending.length||i(),null;a.toLoad.forEach((function(t){n.loadOne(t)}))}},{key:"load",value:function(t,e,n){this.prepareLoading(t,e,{},n)}},{key:"reload",value:function(t,e,n){this.prepareLoading(t,e,{reload:!0},n)}},{key:"loadOne",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=t.split("|"),i=r[0],a=r[1];this.read(i,a,"read",void 0,void 0,(function(r,o){r&&e.logger.warn("".concat(n,"loading namespace ").concat(a," for language ").concat(i," failed"),r),!r&&o&&e.logger.log("".concat(n,"loaded namespace ").concat(a," for language ").concat(i),o),e.loaded(t,r,o)}))}},{key:"saveMissing",value:function(t,e,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(e)?this.logger.warn('did not save key "'.concat(n,'" as the namespace "').concat(e,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!"):null!=n&&""!==n&&(this.backend&&this.backend.create&&this.backend.create(t,e,n,r,null,a({},o,{isUpdate:i})),t&&t[0]&&this.store.addResource(t[0],e,n,r))}}]),e}(v);function W(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,whitelist:!1,nonExplicitWhitelist:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(t){var e={};if("object"===r(t[1])&&(e=t[1]),"string"==typeof t[1]&&(e.defaultValue=t[1]),"string"==typeof t[2]&&(e.tDescription=t[2]),"object"===r(t[2])||"object"===r(t[3])){var n=t[3]||t[2];Object.keys(n).forEach((function(t){e[t]=n[t]}))}return e},interpolation:{escapeValue:!0,format:function(t,e,n,r){return t},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!1}}}function H(t){return"string"==typeof t.ns&&(t.ns=[t.ns]),"string"==typeof t.fallbackLng&&(t.fallbackLng=[t.fallbackLng]),"string"==typeof t.fallbackNS&&(t.fallbackNS=[t.fallbackNS]),t.whitelist&&(t.whitelist&&t.whitelist.indexOf("cimode")<0&&(t.whitelist=t.whitelist.concat(["cimode"])),t.supportedLngs=t.whitelist),t.nonExplicitWhitelist&&(t.nonExplicitSupportedLngs=t.nonExplicitWhitelist),t.supportedLngs&&t.supportedLngs.indexOf("cimode")<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),t}function U(){}const Y=new(function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;if(o(this,e),t=l(this,c(e).call(this)),T&&v.call(u(t)),t.options=H(n),t.services={},t.logger=p,t.modules={external:[]},r&&!t.isInitialized&&!n.isClone){if(!t.options.initImmediate)return t.init(n,r),l(t,u(t));setTimeout((function(){t.init(n,r)}),0)}return t}return d(e,t),h(e,[{key:"init",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;function r(t){return t?"function"==typeof t?new t:t:null}if("function"==typeof e&&(n=e,e={}),e.whitelist&&!e.supportedLngs&&this.logger.deprecate("whitelist",'option "whitelist" will be renamed to "supportedLngs" in the next major - please make sure to rename this option asap.'),e.nonExplicitWhitelist&&!e.nonExplicitSupportedLngs&&this.logger.deprecate("whitelist",'options "nonExplicitWhitelist" will be renamed to "nonExplicitSupportedLngs" in the next major - please make sure to rename this option asap.'),this.options=a({},W(),this.options,H(e)),this.format=this.options.interpolation.format,n||(n=U),!this.options.isClone){this.modules.logger?p.init(r(this.modules.logger),this.options):p.init(null,this.options);var i=new I(this.options);this.store=new L(this.options.resources,this.options);var o=this.services;o.logger=p,o.resourceStore=this.store,o.languageUtils=i,o.pluralResolver=new j(i,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),o.interpolator=new B(this.options),o.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},o.backendConnector=new z(r(this.modules.backend),o.resourceStore,o,this.options),o.backendConnector.on("*",(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t.emit.apply(t,[e].concat(r))})),this.modules.languageDetector&&(o.languageDetector=r(this.modules.languageDetector),o.languageDetector.init(o,this.options.detection,this.options)),this.modules.i18nFormat&&(o.i18nFormat=r(this.modules.i18nFormat),o.i18nFormat.init&&o.i18nFormat.init(this)),this.translator=new M(this.services,this.options),this.translator.on("*",(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t.emit.apply(t,[e].concat(r))})),this.modules.external.forEach((function(e){e.init&&e.init(t)}))}if(this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){var s=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);s.length>0&&"dev"!==s[0]&&(this.options.lng=s[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined");var h=["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"];h.forEach((function(e){t[e]=function(){var n;return(n=t.store)[e].apply(n,arguments)}}));var u=["addResource","addResources","addResourceBundle","removeResourceBundle"];u.forEach((function(e){t[e]=function(){var n;return(n=t.store)[e].apply(n,arguments),t}}));var l=m(),c=function(){var e=function(e,r){t.isInitialized&&!t.initializedStoreOnce&&t.logger.warn("init: i18next is already initialized. You should call init just once!"),t.isInitialized=!0,t.options.isClone||t.logger.log("initialized",t.options),t.emit("initialized",t.options),l.resolve(r),n(e,r)};if(t.languages&&"v1"!==t.options.compatibilityAPI&&!t.isInitialized)return e(null,t.t.bind(t));t.changeLanguage(t.options.lng,e)};return this.options.resources||!this.options.initImmediate?c():setTimeout(c,0),l}},{key:"loadResources",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:U,r=n,i="string"==typeof t?t:this.language;if("function"==typeof t&&(r=t),!this.options.resources||this.options.partialBundledLanguages){if(i&&"cimode"===i.toLowerCase())return r();var a=[],o=function(t){t&&e.services.languageUtils.toResolveHierarchy(t).forEach((function(t){a.indexOf(t)<0&&a.push(t)}))};if(i)o(i);else{var s=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);s.forEach((function(t){return o(t)}))}this.options.preload&&this.options.preload.forEach((function(t){return o(t)})),this.services.backendConnector.load(a,this.options.ns,r)}else r(null)}},{key:"reloadResources",value:function(t,e,n){var r=m();return t||(t=this.languages),e||(e=this.options.ns),n||(n=U),this.services.backendConnector.reload(t,e,(function(t){r.resolve(),n(t)})),r}},{key:"use",value:function(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===t.type&&(this.modules.backend=t),("logger"===t.type||t.log&&t.warn&&t.error)&&(this.modules.logger=t),"languageDetector"===t.type&&(this.modules.languageDetector=t),"i18nFormat"===t.type&&(this.modules.i18nFormat=t),"postProcessor"===t.type&&E.addPostProcessor(t),"3rdParty"===t.type&&this.modules.external.push(t),this}},{key:"changeLanguage",value:function(t,e){var n=this;this.isLanguageChangingTo=t;var r=m();this.emit("languageChanging",t);var i=function(i){t||i||!n.services.languageDetector||(i=[]);var a="string"==typeof i?i:n.services.languageUtils.getBestMatchFromCodes(i);a&&(n.language||(n.language=a,n.languages=n.services.languageUtils.toResolveHierarchy(a)),n.translator.language||n.translator.changeLanguage(a),n.services.languageDetector&&n.services.languageDetector.cacheUserLanguage(a)),n.loadResources(a,(function(t){!function(t,i){i?(n.language=i,n.languages=n.services.languageUtils.toResolveHierarchy(i),n.translator.changeLanguage(i),n.isLanguageChangingTo=void 0,n.emit("languageChanged",i),n.logger.log("languageChanged",i)):n.isLanguageChangingTo=void 0,r.resolve((function(){return n.t.apply(n,arguments)})),e&&e(t,(function(){return n.t.apply(n,arguments)}))}(t,a)}))};return t||!this.services.languageDetector||this.services.languageDetector.async?!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(i):i(t):i(this.services.languageDetector.detect()),r}},{key:"getFixedT",value:function(t,e){var n=this,i=function t(e,i){var o;if("object"!==r(i)){for(var s=arguments.length,h=new Array(s>2?s-2:0),u=2;u<s;u++)h[u-2]=arguments[u];o=n.options.overloadTranslationOptionHandler([e,i].concat(h))}else o=a({},i);return o.lng=o.lng||t.lng,o.lngs=o.lngs||t.lngs,o.ns=o.ns||t.ns,n.t(e,o)};return"string"==typeof t?i.lng=t:i.lngs=t,i.ns=e,i}},{key:"t",value:function(){var t;return this.translator&&(t=this.translator).translate.apply(t,arguments)}},{key:"exists",value:function(){var t;return this.translator&&(t=this.translator).exists.apply(t,arguments)}},{key:"setDefaultNamespace",value:function(t){this.options.defaultNS=t}},{key:"hasLoadedNamespace",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var r=this.languages[0],i=!!this.options&&this.options.fallbackLng,a=this.languages[this.languages.length-1];if("cimode"===r.toLowerCase())return!0;var o=function(t,n){var r=e.services.backendConnector.state["".concat(t,"|").concat(n)];return-1===r||2===r};if(n.precheck){var s=n.precheck(this,o);if(void 0!==s)return s}return!!this.hasResourceBundle(r,t)||!this.services.backendConnector.backend||!(!o(r,t)||i&&!o(a,t))}},{key:"loadNamespaces",value:function(t,e){var n=this,r=m();return this.options.ns?("string"==typeof t&&(t=[t]),t.forEach((function(t){n.options.ns.indexOf(t)<0&&n.options.ns.push(t)})),this.loadResources((function(t){r.resolve(),e&&e(t)})),r):(e&&e(),Promise.resolve())}},{key:"loadLanguages",value:function(t,e){var n=m();"string"==typeof t&&(t=[t]);var r=this.options.preload||[],i=t.filter((function(t){return r.indexOf(t)<0}));return i.length?(this.options.preload=r.concat(i),this.loadResources((function(t){n.resolve(),e&&e(t)})),n):(e&&e(),Promise.resolve())}},{key:"dir",value:function(t){return t||(t=this.languages&&this.languages.length>0?this.languages[0]:this.language),t?["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam"].indexOf(this.services.languageUtils.getLanguagePartFromCode(t))>=0?"rtl":"ltr":"rtl"}},{key:"createInstance",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return new e(t,n)}},{key:"cloneInstance",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:U,i=a({},this.options,n,{isClone:!0}),o=new e(i),s=["store","services","language"];return s.forEach((function(e){o[e]=t[e]})),o.services=a({},this.services),o.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},o.translator=new M(o.services,o.options),o.translator.on("*",(function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];o.emit.apply(o,[t].concat(n))})),o.init(i,r),o.translator.options=o.options,o.translator.backendConnector.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},o}},{key:"toJSON",value:function(){return{options:this.options,store:this.store,language:this.language,languages:this.languages}}}]),e}(v))},6486:function(t,e,n){var r;t=n.nmd(t),function(){var i,a="Expected a function",o="__lodash_hash_undefined__",s="__lodash_placeholder__",h=32,u=128,l=1/0,c=9007199254740991,f=NaN,d=4294967295,g=[["ary",u],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",h],["partialRight",64],["rearg",256]],p="[object Arguments]",v="[object Array]",m="[object Boolean]",y="[object Date]",_="[object Error]",b="[object Function]",x="[object GeneratorFunction]",w="[object Map]",S="[object Number]",k="[object Object]",C="[object Promise]",P="[object RegExp]",A="[object Set]",T="[object String]",O="[object Symbol]",L="[object WeakMap]",E="[object ArrayBuffer]",R="[object DataView]",M="[object Float32Array]",G="[object Float64Array]",I="[object Int8Array]",D="[object Int16Array]",F="[object Int32Array]",N="[object Uint8Array]",j="[object Uint8ClampedArray]",B="[object Uint16Array]",z="[object Uint32Array]",W=/\b__p \+= '';/g,H=/\b(__p \+=) '' \+/g,U=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Y=/&(?:amp|lt|gt|quot|#39);/g,q=/[&<>"']/g,X=RegExp(Y.source),V=RegExp(q.source),K=/<%-([\s\S]+?)%>/g,$=/<%([\s\S]+?)%>/g,J=/<%=([\s\S]+?)%>/g,Q=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Z=/^\w*$/,tt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,et=/[\\^$.*+?()[\]{}|]/g,nt=RegExp(et.source),rt=/^\s+/,it=/\s/,at=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ot=/\{\n\/\* \[wrapped with (.+)\] \*/,st=/,? & /,ht=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ut=/[()=,{}\[\]\/\s]/,lt=/\\(\\)?/g,ct=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ft=/\w*$/,dt=/^[-+]0x[0-9a-f]+$/i,gt=/^0b[01]+$/i,pt=/^\[object .+?Constructor\]$/,vt=/^0o[0-7]+$/i,mt=/^(?:0|[1-9]\d*)$/,yt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,_t=/($^)/,bt=/['\n\r\u2028\u2029\\]/g,xt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",wt="a-z\\xdf-\\xf6\\xf8-\\xff",St="A-Z\\xc0-\\xd6\\xd8-\\xde",kt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ct="["+kt+"]",Pt="["+xt+"]",At="\\d+",Tt="["+wt+"]",Ot="[^\\ud800-\\udfff"+kt+At+"\\u2700-\\u27bf"+wt+St+"]",Lt="\\ud83c[\\udffb-\\udfff]",Et="[^\\ud800-\\udfff]",Rt="(?:\\ud83c[\\udde6-\\uddff]){2}",Mt="[\\ud800-\\udbff][\\udc00-\\udfff]",Gt="["+St+"]",It="(?:"+Tt+"|"+Ot+")",Dt="(?:"+Gt+"|"+Ot+")",Ft="(?:['](?:d|ll|m|re|s|t|ve))?",Nt="(?:['](?:D|LL|M|RE|S|T|VE))?",jt="(?:"+Pt+"|"+Lt+")?",Bt="[\\ufe0e\\ufe0f]?",zt=Bt+jt+"(?:\\u200d(?:"+[Et,Rt,Mt].join("|")+")"+Bt+jt+")*",Wt="(?:"+["[\\u2700-\\u27bf]",Rt,Mt].join("|")+")"+zt,Ht="(?:"+[Et+Pt+"?",Pt,Rt,Mt,"[\\ud800-\\udfff]"].join("|")+")",Ut=RegExp("[']","g"),Yt=RegExp(Pt,"g"),qt=RegExp(Lt+"(?="+Lt+")|"+Ht+zt,"g"),Xt=RegExp([Gt+"?"+Tt+"+"+Ft+"(?="+[Ct,Gt,"$"].join("|")+")",Dt+"+"+Nt+"(?="+[Ct,Gt+It,"$"].join("|")+")",Gt+"?"+It+"+"+Ft,Gt+"+"+Nt,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",At,Wt].join("|"),"g"),Vt=RegExp("[\\u200d\\ud800-\\udfff"+xt+"\\ufe0e\\ufe0f]"),Kt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,$t=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Jt=-1,Qt={};Qt[M]=Qt[G]=Qt[I]=Qt[D]=Qt[F]=Qt[N]=Qt[j]=Qt[B]=Qt[z]=!0,Qt[p]=Qt[v]=Qt[E]=Qt[m]=Qt[R]=Qt[y]=Qt[_]=Qt[b]=Qt[w]=Qt[S]=Qt[k]=Qt[P]=Qt[A]=Qt[T]=Qt[L]=!1;var Zt={};Zt[p]=Zt[v]=Zt[E]=Zt[R]=Zt[m]=Zt[y]=Zt[M]=Zt[G]=Zt[I]=Zt[D]=Zt[F]=Zt[w]=Zt[S]=Zt[k]=Zt[P]=Zt[A]=Zt[T]=Zt[O]=Zt[N]=Zt[j]=Zt[B]=Zt[z]=!0,Zt[_]=Zt[b]=Zt[L]=!1;var te={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ee=parseFloat,ne=parseInt,re="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,ie="object"==typeof self&&self&&self.Object===Object&&self,ae=re||ie||Function("return this")(),oe=e&&!e.nodeType&&e,se=oe&&t&&!t.nodeType&&t,he=se&&se.exports===oe,ue=he&&re.process,le=function(){try{return se&&se.require&&se.require("util").types||ue&&ue.binding&&ue.binding("util")}catch(t){}}(),ce=le&&le.isArrayBuffer,fe=le&&le.isDate,de=le&&le.isMap,ge=le&&le.isRegExp,pe=le&&le.isSet,ve=le&&le.isTypedArray;function me(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function ye(t,e,n,r){for(var i=-1,a=null==t?0:t.length;++i<a;){var o=t[i];e(r,o,n(o),t)}return r}function _e(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function be(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function xe(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function we(t,e){for(var n=-1,r=null==t?0:t.length,i=0,a=[];++n<r;){var o=t[n];e(o,n,t)&&(a[i++]=o)}return a}function Se(t,e){return!(null==t||!t.length)&&Me(t,e,0)>-1}function ke(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}function Ce(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function Pe(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function Ae(t,e,n,r){var i=-1,a=null==t?0:t.length;for(r&&a&&(n=t[++i]);++i<a;)n=e(n,t[i],i,t);return n}function Te(t,e,n,r){var i=null==t?0:t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function Oe(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var Le=Fe("length");function Ee(t,e,n){var r;return n(t,(function(t,n,i){if(e(t,n,i))return r=n,!1})),r}function Re(t,e,n,r){for(var i=t.length,a=n+(r?1:-1);r?a--:++a<i;)if(e(t[a],a,t))return a;return-1}function Me(t,e,n){return e==e?function(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}(t,e,n):Re(t,Ie,n)}function Ge(t,e,n,r){for(var i=n-1,a=t.length;++i<a;)if(r(t[i],e))return i;return-1}function Ie(t){return t!=t}function De(t,e){var n=null==t?0:t.length;return n?Be(t,e)/n:f}function Fe(t){return function(e){return null==e?i:e[t]}}function Ne(t){return function(e){return null==t?i:t[e]}}function je(t,e,n,r,i){return i(t,(function(t,i,a){n=r?(r=!1,t):e(n,t,i,a)})),n}function Be(t,e){for(var n,r=-1,a=t.length;++r<a;){var o=e(t[r]);o!==i&&(n=n===i?o:n+o)}return n}function ze(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function We(t){return t?t.slice(0,sn(t)+1).replace(rt,""):t}function He(t){return function(e){return t(e)}}function Ue(t,e){return Ce(e,(function(e){return t[e]}))}function Ye(t,e){return t.has(e)}function qe(t,e){for(var n=-1,r=t.length;++n<r&&Me(e,t[n],0)>-1;);return n}function Xe(t,e){for(var n=t.length;n--&&Me(e,t[n],0)>-1;);return n}function Ve(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}var Ke=Ne({:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"}),$e=Ne({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Je(t){return"\\"+te[t]}function Qe(t){return Vt.test(t)}function Ze(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function tn(t,e){return function(n){return t(e(n))}}function en(t,e){for(var n=-1,r=t.length,i=0,a=[];++n<r;){var o=t[n];o!==e&&o!==s||(t[n]=s,a[i++]=n)}return a}function nn(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}function rn(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n}function an(t){return Qe(t)?function(t){for(var e=qt.lastIndex=0;qt.test(t);)++e;return e}(t):Le(t)}function on(t){return Qe(t)?function(t){return t.match(qt)||[]}(t):function(t){return t.split("")}(t)}function sn(t){for(var e=t.length;e--&&it.test(t.charAt(e)););return e}var hn=Ne({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),un=function t(e){var n,r=(e=null==e?ae:un.defaults(ae.Object(),e,un.pick(ae,$t))).Array,it=e.Date,xt=e.Error,wt=e.Function,St=e.Math,kt=e.Object,Ct=e.RegExp,Pt=e.String,At=e.TypeError,Tt=r.prototype,Ot=wt.prototype,Lt=kt.prototype,Et=e["__core-js_shared__"],Rt=Ot.toString,Mt=Lt.hasOwnProperty,Gt=0,It=(n=/[^.]+$/.exec(Et&&Et.keys&&Et.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",Dt=Lt.toString,Ft=Rt.call(kt),Nt=ae._,jt=Ct("^"+Rt.call(Mt).replace(et,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Bt=he?e.Buffer:i,zt=e.Symbol,Wt=e.Uint8Array,Ht=Bt?Bt.allocUnsafe:i,qt=tn(kt.getPrototypeOf,kt),Vt=kt.create,te=Lt.propertyIsEnumerable,re=Tt.splice,ie=zt?zt.isConcatSpreadable:i,oe=zt?zt.iterator:i,se=zt?zt.toStringTag:i,ue=function(){try{var t=ua(kt,"defineProperty");return t({},"",{}),t}catch(t){}}(),le=e.clearTimeout!==ae.clearTimeout&&e.clearTimeout,Le=it&&it.now!==ae.Date.now&&it.now,Ne=e.setTimeout!==ae.setTimeout&&e.setTimeout,ln=St.ceil,cn=St.floor,fn=kt.getOwnPropertySymbols,dn=Bt?Bt.isBuffer:i,gn=e.isFinite,pn=Tt.join,vn=tn(kt.keys,kt),mn=St.max,yn=St.min,_n=it.now,bn=e.parseInt,xn=St.random,wn=Tt.reverse,Sn=ua(e,"DataView"),kn=ua(e,"Map"),Cn=ua(e,"Promise"),Pn=ua(e,"Set"),An=ua(e,"WeakMap"),Tn=ua(kt,"create"),On=An&&new An,Ln={},En=Na(Sn),Rn=Na(kn),Mn=Na(Cn),Gn=Na(Pn),In=Na(An),Dn=zt?zt.prototype:i,Fn=Dn?Dn.valueOf:i,Nn=Dn?Dn.toString:i;function jn(t){if(ns(t)&&!Yo(t)&&!(t instanceof Hn)){if(t instanceof Wn)return t;if(Mt.call(t,"__wrapped__"))return ja(t)}return new Wn(t)}var Bn=function(){function t(){}return function(e){if(!es(e))return{};if(Vt)return Vt(e);t.prototype=e;var n=new t;return t.prototype=i,n}}();function zn(){}function Wn(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=i}function Hn(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=d,this.__views__=[]}function Un(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Yn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function qn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Xn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new qn;++e<n;)this.add(t[e])}function Vn(t){var e=this.__data__=new Yn(t);this.size=e.size}function Kn(t,e){var n=Yo(t),r=!n&&Uo(t),i=!n&&!r&&Ko(t),a=!n&&!r&&!i&&ls(t),o=n||r||i||a,s=o?ze(t.length,Pt):[],h=s.length;for(var u in t)!e&&!Mt.call(t,u)||o&&("length"==u||i&&("offset"==u||"parent"==u)||a&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||va(u,h))||s.push(u);return s}function $n(t){var e=t.length;return e?t[qr(0,e-1)]:i}function Jn(t,e){return Ma(Ai(t),or(e,0,t.length))}function Qn(t){return Ma(Ai(t))}function Zn(t,e,n){(n!==i&&!zo(t[e],n)||n===i&&!(e in t))&&ir(t,e,n)}function tr(t,e,n){var r=t[e];Mt.call(t,e)&&zo(r,n)&&(n!==i||e in t)||ir(t,e,n)}function er(t,e){for(var n=t.length;n--;)if(zo(t[n][0],e))return n;return-1}function nr(t,e,n,r){return cr(t,(function(t,i,a){e(r,t,n(t),a)})),r}function rr(t,e){return t&&Ti(e,Rs(e),t)}function ir(t,e,n){"__proto__"==e&&ue?ue(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function ar(t,e){for(var n=-1,a=e.length,o=r(a),s=null==t;++n<a;)o[n]=s?i:As(t,e[n]);return o}function or(t,e,n){return t==t&&(n!==i&&(t=t<=n?t:n),e!==i&&(t=t>=e?t:e)),t}function sr(t,e,n,r,a,o){var s,h=1&e,u=2&e,l=4&e;if(n&&(s=a?n(t,r,a,o):n(t)),s!==i)return s;if(!es(t))return t;var c=Yo(t);if(c){if(s=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&Mt.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!h)return Ai(t,s)}else{var f=fa(t),d=f==b||f==x;if(Ko(t))return xi(t,h);if(f==k||f==p||d&&!a){if(s=u||d?{}:ga(t),!h)return u?function(t,e){return Ti(t,ca(t),e)}(t,function(t,e){return t&&Ti(e,Ms(e),t)}(s,t)):function(t,e){return Ti(t,la(t),e)}(t,rr(s,t))}else{if(!Zt[f])return a?t:{};s=function(t,e,n){var r,i=t.constructor;switch(e){case E:return wi(t);case m:case y:return new i(+t);case R:return function(t,e){var n=e?wi(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case M:case G:case I:case D:case F:case N:case j:case B:case z:return Si(t,n);case w:return new i;case S:case T:return new i(t);case P:return function(t){var e=new t.constructor(t.source,ft.exec(t));return e.lastIndex=t.lastIndex,e}(t);case A:return new i;case O:return r=t,Fn?kt(Fn.call(r)):{}}}(t,f,h)}}o||(o=new Vn);var g=o.get(t);if(g)return g;o.set(t,s),ss(t)?t.forEach((function(r){s.add(sr(r,e,n,r,t,o))})):rs(t)&&t.forEach((function(r,i){s.set(i,sr(r,e,n,i,t,o))}));var v=c?i:(l?u?na:ea:u?Ms:Rs)(t);return _e(v||t,(function(r,i){v&&(r=t[i=r]),tr(s,i,sr(r,e,n,i,t,o))})),s}function hr(t,e,n){var r=n.length;if(null==t)return!r;for(t=kt(t);r--;){var a=n[r],o=e[a],s=t[a];if(s===i&&!(a in t)||!o(s))return!1}return!0}function ur(t,e,n){if("function"!=typeof t)throw new At(a);return Oa((function(){t.apply(i,n)}),e)}function lr(t,e,n,r){var i=-1,a=Se,o=!0,s=t.length,h=[],u=e.length;if(!s)return h;n&&(e=Ce(e,He(n))),r?(a=ke,o=!1):e.length>=200&&(a=Ye,o=!1,e=new Xn(e));t:for(;++i<s;){var l=t[i],c=null==n?l:n(l);if(l=r||0!==l?l:0,o&&c==c){for(var f=u;f--;)if(e[f]===c)continue t;h.push(l)}else a(e,c,r)||h.push(l)}return h}jn.templateSettings={escape:K,evaluate:$,interpolate:J,variable:"",imports:{_:jn}},jn.prototype=zn.prototype,jn.prototype.constructor=jn,Wn.prototype=Bn(zn.prototype),Wn.prototype.constructor=Wn,Hn.prototype=Bn(zn.prototype),Hn.prototype.constructor=Hn,Un.prototype.clear=function(){this.__data__=Tn?Tn(null):{},this.size=0},Un.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Un.prototype.get=function(t){var e=this.__data__;if(Tn){var n=e[t];return n===o?i:n}return Mt.call(e,t)?e[t]:i},Un.prototype.has=function(t){var e=this.__data__;return Tn?e[t]!==i:Mt.call(e,t)},Un.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Tn&&e===i?o:e,this},Yn.prototype.clear=function(){this.__data__=[],this.size=0},Yn.prototype.delete=function(t){var e=this.__data__,n=er(e,t);return!(n<0||(n==e.length-1?e.pop():re.call(e,n,1),--this.size,0))},Yn.prototype.get=function(t){var e=this.__data__,n=er(e,t);return n<0?i:e[n][1]},Yn.prototype.has=function(t){return er(this.__data__,t)>-1},Yn.prototype.set=function(t,e){var n=this.__data__,r=er(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},qn.prototype.clear=function(){this.size=0,this.__data__={hash:new Un,map:new(kn||Yn),string:new Un}},qn.prototype.delete=function(t){var e=sa(this,t).delete(t);return this.size-=e?1:0,e},qn.prototype.get=function(t){return sa(this,t).get(t)},qn.prototype.has=function(t){return sa(this,t).has(t)},qn.prototype.set=function(t,e){var n=sa(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},Xn.prototype.add=Xn.prototype.push=function(t){return this.__data__.set(t,o),this},Xn.prototype.has=function(t){return this.__data__.has(t)},Vn.prototype.clear=function(){this.__data__=new Yn,this.size=0},Vn.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Vn.prototype.get=function(t){return this.__data__.get(t)},Vn.prototype.has=function(t){return this.__data__.has(t)},Vn.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Yn){var r=n.__data__;if(!kn||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new qn(r)}return n.set(t,e),this.size=n.size,this};var cr=Ei(_r),fr=Ei(br,!0);function dr(t,e){var n=!0;return cr(t,(function(t,r,i){return n=!!e(t,r,i)})),n}function gr(t,e,n){for(var r=-1,a=t.length;++r<a;){var o=t[r],s=e(o);if(null!=s&&(h===i?s==s&&!us(s):n(s,h)))var h=s,u=o}return u}function pr(t,e){var n=[];return cr(t,(function(t,r,i){e(t,r,i)&&n.push(t)})),n}function vr(t,e,n,r,i){var a=-1,o=t.length;for(n||(n=pa),i||(i=[]);++a<o;){var s=t[a];e>0&&n(s)?e>1?vr(s,e-1,n,r,i):Pe(i,s):r||(i[i.length]=s)}return i}var mr=Ri(),yr=Ri(!0);function _r(t,e){return t&&mr(t,e,Rs)}function br(t,e){return t&&yr(t,e,Rs)}function xr(t,e){return we(e,(function(e){return Qo(t[e])}))}function wr(t,e){for(var n=0,r=(e=mi(e,t)).length;null!=t&&n<r;)t=t[Fa(e[n++])];return n&&n==r?t:i}function Sr(t,e,n){var r=e(t);return Yo(t)?r:Pe(r,n(t))}function kr(t){return null==t?t===i?"[object Undefined]":"[object Null]":se&&se in kt(t)?function(t){var e=Mt.call(t,se),n=t[se];try{t[se]=i;var r=!0}catch(t){}var a=Dt.call(t);return r&&(e?t[se]=n:delete t[se]),a}(t):function(t){return Dt.call(t)}(t)}function Cr(t,e){return t>e}function Pr(t,e){return null!=t&&Mt.call(t,e)}function Ar(t,e){return null!=t&&e in kt(t)}function Tr(t,e,n){for(var a=n?ke:Se,o=t[0].length,s=t.length,h=s,u=r(s),l=1/0,c=[];h--;){var f=t[h];h&&e&&(f=Ce(f,He(e))),l=yn(f.length,l),u[h]=!n&&(e||o>=120&&f.length>=120)?new Xn(h&&f):i}f=t[0];var d=-1,g=u[0];t:for(;++d<o&&c.length<l;){var p=f[d],v=e?e(p):p;if(p=n||0!==p?p:0,!(g?Ye(g,v):a(c,v,n))){for(h=s;--h;){var m=u[h];if(!(m?Ye(m,v):a(t[h],v,n)))continue t}g&&g.push(v),c.push(p)}}return c}function Or(t,e,n){var r=null==(t=Ca(t,e=mi(e,t)))?t:t[Fa($a(e))];return null==r?i:me(r,t,n)}function Lr(t){return ns(t)&&kr(t)==p}function Er(t,e,n,r,a){return t===e||(null==t||null==e||!ns(t)&&!ns(e)?t!=t&&e!=e:function(t,e,n,r,a,o){var s=Yo(t),h=Yo(e),u=s?v:fa(t),l=h?v:fa(e),c=(u=u==p?k:u)==k,f=(l=l==p?k:l)==k,d=u==l;if(d&&Ko(t)){if(!Ko(e))return!1;s=!0,c=!1}if(d&&!c)return o||(o=new Vn),s||ls(t)?Zi(t,e,n,r,a,o):function(t,e,n,r,i,a,o){switch(n){case R:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case E:return!(t.byteLength!=e.byteLength||!a(new Wt(t),new Wt(e)));case m:case y:case S:return zo(+t,+e);case _:return t.name==e.name&&t.message==e.message;case P:case T:return t==e+"";case w:var s=Ze;case A:var h=1&r;if(s||(s=nn),t.size!=e.size&&!h)return!1;var u=o.get(t);if(u)return u==e;r|=2,o.set(t,e);var l=Zi(s(t),s(e),r,i,a,o);return o.delete(t),l;case O:if(Fn)return Fn.call(t)==Fn.call(e)}return!1}(t,e,u,n,r,a,o);if(!(1&n)){var g=c&&Mt.call(t,"__wrapped__"),b=f&&Mt.call(e,"__wrapped__");if(g||b){var x=g?t.value():t,C=b?e.value():e;return o||(o=new Vn),a(x,C,n,r,o)}}return!!d&&(o||(o=new Vn),function(t,e,n,r,a,o){var s=1&n,h=ea(t),u=h.length;if(u!=ea(e).length&&!s)return!1;for(var l=u;l--;){var c=h[l];if(!(s?c in e:Mt.call(e,c)))return!1}var f=o.get(t),d=o.get(e);if(f&&d)return f==e&&d==t;var g=!0;o.set(t,e),o.set(e,t);for(var p=s;++l<u;){var v=t[c=h[l]],m=e[c];if(r)var y=s?r(m,v,c,e,t,o):r(v,m,c,t,e,o);if(!(y===i?v===m||a(v,m,n,r,o):y)){g=!1;break}p||(p="constructor"==c)}if(g&&!p){var _=t.constructor,b=e.constructor;_==b||!("constructor"in t)||!("constructor"in e)||"function"==typeof _&&_ instanceof _&&"function"==typeof b&&b instanceof b||(g=!1)}return o.delete(t),o.delete(e),g}(t,e,n,r,a,o))}(t,e,n,r,Er,a))}function Rr(t,e,n,r){var a=n.length,o=a,s=!r;if(null==t)return!o;for(t=kt(t);a--;){var h=n[a];if(s&&h[2]?h[1]!==t[h[0]]:!(h[0]in t))return!1}for(;++a<o;){var u=(h=n[a])[0],l=t[u],c=h[1];if(s&&h[2]){if(l===i&&!(u in t))return!1}else{var f=new Vn;if(r)var d=r(l,c,u,t,e,f);if(!(d===i?Er(c,l,3,r,f):d))return!1}}return!0}function Mr(t){return!(!es(t)||(e=t,It&&It in e))&&(Qo(t)?jt:pt).test(Na(t));var e}function Gr(t){return"function"==typeof t?t:null==t?ih:"object"==typeof t?Yo(t)?jr(t[0],t[1]):Nr(t):dh(t)}function Ir(t){if(!xa(t))return vn(t);var e=[];for(var n in kt(t))Mt.call(t,n)&&"constructor"!=n&&e.push(n);return e}function Dr(t,e){return t<e}function Fr(t,e){var n=-1,i=Xo(t)?r(t.length):[];return cr(t,(function(t,r,a){i[++n]=e(t,r,a)})),i}function Nr(t){var e=ha(t);return 1==e.length&&e[0][2]?Sa(e[0][0],e[0][1]):function(n){return n===t||Rr(n,t,e)}}function jr(t,e){return ya(t)&&wa(e)?Sa(Fa(t),e):function(n){var r=As(n,t);return r===i&&r===e?Ts(n,t):Er(e,r,3)}}function Br(t,e,n,r,a){t!==e&&mr(e,(function(o,s){if(a||(a=new Vn),es(o))!function(t,e,n,r,a,o,s){var h=Aa(t,n),u=Aa(e,n),l=s.get(u);if(l)Zn(t,n,l);else{var c=o?o(h,u,n+"",t,e,s):i,f=c===i;if(f){var d=Yo(u),g=!d&&Ko(u),p=!d&&!g&&ls(u);c=u,d||g||p?Yo(h)?c=h:Vo(h)?c=Ai(h):g?(f=!1,c=xi(u,!0)):p?(f=!1,c=Si(u,!0)):c=[]:as(u)||Uo(u)?(c=h,Uo(h)?c=ys(h):es(h)&&!Qo(h)||(c=ga(u))):f=!1}f&&(s.set(u,c),a(c,u,r,o,s),s.delete(u)),Zn(t,n,c)}}(t,e,s,n,Br,r,a);else{var h=r?r(Aa(t,s),o,s+"",t,e,a):i;h===i&&(h=o),Zn(t,s,h)}}),Ms)}function zr(t,e){var n=t.length;if(n)return va(e+=e<0?n:0,n)?t[e]:i}function Wr(t,e,n){e=e.length?Ce(e,(function(t){return Yo(t)?function(e){return wr(e,1===t.length?t[0]:t)}:t})):[ih];var r=-1;return e=Ce(e,He(oa())),function(t,e){var r=t.length;for(t.sort((function(t,e){return function(t,e,n){for(var r=-1,i=t.criteria,a=e.criteria,o=i.length,s=n.length;++r<o;){var h=ki(i[r],a[r]);if(h)return r>=s?h:h*("desc"==n[r]?-1:1)}return t.index-e.index}(t,e,n)}));r--;)t[r]=t[r].value;return t}(Fr(t,(function(t,n,i){return{criteria:Ce(e,(function(e){return e(t)})),index:++r,value:t}})))}function Hr(t,e,n){for(var r=-1,i=e.length,a={};++r<i;){var o=e[r],s=wr(t,o);n(s,o)&&Jr(a,mi(o,t),s)}return a}function Ur(t,e,n,r){var i=r?Ge:Me,a=-1,o=e.length,s=t;for(t===e&&(e=Ai(e)),n&&(s=Ce(t,He(n)));++a<o;)for(var h=0,u=e[a],l=n?n(u):u;(h=i(s,l,h,r))>-1;)s!==t&&re.call(s,h,1),re.call(t,h,1);return t}function Yr(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==a){var a=i;va(i)?re.call(t,i,1):ui(t,i)}}return t}function qr(t,e){return t+cn(xn()*(e-t+1))}function Xr(t,e){var n="";if(!t||e<1||e>c)return n;do{e%2&&(n+=t),(e=cn(e/2))&&(t+=t)}while(e);return n}function Vr(t,e){return La(ka(t,e,ih),t+"")}function Kr(t){return $n(zs(t))}function $r(t,e){var n=zs(t);return Ma(n,or(e,0,n.length))}function Jr(t,e,n,r){if(!es(t))return t;for(var a=-1,o=(e=mi(e,t)).length,s=o-1,h=t;null!=h&&++a<o;){var u=Fa(e[a]),l=n;if("__proto__"===u||"constructor"===u||"prototype"===u)return t;if(a!=s){var c=h[u];(l=r?r(c,u,h):i)===i&&(l=es(c)?c:va(e[a+1])?[]:{})}tr(h,u,l),h=h[u]}return t}var Qr=On?function(t,e){return On.set(t,e),t}:ih,Zr=ue?function(t,e){return ue(t,"toString",{configurable:!0,enumerable:!1,value:eh(e),writable:!0})}:ih;function ti(t){return Ma(zs(t))}function ei(t,e,n){var i=-1,a=t.length;e<0&&(e=-e>a?0:a+e),(n=n>a?a:n)<0&&(n+=a),a=e>n?0:n-e>>>0,e>>>=0;for(var o=r(a);++i<a;)o[i]=t[i+e];return o}function ni(t,e){var n;return cr(t,(function(t,r,i){return!(n=e(t,r,i))})),!!n}function ri(t,e,n){var r=0,i=null==t?r:t.length;if("number"==typeof e&&e==e&&i<=2147483647){for(;r<i;){var a=r+i>>>1,o=t[a];null!==o&&!us(o)&&(n?o<=e:o<e)?r=a+1:i=a}return i}return ii(t,e,ih,n)}function ii(t,e,n,r){var a=0,o=null==t?0:t.length;if(0===o)return 0;for(var s=(e=n(e))!=e,h=null===e,u=us(e),l=e===i;a<o;){var c=cn((a+o)/2),f=n(t[c]),d=f!==i,g=null===f,p=f==f,v=us(f);if(s)var m=r||p;else m=l?p&&(r||d):h?p&&d&&(r||!g):u?p&&d&&!g&&(r||!v):!g&&!v&&(r?f<=e:f<e);m?a=c+1:o=c}return yn(o,4294967294)}function ai(t,e){for(var n=-1,r=t.length,i=0,a=[];++n<r;){var o=t[n],s=e?e(o):o;if(!n||!zo(s,h)){var h=s;a[i++]=0===o?0:o}}return a}function oi(t){return"number"==typeof t?t:us(t)?f:+t}function si(t){if("string"==typeof t)return t;if(Yo(t))return Ce(t,si)+"";if(us(t))return Nn?Nn.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function hi(t,e,n){var r=-1,i=Se,a=t.length,o=!0,s=[],h=s;if(n)o=!1,i=ke;else if(a>=200){var u=e?null:Xi(t);if(u)return nn(u);o=!1,i=Ye,h=new Xn}else h=e?[]:s;t:for(;++r<a;){var l=t[r],c=e?e(l):l;if(l=n||0!==l?l:0,o&&c==c){for(var f=h.length;f--;)if(h[f]===c)continue t;e&&h.push(c),s.push(l)}else i(h,c,n)||(h!==s&&h.push(c),s.push(l))}return s}function ui(t,e){return null==(t=Ca(t,e=mi(e,t)))||delete t[Fa($a(e))]}function li(t,e,n,r){return Jr(t,e,n(wr(t,e)),r)}function ci(t,e,n,r){for(var i=t.length,a=r?i:-1;(r?a--:++a<i)&&e(t[a],a,t););return n?ei(t,r?0:a,r?a+1:i):ei(t,r?a+1:0,r?i:a)}function fi(t,e){var n=t;return n instanceof Hn&&(n=n.value()),Ae(e,(function(t,e){return e.func.apply(e.thisArg,Pe([t],e.args))}),n)}function di(t,e,n){var i=t.length;if(i<2)return i?hi(t[0]):[];for(var a=-1,o=r(i);++a<i;)for(var s=t[a],h=-1;++h<i;)h!=a&&(o[a]=lr(o[a]||s,t[h],e,n));return hi(vr(o,1),e,n)}function gi(t,e,n){for(var r=-1,a=t.length,o=e.length,s={};++r<a;){var h=r<o?e[r]:i;n(s,t[r],h)}return s}function pi(t){return Vo(t)?t:[]}function vi(t){return"function"==typeof t?t:ih}function mi(t,e){return Yo(t)?t:ya(t,e)?[t]:Da(_s(t))}var yi=Vr;function _i(t,e,n){var r=t.length;return n=n===i?r:n,!e&&n>=r?t:ei(t,e,n)}var bi=le||function(t){return ae.clearTimeout(t)};function xi(t,e){if(e)return t.slice();var n=t.length,r=Ht?Ht(n):new t.constructor(n);return t.copy(r),r}function wi(t){var e=new t.constructor(t.byteLength);return new Wt(e).set(new Wt(t)),e}function Si(t,e){var n=e?wi(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function ki(t,e){if(t!==e){var n=t!==i,r=null===t,a=t==t,o=us(t),s=e!==i,h=null===e,u=e==e,l=us(e);if(!h&&!l&&!o&&t>e||o&&s&&u&&!h&&!l||r&&s&&u||!n&&u||!a)return 1;if(!r&&!o&&!l&&t<e||l&&n&&a&&!r&&!o||h&&n&&a||!s&&a||!u)return-1}return 0}function Ci(t,e,n,i){for(var a=-1,o=t.length,s=n.length,h=-1,u=e.length,l=mn(o-s,0),c=r(u+l),f=!i;++h<u;)c[h]=e[h];for(;++a<s;)(f||a<o)&&(c[n[a]]=t[a]);for(;l--;)c[h++]=t[a++];return c}function Pi(t,e,n,i){for(var a=-1,o=t.length,s=-1,h=n.length,u=-1,l=e.length,c=mn(o-h,0),f=r(c+l),d=!i;++a<c;)f[a]=t[a];for(var g=a;++u<l;)f[g+u]=e[u];for(;++s<h;)(d||a<o)&&(f[g+n[s]]=t[a++]);return f}function Ai(t,e){var n=-1,i=t.length;for(e||(e=r(i));++n<i;)e[n]=t[n];return e}function Ti(t,e,n,r){var a=!n;n||(n={});for(var o=-1,s=e.length;++o<s;){var h=e[o],u=r?r(n[h],t[h],h,n,t):i;u===i&&(u=t[h]),a?ir(n,h,u):tr(n,h,u)}return n}function Oi(t,e){return function(n,r){var i=Yo(n)?ye:nr,a=e?e():{};return i(n,t,oa(r,2),a)}}function Li(t){return Vr((function(e,n){var r=-1,a=n.length,o=a>1?n[a-1]:i,s=a>2?n[2]:i;for(o=t.length>3&&"function"==typeof o?(a--,o):i,s&&ma(n[0],n[1],s)&&(o=a<3?i:o,a=1),e=kt(e);++r<a;){var h=n[r];h&&t(e,h,r,o)}return e}))}function Ei(t,e){return function(n,r){if(null==n)return n;if(!Xo(n))return t(n,r);for(var i=n.length,a=e?i:-1,o=kt(n);(e?a--:++a<i)&&!1!==r(o[a],a,o););return n}}function Ri(t){return function(e,n,r){for(var i=-1,a=kt(e),o=r(e),s=o.length;s--;){var h=o[t?s:++i];if(!1===n(a[h],h,a))break}return e}}function Mi(t){return function(e){var n=Qe(e=_s(e))?on(e):i,r=n?n[0]:e.charAt(0),a=n?_i(n,1).join(""):e.slice(1);return r[t]()+a}}function Gi(t){return function(e){return Ae(Qs(Us(e).replace(Ut,"")),t,"")}}function Ii(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=Bn(t.prototype),r=t.apply(n,e);return es(r)?r:n}}function Di(t){return function(e,n,r){var a=kt(e);if(!Xo(e)){var o=oa(n,3);e=Rs(e),n=function(t){return o(a[t],t,a)}}var s=t(e,n,r);return s>-1?a[o?e[s]:s]:i}}function Fi(t){return ta((function(e){var n=e.length,r=n,o=Wn.prototype.thru;for(t&&e.reverse();r--;){var s=e[r];if("function"!=typeof s)throw new At(a);if(o&&!h&&"wrapper"==ia(s))var h=new Wn([],!0)}for(r=h?r:n;++r<n;){var u=ia(s=e[r]),l="wrapper"==u?ra(s):i;h=l&&_a(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?h[ia(l[0])].apply(h,l[3]):1==s.length&&_a(s)?h[u]():h.thru(s)}return function(){var t=arguments,r=t[0];if(h&&1==t.length&&Yo(r))return h.plant(r).value();for(var i=0,a=n?e[i].apply(this,t):r;++i<n;)a=e[i].call(this,a);return a}}))}function Ni(t,e,n,a,o,s,h,l,c,f){var d=e&u,g=1&e,p=2&e,v=24&e,m=512&e,y=p?i:Ii(t);return function i(){for(var u=arguments.length,_=r(u),b=u;b--;)_[b]=arguments[b];if(v)var x=aa(i),w=Ve(_,x);if(a&&(_=Ci(_,a,o,v)),s&&(_=Pi(_,s,h,v)),u-=w,v&&u<f){var S=en(_,x);return Yi(t,e,Ni,i.placeholder,n,_,S,l,c,f-u)}var k=g?n:this,C=p?k[t]:t;return u=_.length,l?_=Pa(_,l):m&&u>1&&_.reverse(),d&&c<u&&(_.length=c),this&&this!==ae&&this instanceof i&&(C=y||Ii(C)),C.apply(k,_)}}function ji(t,e){return function(n,r){return function(t,e,n,r){return _r(t,(function(t,i,a){e(r,n(t),i,a)})),r}(n,t,e(r),{})}}function Bi(t,e){return function(n,r){var a;if(n===i&&r===i)return e;if(n!==i&&(a=n),r!==i){if(a===i)return r;"string"==typeof n||"string"==typeof r?(n=si(n),r=si(r)):(n=oi(n),r=oi(r)),a=t(n,r)}return a}}function zi(t){return ta((function(e){return e=Ce(e,He(oa())),Vr((function(n){var r=this;return t(e,(function(t){return me(t,r,n)}))}))}))}function Wi(t,e){var n=(e=e===i?" ":si(e)).length;if(n<2)return n?Xr(e,t):e;var r=Xr(e,ln(t/an(e)));return Qe(e)?_i(on(r),0,t).join(""):r.slice(0,t)}function Hi(t){return function(e,n,a){return a&&"number"!=typeof a&&ma(e,n,a)&&(n=a=i),e=gs(e),n===i?(n=e,e=0):n=gs(n),function(t,e,n,i){for(var a=-1,o=mn(ln((e-t)/(n||1)),0),s=r(o);o--;)s[i?o:++a]=t,t+=n;return s}(e,n,a=a===i?e<n?1:-1:gs(a),t)}}function Ui(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=ms(e),n=ms(n)),t(e,n)}}function Yi(t,e,n,r,a,o,s,u,l,c){var f=8&e;e|=f?h:64,4&(e&=~(f?64:h))||(e&=-4);var d=[t,e,a,f?o:i,f?s:i,f?i:o,f?i:s,u,l,c],g=n.apply(i,d);return _a(t)&&Ta(g,d),g.placeholder=r,Ea(g,t,e)}function qi(t){var e=St[t];return function(t,n){if(t=ms(t),(n=null==n?0:yn(ps(n),292))&&gn(t)){var r=(_s(t)+"e").split("e");return+((r=(_s(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}var Xi=Pn&&1/nn(new Pn([,-0]))[1]==l?function(t){return new Pn(t)}:uh;function Vi(t){return function(e){var n=fa(e);return n==w?Ze(e):n==A?rn(e):function(t,e){return Ce(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function Ki(t,e,n,o,l,c,f,d){var g=2&e;if(!g&&"function"!=typeof t)throw new At(a);var p=o?o.length:0;if(p||(e&=-97,o=l=i),f=f===i?f:mn(ps(f),0),d=d===i?d:ps(d),p-=l?l.length:0,64&e){var v=o,m=l;o=l=i}var y=g?i:ra(t),_=[t,e,n,o,l,v,m,c,f,d];if(y&&function(t,e){var n=t[1],r=e[1],i=n|r,a=i<131,o=r==u&&8==n||r==u&&256==n&&t[7].length<=e[8]||384==r&&e[7].length<=e[8]&&8==n;if(!a&&!o)return t;1&r&&(t[2]=e[2],i|=1&n?0:4);var h=e[3];if(h){var l=t[3];t[3]=l?Ci(l,h,e[4]):h,t[4]=l?en(t[3],s):e[4]}(h=e[5])&&(l=t[5],t[5]=l?Pi(l,h,e[6]):h,t[6]=l?en(t[5],s):e[6]),(h=e[7])&&(t[7]=h),r&u&&(t[8]=null==t[8]?e[8]:yn(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i}(_,y),t=_[0],e=_[1],n=_[2],o=_[3],l=_[4],!(d=_[9]=_[9]===i?g?0:t.length:mn(_[9]-p,0))&&24&e&&(e&=-25),e&&1!=e)b=8==e||16==e?function(t,e,n){var a=Ii(t);return function o(){for(var s=arguments.length,h=r(s),u=s,l=aa(o);u--;)h[u]=arguments[u];var c=s<3&&h[0]!==l&&h[s-1]!==l?[]:en(h,l);return(s-=c.length)<n?Yi(t,e,Ni,o.placeholder,i,h,c,i,i,n-s):me(this&&this!==ae&&this instanceof o?a:t,this,h)}}(t,e,d):e!=h&&33!=e||l.length?Ni.apply(i,_):function(t,e,n,i){var a=1&e,o=Ii(t);return function e(){for(var s=-1,h=arguments.length,u=-1,l=i.length,c=r(l+h),f=this&&this!==ae&&this instanceof e?o:t;++u<l;)c[u]=i[u];for(;h--;)c[u++]=arguments[++s];return me(f,a?n:this,c)}}(t,e,n,o);else var b=function(t,e,n){var r=1&e,i=Ii(t);return function e(){return(this&&this!==ae&&this instanceof e?i:t).apply(r?n:this,arguments)}}(t,e,n);return Ea((y?Qr:Ta)(b,_),t,e)}function $i(t,e,n,r){return t===i||zo(t,Lt[n])&&!Mt.call(r,n)?e:t}function Ji(t,e,n,r,a,o){return es(t)&&es(e)&&(o.set(e,t),Br(t,e,i,Ji,o),o.delete(e)),t}function Qi(t){return as(t)?i:t}function Zi(t,e,n,r,a,o){var s=1&n,h=t.length,u=e.length;if(h!=u&&!(s&&u>h))return!1;var l=o.get(t),c=o.get(e);if(l&&c)return l==e&&c==t;var f=-1,d=!0,g=2&n?new Xn:i;for(o.set(t,e),o.set(e,t);++f<h;){var p=t[f],v=e[f];if(r)var m=s?r(v,p,f,e,t,o):r(p,v,f,t,e,o);if(m!==i){if(m)continue;d=!1;break}if(g){if(!Oe(e,(function(t,e){if(!Ye(g,e)&&(p===t||a(p,t,n,r,o)))return g.push(e)}))){d=!1;break}}else if(p!==v&&!a(p,v,n,r,o)){d=!1;break}}return o.delete(t),o.delete(e),d}function ta(t){return La(ka(t,i,Ya),t+"")}function ea(t){return Sr(t,Rs,la)}function na(t){return Sr(t,Ms,ca)}var ra=On?function(t){return On.get(t)}:uh;function ia(t){for(var e=t.name+"",n=Ln[e],r=Mt.call(Ln,e)?n.length:0;r--;){var i=n[r],a=i.func;if(null==a||a==t)return i.name}return e}function aa(t){return(Mt.call(jn,"placeholder")?jn:t).placeholder}function oa(){var t=jn.iteratee||ah;return t=t===ah?Gr:t,arguments.length?t(arguments[0],arguments[1]):t}function sa(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function ha(t){for(var e=Rs(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,wa(i)]}return e}function ua(t,e){var n=function(t,e){return null==t?i:t[e]}(t,e);return Mr(n)?n:i}var la=fn?function(t){return null==t?[]:(t=kt(t),we(fn(t),(function(e){return te.call(t,e)})))}:vh,ca=fn?function(t){for(var e=[];t;)Pe(e,la(t)),t=qt(t);return e}:vh,fa=kr;function da(t,e,n){for(var r=-1,i=(e=mi(e,t)).length,a=!1;++r<i;){var o=Fa(e[r]);if(!(a=null!=t&&n(t,o)))break;t=t[o]}return a||++r!=i?a:!!(i=null==t?0:t.length)&&ts(i)&&va(o,i)&&(Yo(t)||Uo(t))}function ga(t){return"function"!=typeof t.constructor||xa(t)?{}:Bn(qt(t))}function pa(t){return Yo(t)||Uo(t)||!!(ie&&t&&t[ie])}function va(t,e){var n=typeof t;return!!(e=null==e?c:e)&&("number"==n||"symbol"!=n&&mt.test(t))&&t>-1&&t%1==0&&t<e}function ma(t,e,n){if(!es(n))return!1;var r=typeof e;return!!("number"==r?Xo(n)&&va(e,n.length):"string"==r&&e in n)&&zo(n[e],t)}function ya(t,e){if(Yo(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!us(t))||Z.test(t)||!Q.test(t)||null!=e&&t in kt(e)}function _a(t){var e=ia(t),n=jn[e];if("function"!=typeof n||!(e in Hn.prototype))return!1;if(t===n)return!0;var r=ra(n);return!!r&&t===r[0]}(Sn&&fa(new Sn(new ArrayBuffer(1)))!=R||kn&&fa(new kn)!=w||Cn&&fa(Cn.resolve())!=C||Pn&&fa(new Pn)!=A||An&&fa(new An)!=L)&&(fa=function(t){var e=kr(t),n=e==k?t.constructor:i,r=n?Na(n):"";if(r)switch(r){case En:return R;case Rn:return w;case Mn:return C;case Gn:return A;case In:return L}return e});var ba=Et?Qo:mh;function xa(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Lt)}function wa(t){return t==t&&!es(t)}function Sa(t,e){return function(n){return null!=n&&n[t]===e&&(e!==i||t in kt(n))}}function ka(t,e,n){return e=mn(e===i?t.length-1:e,0),function(){for(var i=arguments,a=-1,o=mn(i.length-e,0),s=r(o);++a<o;)s[a]=i[e+a];a=-1;for(var h=r(e+1);++a<e;)h[a]=i[a];return h[e]=n(s),me(t,this,h)}}function Ca(t,e){return e.length<2?t:wr(t,ei(e,0,-1))}function Pa(t,e){for(var n=t.length,r=yn(e.length,n),a=Ai(t);r--;){var o=e[r];t[r]=va(o,n)?a[o]:i}return t}function Aa(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var Ta=Ra(Qr),Oa=Ne||function(t,e){return ae.setTimeout(t,e)},La=Ra(Zr);function Ea(t,e,n){var r=e+"";return La(t,function(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(at,"{\n/* [wrapped with "+e+"] */\n")}(r,function(t,e){return _e(g,(function(n){var r="_."+n[0];e&n[1]&&!Se(t,r)&&t.push(r)})),t.sort()}(function(t){var e=t.match(ot);return e?e[1].split(st):[]}(r),n)))}function Ra(t){var e=0,n=0;return function(){var r=_n(),a=16-(r-n);if(n=r,a>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(i,arguments)}}function Ma(t,e){var n=-1,r=t.length,a=r-1;for(e=e===i?r:e;++n<e;){var o=qr(n,a),s=t[o];t[o]=t[n],t[n]=s}return t.length=e,t}var Ga,Ia,Da=(Ga=Io((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(tt,(function(t,n,r,i){e.push(r?i.replace(lt,"$1"):n||t)})),e}),(function(t){return 500===Ia.size&&Ia.clear(),t})),Ia=Ga.cache,Ga);function Fa(t){if("string"==typeof t||us(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Na(t){if(null!=t){try{return Rt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function ja(t){if(t instanceof Hn)return t.clone();var e=new Wn(t.__wrapped__,t.__chain__);return e.__actions__=Ai(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Ba=Vr((function(t,e){return Vo(t)?lr(t,vr(e,1,Vo,!0)):[]})),za=Vr((function(t,e){var n=$a(e);return Vo(n)&&(n=i),Vo(t)?lr(t,vr(e,1,Vo,!0),oa(n,2)):[]})),Wa=Vr((function(t,e){var n=$a(e);return Vo(n)&&(n=i),Vo(t)?lr(t,vr(e,1,Vo,!0),i,n):[]}));function Ha(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:ps(n);return i<0&&(i=mn(r+i,0)),Re(t,oa(e,3),i)}function Ua(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var a=r-1;return n!==i&&(a=ps(n),a=n<0?mn(r+a,0):yn(a,r-1)),Re(t,oa(e,3),a,!0)}function Ya(t){return null!=t&&t.length?vr(t,1):[]}function qa(t){return t&&t.length?t[0]:i}var Xa=Vr((function(t){var e=Ce(t,pi);return e.length&&e[0]===t[0]?Tr(e):[]})),Va=Vr((function(t){var e=$a(t),n=Ce(t,pi);return e===$a(n)?e=i:n.pop(),n.length&&n[0]===t[0]?Tr(n,oa(e,2)):[]})),Ka=Vr((function(t){var e=$a(t),n=Ce(t,pi);return(e="function"==typeof e?e:i)&&n.pop(),n.length&&n[0]===t[0]?Tr(n,i,e):[]}));function $a(t){var e=null==t?0:t.length;return e?t[e-1]:i}var Ja=Vr(Qa);function Qa(t,e){return t&&t.length&&e&&e.length?Ur(t,e):t}var Za=ta((function(t,e){var n=null==t?0:t.length,r=ar(t,e);return Yr(t,Ce(e,(function(t){return va(t,n)?+t:t})).sort(ki)),r}));function to(t){return null==t?t:wn.call(t)}var eo=Vr((function(t){return hi(vr(t,1,Vo,!0))})),no=Vr((function(t){var e=$a(t);return Vo(e)&&(e=i),hi(vr(t,1,Vo,!0),oa(e,2))})),ro=Vr((function(t){var e=$a(t);return e="function"==typeof e?e:i,hi(vr(t,1,Vo,!0),i,e)}));function io(t){if(!t||!t.length)return[];var e=0;return t=we(t,(function(t){if(Vo(t))return e=mn(t.length,e),!0})),ze(e,(function(e){return Ce(t,Fe(e))}))}function ao(t,e){if(!t||!t.length)return[];var n=io(t);return null==e?n:Ce(n,(function(t){return me(e,i,t)}))}var oo=Vr((function(t,e){return Vo(t)?lr(t,e):[]})),so=Vr((function(t){return di(we(t,Vo))})),ho=Vr((function(t){var e=$a(t);return Vo(e)&&(e=i),di(we(t,Vo),oa(e,2))})),uo=Vr((function(t){var e=$a(t);return e="function"==typeof e?e:i,di(we(t,Vo),i,e)})),lo=Vr(io),co=Vr((function(t){var e=t.length,n=e>1?t[e-1]:i;return n="function"==typeof n?(t.pop(),n):i,ao(t,n)}));function fo(t){var e=jn(t);return e.__chain__=!0,e}function go(t,e){return e(t)}var po=ta((function(t){var e=t.length,n=e?t[0]:0,r=this.__wrapped__,a=function(e){return ar(e,t)};return!(e>1||this.__actions__.length)&&r instanceof Hn&&va(n)?((r=r.slice(n,+n+(e?1:0))).__actions__.push({func:go,args:[a],thisArg:i}),new Wn(r,this.__chain__).thru((function(t){return e&&!t.length&&t.push(i),t}))):this.thru(a)})),vo=Oi((function(t,e,n){Mt.call(t,n)?++t[n]:ir(t,n,1)})),mo=Di(Ha),yo=Di(Ua);function _o(t,e){return(Yo(t)?_e:cr)(t,oa(e,3))}function bo(t,e){return(Yo(t)?be:fr)(t,oa(e,3))}var xo=Oi((function(t,e,n){Mt.call(t,n)?t[n].push(e):ir(t,n,[e])})),wo=Vr((function(t,e,n){var i=-1,a="function"==typeof e,o=Xo(t)?r(t.length):[];return cr(t,(function(t){o[++i]=a?me(e,t,n):Or(t,e,n)})),o})),So=Oi((function(t,e,n){ir(t,n,e)}));function ko(t,e){return(Yo(t)?Ce:Fr)(t,oa(e,3))}var Co=Oi((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]})),Po=Vr((function(t,e){if(null==t)return[];var n=e.length;return n>1&&ma(t,e[0],e[1])?e=[]:n>2&&ma(e[0],e[1],e[2])&&(e=[e[0]]),Wr(t,vr(e,1),[])})),Ao=Le||function(){return ae.Date.now()};function To(t,e,n){return e=n?i:e,e=t&&null==e?t.length:e,Ki(t,u,i,i,i,i,e)}function Oo(t,e){var n;if("function"!=typeof e)throw new At(a);return t=ps(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=i),n}}var Lo=Vr((function(t,e,n){var r=1;if(n.length){var i=en(n,aa(Lo));r|=h}return Ki(t,r,e,n,i)})),Eo=Vr((function(t,e,n){var r=3;if(n.length){var i=en(n,aa(Eo));r|=h}return Ki(e,r,t,n,i)}));function Ro(t,e,n){var r,o,s,h,u,l,c=0,f=!1,d=!1,g=!0;if("function"!=typeof t)throw new At(a);function p(e){var n=r,a=o;return r=o=i,c=e,h=t.apply(a,n)}function v(t){return c=t,u=Oa(y,e),f?p(t):h}function m(t){var n=t-l;return l===i||n>=e||n<0||d&&t-c>=s}function y(){var t=Ao();if(m(t))return _(t);u=Oa(y,function(t){var n=e-(t-l);return d?yn(n,s-(t-c)):n}(t))}function _(t){return u=i,g&&r?p(t):(r=o=i,h)}function b(){var t=Ao(),n=m(t);if(r=arguments,o=this,l=t,n){if(u===i)return v(l);if(d)return bi(u),u=Oa(y,e),p(l)}return u===i&&(u=Oa(y,e)),h}return e=ms(e)||0,es(n)&&(f=!!n.leading,s=(d="maxWait"in n)?mn(ms(n.maxWait)||0,e):s,g="trailing"in n?!!n.trailing:g),b.cancel=function(){u!==i&&bi(u),c=0,r=l=o=u=i},b.flush=function(){return u===i?h:_(Ao())},b}var Mo=Vr((function(t,e){return ur(t,1,e)})),Go=Vr((function(t,e,n){return ur(t,ms(e)||0,n)}));function Io(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new At(a);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var o=t.apply(this,r);return n.cache=a.set(i,o)||a,o};return n.cache=new(Io.Cache||qn),n}function Do(t){if("function"!=typeof t)throw new At(a);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}Io.Cache=qn;var Fo=yi((function(t,e){var n=(e=1==e.length&&Yo(e[0])?Ce(e[0],He(oa())):Ce(vr(e,1),He(oa()))).length;return Vr((function(r){for(var i=-1,a=yn(r.length,n);++i<a;)r[i]=e[i].call(this,r[i]);return me(t,this,r)}))})),No=Vr((function(t,e){var n=en(e,aa(No));return Ki(t,h,i,e,n)})),jo=Vr((function(t,e){var n=en(e,aa(jo));return Ki(t,64,i,e,n)})),Bo=ta((function(t,e){return Ki(t,256,i,i,i,e)}));function zo(t,e){return t===e||t!=t&&e!=e}var Wo=Ui(Cr),Ho=Ui((function(t,e){return t>=e})),Uo=Lr(function(){return arguments}())?Lr:function(t){return ns(t)&&Mt.call(t,"callee")&&!te.call(t,"callee")},Yo=r.isArray,qo=ce?He(ce):function(t){return ns(t)&&kr(t)==E};function Xo(t){return null!=t&&ts(t.length)&&!Qo(t)}function Vo(t){return ns(t)&&Xo(t)}var Ko=dn||mh,$o=fe?He(fe):function(t){return ns(t)&&kr(t)==y};function Jo(t){if(!ns(t))return!1;var e=kr(t);return e==_||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!as(t)}function Qo(t){if(!es(t))return!1;var e=kr(t);return e==b||e==x||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Zo(t){return"number"==typeof t&&t==ps(t)}function ts(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=c}function es(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function ns(t){return null!=t&&"object"==typeof t}var rs=de?He(de):function(t){return ns(t)&&fa(t)==w};function is(t){return"number"==typeof t||ns(t)&&kr(t)==S}function as(t){if(!ns(t)||kr(t)!=k)return!1;var e=qt(t);if(null===e)return!0;var n=Mt.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Rt.call(n)==Ft}var os=ge?He(ge):function(t){return ns(t)&&kr(t)==P},ss=pe?He(pe):function(t){return ns(t)&&fa(t)==A};function hs(t){return"string"==typeof t||!Yo(t)&&ns(t)&&kr(t)==T}function us(t){return"symbol"==typeof t||ns(t)&&kr(t)==O}var ls=ve?He(ve):function(t){return ns(t)&&ts(t.length)&&!!Qt[kr(t)]},cs=Ui(Dr),fs=Ui((function(t,e){return t<=e}));function ds(t){if(!t)return[];if(Xo(t))return hs(t)?on(t):Ai(t);if(oe&&t[oe])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[oe]());var e=fa(t);return(e==w?Ze:e==A?nn:zs)(t)}function gs(t){return t?(t=ms(t))===l||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function ps(t){var e=gs(t),n=e%1;return e==e?n?e-n:e:0}function vs(t){return t?or(ps(t),0,d):0}function ms(t){if("number"==typeof t)return t;if(us(t))return f;if(es(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=es(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=We(t);var n=gt.test(t);return n||vt.test(t)?ne(t.slice(2),n?2:8):dt.test(t)?f:+t}function ys(t){return Ti(t,Ms(t))}function _s(t){return null==t?"":si(t)}var bs=Li((function(t,e){if(xa(e)||Xo(e))Ti(e,Rs(e),t);else for(var n in e)Mt.call(e,n)&&tr(t,n,e[n])})),xs=Li((function(t,e){Ti(e,Ms(e),t)})),ws=Li((function(t,e,n,r){Ti(e,Ms(e),t,r)})),Ss=Li((function(t,e,n,r){Ti(e,Rs(e),t,r)})),ks=ta(ar),Cs=Vr((function(t,e){t=kt(t);var n=-1,r=e.length,a=r>2?e[2]:i;for(a&&ma(e[0],e[1],a)&&(r=1);++n<r;)for(var o=e[n],s=Ms(o),h=-1,u=s.length;++h<u;){var l=s[h],c=t[l];(c===i||zo(c,Lt[l])&&!Mt.call(t,l))&&(t[l]=o[l])}return t})),Ps=Vr((function(t){return t.push(i,Ji),me(Is,i,t)}));function As(t,e,n){var r=null==t?i:wr(t,e);return r===i?n:r}function Ts(t,e){return null!=t&&da(t,e,Ar)}var Os=ji((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Dt.call(e)),t[e]=n}),eh(ih)),Ls=ji((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Dt.call(e)),Mt.call(t,e)?t[e].push(n):t[e]=[n]}),oa),Es=Vr(Or);function Rs(t){return Xo(t)?Kn(t):Ir(t)}function Ms(t){return Xo(t)?Kn(t,!0):function(t){if(!es(t))return function(t){var e=[];if(null!=t)for(var n in kt(t))e.push(n);return e}(t);var e=xa(t),n=[];for(var r in t)("constructor"!=r||!e&&Mt.call(t,r))&&n.push(r);return n}(t)}var Gs=Li((function(t,e,n){Br(t,e,n)})),Is=Li((function(t,e,n,r){Br(t,e,n,r)})),Ds=ta((function(t,e){var n={};if(null==t)return n;var r=!1;e=Ce(e,(function(e){return e=mi(e,t),r||(r=e.length>1),e})),Ti(t,na(t),n),r&&(n=sr(n,7,Qi));for(var i=e.length;i--;)ui(n,e[i]);return n})),Fs=ta((function(t,e){return null==t?{}:function(t,e){return Hr(t,e,(function(e,n){return Ts(t,n)}))}(t,e)}));function Ns(t,e){if(null==t)return{};var n=Ce(na(t),(function(t){return[t]}));return e=oa(e),Hr(t,n,(function(t,n){return e(t,n[0])}))}var js=Vi(Rs),Bs=Vi(Ms);function zs(t){return null==t?[]:Ue(t,Rs(t))}var Ws=Gi((function(t,e,n){return e=e.toLowerCase(),t+(n?Hs(e):e)}));function Hs(t){return Js(_s(t).toLowerCase())}function Us(t){return(t=_s(t))&&t.replace(yt,Ke).replace(Yt,"")}var Ys=Gi((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),qs=Gi((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),Xs=Mi("toLowerCase"),Vs=Gi((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()})),Ks=Gi((function(t,e,n){return t+(n?" ":"")+Js(e)})),$s=Gi((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()})),Js=Mi("toUpperCase");function Qs(t,e,n){return t=_s(t),(e=n?i:e)===i?function(t){return Kt.test(t)}(t)?function(t){return t.match(Xt)||[]}(t):function(t){return t.match(ht)||[]}(t):t.match(e)||[]}var Zs=Vr((function(t,e){try{return me(t,i,e)}catch(t){return Jo(t)?t:new xt(t)}})),th=ta((function(t,e){return _e(e,(function(e){e=Fa(e),ir(t,e,Lo(t[e],t))})),t}));function eh(t){return function(){return t}}var nh=Fi(),rh=Fi(!0);function ih(t){return t}function ah(t){return Gr("function"==typeof t?t:sr(t,1))}var oh=Vr((function(t,e){return function(n){return Or(n,t,e)}})),sh=Vr((function(t,e){return function(n){return Or(t,n,e)}}));function hh(t,e,n){var r=Rs(e),i=xr(e,r);null!=n||es(e)&&(i.length||!r.length)||(n=e,e=t,t=this,i=xr(e,Rs(e)));var a=!(es(n)&&"chain"in n&&!n.chain),o=Qo(t);return _e(i,(function(n){var r=e[n];t[n]=r,o&&(t.prototype[n]=function(){var e=this.__chain__;if(a||e){var n=t(this.__wrapped__),i=n.__actions__=Ai(this.__actions__);return i.push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,Pe([this.value()],arguments))})})),t}function uh(){}var lh=zi(Ce),ch=zi(xe),fh=zi(Oe);function dh(t){return ya(t)?Fe(Fa(t)):function(t){return function(e){return wr(e,t)}}(t)}var gh=Hi(),ph=Hi(!0);function vh(){return[]}function mh(){return!1}var yh,_h=Bi((function(t,e){return t+e}),0),bh=qi("ceil"),xh=Bi((function(t,e){return t/e}),1),wh=qi("floor"),Sh=Bi((function(t,e){return t*e}),1),kh=qi("round"),Ch=Bi((function(t,e){return t-e}),0);return jn.after=function(t,e){if("function"!=typeof e)throw new At(a);return t=ps(t),function(){if(--t<1)return e.apply(this,arguments)}},jn.ary=To,jn.assign=bs,jn.assignIn=xs,jn.assignInWith=ws,jn.assignWith=Ss,jn.at=ks,jn.before=Oo,jn.bind=Lo,jn.bindAll=th,jn.bindKey=Eo,jn.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Yo(t)?t:[t]},jn.chain=fo,jn.chunk=function(t,e,n){e=(n?ma(t,e,n):e===i)?1:mn(ps(e),0);var a=null==t?0:t.length;if(!a||e<1)return[];for(var o=0,s=0,h=r(ln(a/e));o<a;)h[s++]=ei(t,o,o+=e);return h},jn.compact=function(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var a=t[e];a&&(i[r++]=a)}return i},jn.concat=function(){var t=arguments.length;if(!t)return[];for(var e=r(t-1),n=arguments[0],i=t;i--;)e[i-1]=arguments[i];return Pe(Yo(n)?Ai(n):[n],vr(e,1))},jn.cond=function(t){var e=null==t?0:t.length,n=oa();return t=e?Ce(t,(function(t){if("function"!=typeof t[1])throw new At(a);return[n(t[0]),t[1]]})):[],Vr((function(n){for(var r=-1;++r<e;){var i=t[r];if(me(i[0],this,n))return me(i[1],this,n)}}))},jn.conforms=function(t){return function(t){var e=Rs(t);return function(n){return hr(n,t,e)}}(sr(t,1))},jn.constant=eh,jn.countBy=vo,jn.create=function(t,e){var n=Bn(t);return null==e?n:rr(n,e)},jn.curry=function t(e,n,r){var a=Ki(e,8,i,i,i,i,i,n=r?i:n);return a.placeholder=t.placeholder,a},jn.curryRight=function t(e,n,r){var a=Ki(e,16,i,i,i,i,i,n=r?i:n);return a.placeholder=t.placeholder,a},jn.debounce=Ro,jn.defaults=Cs,jn.defaultsDeep=Ps,jn.defer=Mo,jn.delay=Go,jn.difference=Ba,jn.differenceBy=za,jn.differenceWith=Wa,jn.drop=function(t,e,n){var r=null==t?0:t.length;return r?ei(t,(e=n||e===i?1:ps(e))<0?0:e,r):[]},jn.dropRight=function(t,e,n){var r=null==t?0:t.length;return r?ei(t,0,(e=r-(e=n||e===i?1:ps(e)))<0?0:e):[]},jn.dropRightWhile=function(t,e){return t&&t.length?ci(t,oa(e,3),!0,!0):[]},jn.dropWhile=function(t,e){return t&&t.length?ci(t,oa(e,3),!0):[]},jn.fill=function(t,e,n,r){var a=null==t?0:t.length;return a?(n&&"number"!=typeof n&&ma(t,e,n)&&(n=0,r=a),function(t,e,n,r){var a=t.length;for((n=ps(n))<0&&(n=-n>a?0:a+n),(r=r===i||r>a?a:ps(r))<0&&(r+=a),r=n>r?0:vs(r);n<r;)t[n++]=e;return t}(t,e,n,r)):[]},jn.filter=function(t,e){return(Yo(t)?we:pr)(t,oa(e,3))},jn.flatMap=function(t,e){return vr(ko(t,e),1)},jn.flatMapDeep=function(t,e){return vr(ko(t,e),l)},jn.flatMapDepth=function(t,e,n){return n=n===i?1:ps(n),vr(ko(t,e),n)},jn.flatten=Ya,jn.flattenDeep=function(t){return null!=t&&t.length?vr(t,l):[]},jn.flattenDepth=function(t,e){return null!=t&&t.length?vr(t,e=e===i?1:ps(e)):[]},jn.flip=function(t){return Ki(t,512)},jn.flow=nh,jn.flowRight=rh,jn.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r},jn.functions=function(t){return null==t?[]:xr(t,Rs(t))},jn.functionsIn=function(t){return null==t?[]:xr(t,Ms(t))},jn.groupBy=xo,jn.initial=function(t){return null!=t&&t.length?ei(t,0,-1):[]},jn.intersection=Xa,jn.intersectionBy=Va,jn.intersectionWith=Ka,jn.invert=Os,jn.invertBy=Ls,jn.invokeMap=wo,jn.iteratee=ah,jn.keyBy=So,jn.keys=Rs,jn.keysIn=Ms,jn.map=ko,jn.mapKeys=function(t,e){var n={};return e=oa(e,3),_r(t,(function(t,r,i){ir(n,e(t,r,i),t)})),n},jn.mapValues=function(t,e){var n={};return e=oa(e,3),_r(t,(function(t,r,i){ir(n,r,e(t,r,i))})),n},jn.matches=function(t){return Nr(sr(t,1))},jn.matchesProperty=function(t,e){return jr(t,sr(e,1))},jn.memoize=Io,jn.merge=Gs,jn.mergeWith=Is,jn.method=oh,jn.methodOf=sh,jn.mixin=hh,jn.negate=Do,jn.nthArg=function(t){return t=ps(t),Vr((function(e){return zr(e,t)}))},jn.omit=Ds,jn.omitBy=function(t,e){return Ns(t,Do(oa(e)))},jn.once=function(t){return Oo(2,t)},jn.orderBy=function(t,e,n,r){return null==t?[]:(Yo(e)||(e=null==e?[]:[e]),Yo(n=r?i:n)||(n=null==n?[]:[n]),Wr(t,e,n))},jn.over=lh,jn.overArgs=Fo,jn.overEvery=ch,jn.overSome=fh,jn.partial=No,jn.partialRight=jo,jn.partition=Co,jn.pick=Fs,jn.pickBy=Ns,jn.property=dh,jn.propertyOf=function(t){return function(e){return null==t?i:wr(t,e)}},jn.pull=Ja,jn.pullAll=Qa,jn.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?Ur(t,e,oa(n,2)):t},jn.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?Ur(t,e,i,n):t},jn.pullAt=Za,jn.range=gh,jn.rangeRight=ph,jn.rearg=Bo,jn.reject=function(t,e){return(Yo(t)?we:pr)(t,Do(oa(e,3)))},jn.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],a=t.length;for(e=oa(e,3);++r<a;){var o=t[r];e(o,r,t)&&(n.push(o),i.push(r))}return Yr(t,i),n},jn.rest=function(t,e){if("function"!=typeof t)throw new At(a);return Vr(t,e=e===i?e:ps(e))},jn.reverse=to,jn.sampleSize=function(t,e,n){return e=(n?ma(t,e,n):e===i)?1:ps(e),(Yo(t)?Jn:$r)(t,e)},jn.set=function(t,e,n){return null==t?t:Jr(t,e,n)},jn.setWith=function(t,e,n,r){return r="function"==typeof r?r:i,null==t?t:Jr(t,e,n,r)},jn.shuffle=function(t){return(Yo(t)?Qn:ti)(t)},jn.slice=function(t,e,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&ma(t,e,n)?(e=0,n=r):(e=null==e?0:ps(e),n=n===i?r:ps(n)),ei(t,e,n)):[]},jn.sortBy=Po,jn.sortedUniq=function(t){return t&&t.length?ai(t):[]},jn.sortedUniqBy=function(t,e){return t&&t.length?ai(t,oa(e,2)):[]},jn.split=function(t,e,n){return n&&"number"!=typeof n&&ma(t,e,n)&&(e=n=i),(n=n===i?d:n>>>0)?(t=_s(t))&&("string"==typeof e||null!=e&&!os(e))&&!(e=si(e))&&Qe(t)?_i(on(t),0,n):t.split(e,n):[]},jn.spread=function(t,e){if("function"!=typeof t)throw new At(a);return e=null==e?0:mn(ps(e),0),Vr((function(n){var r=n[e],i=_i(n,0,e);return r&&Pe(i,r),me(t,this,i)}))},jn.tail=function(t){var e=null==t?0:t.length;return e?ei(t,1,e):[]},jn.take=function(t,e,n){return t&&t.length?ei(t,0,(e=n||e===i?1:ps(e))<0?0:e):[]},jn.takeRight=function(t,e,n){var r=null==t?0:t.length;return r?ei(t,(e=r-(e=n||e===i?1:ps(e)))<0?0:e,r):[]},jn.takeRightWhile=function(t,e){return t&&t.length?ci(t,oa(e,3),!1,!0):[]},jn.takeWhile=function(t,e){return t&&t.length?ci(t,oa(e,3)):[]},jn.tap=function(t,e){return e(t),t},jn.throttle=function(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new At(a);return es(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Ro(t,e,{leading:r,maxWait:e,trailing:i})},jn.thru=go,jn.toArray=ds,jn.toPairs=js,jn.toPairsIn=Bs,jn.toPath=function(t){return Yo(t)?Ce(t,Fa):us(t)?[t]:Ai(Da(_s(t)))},jn.toPlainObject=ys,jn.transform=function(t,e,n){var r=Yo(t),i=r||Ko(t)||ls(t);if(e=oa(e,4),null==n){var a=t&&t.constructor;n=i?r?new a:[]:es(t)&&Qo(a)?Bn(qt(t)):{}}return(i?_e:_r)(t,(function(t,r,i){return e(n,t,r,i)})),n},jn.unary=function(t){return To(t,1)},jn.union=eo,jn.unionBy=no,jn.unionWith=ro,jn.uniq=function(t){return t&&t.length?hi(t):[]},jn.uniqBy=function(t,e){return t&&t.length?hi(t,oa(e,2)):[]},jn.uniqWith=function(t,e){return e="function"==typeof e?e:i,t&&t.length?hi(t,i,e):[]},jn.unset=function(t,e){return null==t||ui(t,e)},jn.unzip=io,jn.unzipWith=ao,jn.update=function(t,e,n){return null==t?t:li(t,e,vi(n))},jn.updateWith=function(t,e,n,r){return r="function"==typeof r?r:i,null==t?t:li(t,e,vi(n),r)},jn.values=zs,jn.valuesIn=function(t){return null==t?[]:Ue(t,Ms(t))},jn.without=oo,jn.words=Qs,jn.wrap=function(t,e){return No(vi(e),t)},jn.xor=so,jn.xorBy=ho,jn.xorWith=uo,jn.zip=lo,jn.zipObject=function(t,e){return gi(t||[],e||[],tr)},jn.zipObjectDeep=function(t,e){return gi(t||[],e||[],Jr)},jn.zipWith=co,jn.entries=js,jn.entriesIn=Bs,jn.extend=xs,jn.extendWith=ws,hh(jn,jn),jn.add=_h,jn.attempt=Zs,jn.camelCase=Ws,jn.capitalize=Hs,jn.ceil=bh,jn.clamp=function(t,e,n){return n===i&&(n=e,e=i),n!==i&&(n=(n=ms(n))==n?n:0),e!==i&&(e=(e=ms(e))==e?e:0),or(ms(t),e,n)},jn.clone=function(t){return sr(t,4)},jn.cloneDeep=function(t){return sr(t,5)},jn.cloneDeepWith=function(t,e){return sr(t,5,e="function"==typeof e?e:i)},jn.cloneWith=function(t,e){return sr(t,4,e="function"==typeof e?e:i)},jn.conformsTo=function(t,e){return null==e||hr(t,e,Rs(e))},jn.deburr=Us,jn.defaultTo=function(t,e){return null==t||t!=t?e:t},jn.divide=xh,jn.endsWith=function(t,e,n){t=_s(t),e=si(e);var r=t.length,a=n=n===i?r:or(ps(n),0,r);return(n-=e.length)>=0&&t.slice(n,a)==e},jn.eq=zo,jn.escape=function(t){return(t=_s(t))&&V.test(t)?t.replace(q,$e):t},jn.escapeRegExp=function(t){return(t=_s(t))&&nt.test(t)?t.replace(et,"\\$&"):t},jn.every=function(t,e,n){var r=Yo(t)?xe:dr;return n&&ma(t,e,n)&&(e=i),r(t,oa(e,3))},jn.find=mo,jn.findIndex=Ha,jn.findKey=function(t,e){return Ee(t,oa(e,3),_r)},jn.findLast=yo,jn.findLastIndex=Ua,jn.findLastKey=function(t,e){return Ee(t,oa(e,3),br)},jn.floor=wh,jn.forEach=_o,jn.forEachRight=bo,jn.forIn=function(t,e){return null==t?t:mr(t,oa(e,3),Ms)},jn.forInRight=function(t,e){return null==t?t:yr(t,oa(e,3),Ms)},jn.forOwn=function(t,e){return t&&_r(t,oa(e,3))},jn.forOwnRight=function(t,e){return t&&br(t,oa(e,3))},jn.get=As,jn.gt=Wo,jn.gte=Ho,jn.has=function(t,e){return null!=t&&da(t,e,Pr)},jn.hasIn=Ts,jn.head=qa,jn.identity=ih,jn.includes=function(t,e,n,r){t=Xo(t)?t:zs(t),n=n&&!r?ps(n):0;var i=t.length;return n<0&&(n=mn(i+n,0)),hs(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&Me(t,e,n)>-1},jn.indexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:ps(n);return i<0&&(i=mn(r+i,0)),Me(t,e,i)},jn.inRange=function(t,e,n){return e=gs(e),n===i?(n=e,e=0):n=gs(n),function(t,e,n){return t>=yn(e,n)&&t<mn(e,n)}(t=ms(t),e,n)},jn.invoke=Es,jn.isArguments=Uo,jn.isArray=Yo,jn.isArrayBuffer=qo,jn.isArrayLike=Xo,jn.isArrayLikeObject=Vo,jn.isBoolean=function(t){return!0===t||!1===t||ns(t)&&kr(t)==m},jn.isBuffer=Ko,jn.isDate=$o,jn.isElement=function(t){return ns(t)&&1===t.nodeType&&!as(t)},jn.isEmpty=function(t){if(null==t)return!0;if(Xo(t)&&(Yo(t)||"string"==typeof t||"function"==typeof t.splice||Ko(t)||ls(t)||Uo(t)))return!t.length;var e=fa(t);if(e==w||e==A)return!t.size;if(xa(t))return!Ir(t).length;for(var n in t)if(Mt.call(t,n))return!1;return!0},jn.isEqual=function(t,e){return Er(t,e)},jn.isEqualWith=function(t,e,n){var r=(n="function"==typeof n?n:i)?n(t,e):i;return r===i?Er(t,e,i,n):!!r},jn.isError=Jo,jn.isFinite=function(t){return"number"==typeof t&&gn(t)},jn.isFunction=Qo,jn.isInteger=Zo,jn.isLength=ts,jn.isMap=rs,jn.isMatch=function(t,e){return t===e||Rr(t,e,ha(e))},jn.isMatchWith=function(t,e,n){return n="function"==typeof n?n:i,Rr(t,e,ha(e),n)},jn.isNaN=function(t){return is(t)&&t!=+t},jn.isNative=function(t){if(ba(t))throw new xt("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Mr(t)},jn.isNil=function(t){return null==t},jn.isNull=function(t){return null===t},jn.isNumber=is,jn.isObject=es,jn.isObjectLike=ns,jn.isPlainObject=as,jn.isRegExp=os,jn.isSafeInteger=function(t){return Zo(t)&&t>=-9007199254740991&&t<=c},jn.isSet=ss,jn.isString=hs,jn.isSymbol=us,jn.isTypedArray=ls,jn.isUndefined=function(t){return t===i},jn.isWeakMap=function(t){return ns(t)&&fa(t)==L},jn.isWeakSet=function(t){return ns(t)&&"[object WeakSet]"==kr(t)},jn.join=function(t,e){return null==t?"":pn.call(t,e)},jn.kebabCase=Ys,jn.last=$a,jn.lastIndexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var a=r;return n!==i&&(a=(a=ps(n))<0?mn(r+a,0):yn(a,r-1)),e==e?function(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}(t,e,a):Re(t,Ie,a,!0)},jn.lowerCase=qs,jn.lowerFirst=Xs,jn.lt=cs,jn.lte=fs,jn.max=function(t){return t&&t.length?gr(t,ih,Cr):i},jn.maxBy=function(t,e){return t&&t.length?gr(t,oa(e,2),Cr):i},jn.mean=function(t){return De(t,ih)},jn.meanBy=function(t,e){return De(t,oa(e,2))},jn.min=function(t){return t&&t.length?gr(t,ih,Dr):i},jn.minBy=function(t,e){return t&&t.length?gr(t,oa(e,2),Dr):i},jn.stubArray=vh,jn.stubFalse=mh,jn.stubObject=function(){return{}},jn.stubString=function(){return""},jn.stubTrue=function(){return!0},jn.multiply=Sh,jn.nth=function(t,e){return t&&t.length?zr(t,ps(e)):i},jn.noConflict=function(){return ae._===this&&(ae._=Nt),this},jn.noop=uh,jn.now=Ao,jn.pad=function(t,e,n){t=_s(t);var r=(e=ps(e))?an(t):0;if(!e||r>=e)return t;var i=(e-r)/2;return Wi(cn(i),n)+t+Wi(ln(i),n)},jn.padEnd=function(t,e,n){t=_s(t);var r=(e=ps(e))?an(t):0;return e&&r<e?t+Wi(e-r,n):t},jn.padStart=function(t,e,n){t=_s(t);var r=(e=ps(e))?an(t):0;return e&&r<e?Wi(e-r,n)+t:t},jn.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),bn(_s(t).replace(rt,""),e||0)},jn.random=function(t,e,n){if(n&&"boolean"!=typeof n&&ma(t,e,n)&&(e=n=i),n===i&&("boolean"==typeof e?(n=e,e=i):"boolean"==typeof t&&(n=t,t=i)),t===i&&e===i?(t=0,e=1):(t=gs(t),e===i?(e=t,t=0):e=gs(e)),t>e){var r=t;t=e,e=r}if(n||t%1||e%1){var a=xn();return yn(t+a*(e-t+ee("1e-"+((a+"").length-1))),e)}return qr(t,e)},jn.reduce=function(t,e,n){var r=Yo(t)?Ae:je,i=arguments.length<3;return r(t,oa(e,4),n,i,cr)},jn.reduceRight=function(t,e,n){var r=Yo(t)?Te:je,i=arguments.length<3;return r(t,oa(e,4),n,i,fr)},jn.repeat=function(t,e,n){return e=(n?ma(t,e,n):e===i)?1:ps(e),Xr(_s(t),e)},jn.replace=function(){var t=arguments,e=_s(t[0]);return t.length<3?e:e.replace(t[1],t[2])},jn.result=function(t,e,n){var r=-1,a=(e=mi(e,t)).length;for(a||(a=1,t=i);++r<a;){var o=null==t?i:t[Fa(e[r])];o===i&&(r=a,o=n),t=Qo(o)?o.call(t):o}return t},jn.round=kh,jn.runInContext=t,jn.sample=function(t){return(Yo(t)?$n:Kr)(t)},jn.size=function(t){if(null==t)return 0;if(Xo(t))return hs(t)?an(t):t.length;var e=fa(t);return e==w||e==A?t.size:Ir(t).length},jn.snakeCase=Vs,jn.some=function(t,e,n){var r=Yo(t)?Oe:ni;return n&&ma(t,e,n)&&(e=i),r(t,oa(e,3))},jn.sortedIndex=function(t,e){return ri(t,e)},jn.sortedIndexBy=function(t,e,n){return ii(t,e,oa(n,2))},jn.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var r=ri(t,e);if(r<n&&zo(t[r],e))return r}return-1},jn.sortedLastIndex=function(t,e){return ri(t,e,!0)},jn.sortedLastIndexBy=function(t,e,n){return ii(t,e,oa(n,2),!0)},jn.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var n=ri(t,e,!0)-1;if(zo(t[n],e))return n}return-1},jn.startCase=Ks,jn.startsWith=function(t,e,n){return t=_s(t),n=null==n?0:or(ps(n),0,t.length),e=si(e),t.slice(n,n+e.length)==e},jn.subtract=Ch,jn.sum=function(t){return t&&t.length?Be(t,ih):0},jn.sumBy=function(t,e){return t&&t.length?Be(t,oa(e,2)):0},jn.template=function(t,e,n){var r=jn.templateSettings;n&&ma(t,e,n)&&(e=i),t=_s(t),e=ws({},e,r,$i);var a,o,s=ws({},e.imports,r.imports,$i),h=Rs(s),u=Ue(s,h),l=0,c=e.interpolate||_t,f="__p += '",d=Ct((e.escape||_t).source+"|"+c.source+"|"+(c===J?ct:_t).source+"|"+(e.evaluate||_t).source+"|$","g"),g="//# sourceURL="+(Mt.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Jt+"]")+"\n";t.replace(d,(function(e,n,r,i,s,h){return r||(r=i),f+=t.slice(l,h).replace(bt,Je),n&&(a=!0,f+="' +\n__e("+n+") +\n'"),s&&(o=!0,f+="';\n"+s+";\n__p += '"),r&&(f+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=h+e.length,e})),f+="';\n";var p=Mt.call(e,"variable")&&e.variable;if(p){if(ut.test(p))throw new xt("Invalid `variable` option passed into `_.template`")}else f="with (obj) {\n"+f+"\n}\n";f=(o?f.replace(W,""):f).replace(H,"$1").replace(U,"$1;"),f="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(a?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var v=Zs((function(){return wt(h,g+"return "+f).apply(i,u)}));if(v.source=f,Jo(v))throw v;return v},jn.times=function(t,e){if((t=ps(t))<1||t>c)return[];var n=d,r=yn(t,d);e=oa(e),t-=d;for(var i=ze(r,e);++n<t;)e(n);return i},jn.toFinite=gs,jn.toInteger=ps,jn.toLength=vs,jn.toLower=function(t){return _s(t).toLowerCase()},jn.toNumber=ms,jn.toSafeInteger=function(t){return t?or(ps(t),-9007199254740991,c):0===t?t:0},jn.toString=_s,jn.toUpper=function(t){return _s(t).toUpperCase()},jn.trim=function(t,e,n){if((t=_s(t))&&(n||e===i))return We(t);if(!t||!(e=si(e)))return t;var r=on(t),a=on(e);return _i(r,qe(r,a),Xe(r,a)+1).join("")},jn.trimEnd=function(t,e,n){if((t=_s(t))&&(n||e===i))return t.slice(0,sn(t)+1);if(!t||!(e=si(e)))return t;var r=on(t);return _i(r,0,Xe(r,on(e))+1).join("")},jn.trimStart=function(t,e,n){if((t=_s(t))&&(n||e===i))return t.replace(rt,"");if(!t||!(e=si(e)))return t;var r=on(t);return _i(r,qe(r,on(e))).join("")},jn.truncate=function(t,e){var n=30,r="...";if(es(e)){var a="separator"in e?e.separator:a;n="length"in e?ps(e.length):n,r="omission"in e?si(e.omission):r}var o=(t=_s(t)).length;if(Qe(t)){var s=on(t);o=s.length}if(n>=o)return t;var h=n-an(r);if(h<1)return r;var u=s?_i(s,0,h).join(""):t.slice(0,h);if(a===i)return u+r;if(s&&(h+=u.length-h),os(a)){if(t.slice(h).search(a)){var l,c=u;for(a.global||(a=Ct(a.source,_s(ft.exec(a))+"g")),a.lastIndex=0;l=a.exec(c);)var f=l.index;u=u.slice(0,f===i?h:f)}}else if(t.indexOf(si(a),h)!=h){var d=u.lastIndexOf(a);d>-1&&(u=u.slice(0,d))}return u+r},jn.unescape=function(t){return(t=_s(t))&&X.test(t)?t.replace(Y,hn):t},jn.uniqueId=function(t){var e=++Gt;return _s(t)+e},jn.upperCase=$s,jn.upperFirst=Js,jn.each=_o,jn.eachRight=bo,jn.first=qa,hh(jn,(yh={},_r(jn,(function(t,e){Mt.call(jn.prototype,e)||(yh[e]=t)})),yh),{chain:!1}),jn.VERSION="4.17.21",_e(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){jn[t].placeholder=jn})),_e(["drop","take"],(function(t,e){Hn.prototype[t]=function(n){n=n===i?1:mn(ps(n),0);var r=this.__filtered__&&!e?new Hn(this):this.clone();return r.__filtered__?r.__takeCount__=yn(n,r.__takeCount__):r.__views__.push({size:yn(n,d),type:t+(r.__dir__<0?"Right":"")}),r},Hn.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),_e(["filter","map","takeWhile"],(function(t,e){var n=e+1,r=1==n||3==n;Hn.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:oa(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}})),_e(["head","last"],(function(t,e){var n="take"+(e?"Right":"");Hn.prototype[t]=function(){return this[n](1).value()[0]}})),_e(["initial","tail"],(function(t,e){var n="drop"+(e?"":"Right");Hn.prototype[t]=function(){return this.__filtered__?new Hn(this):this[n](1)}})),Hn.prototype.compact=function(){return this.filter(ih)},Hn.prototype.find=function(t){return this.filter(t).head()},Hn.prototype.findLast=function(t){return this.reverse().find(t)},Hn.prototype.invokeMap=Vr((function(t,e){return"function"==typeof t?new Hn(this):this.map((function(n){return Or(n,t,e)}))})),Hn.prototype.reject=function(t){return this.filter(Do(oa(t)))},Hn.prototype.slice=function(t,e){t=ps(t);var n=this;return n.__filtered__&&(t>0||e<0)?new Hn(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==i&&(n=(e=ps(e))<0?n.dropRight(-e):n.take(e-t)),n)},Hn.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Hn.prototype.toArray=function(){return this.take(d)},_r(Hn.prototype,(function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),r=/^(?:head|last)$/.test(e),a=jn[r?"take"+("last"==e?"Right":""):e],o=r||/^find/.test(e);a&&(jn.prototype[e]=function(){var e=this.__wrapped__,s=r?[1]:arguments,h=e instanceof Hn,u=s[0],l=h||Yo(e),c=function(t){var e=a.apply(jn,Pe([t],s));return r&&f?e[0]:e};l&&n&&"function"==typeof u&&1!=u.length&&(h=l=!1);var f=this.__chain__,d=!!this.__actions__.length,g=o&&!f,p=h&&!d;if(!o&&l){e=p?e:new Hn(this);var v=t.apply(e,s);return v.__actions__.push({func:go,args:[c],thisArg:i}),new Wn(v,f)}return g&&p?t.apply(this,s):(v=this.thru(c),g?r?v.value()[0]:v.value():v)})})),_e(["pop","push","shift","sort","splice","unshift"],(function(t){var e=Tt[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);jn.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var i=this.value();return e.apply(Yo(i)?i:[],t)}return this[n]((function(n){return e.apply(Yo(n)?n:[],t)}))}})),_r(Hn.prototype,(function(t,e){var n=jn[e];if(n){var r=n.name+"";Mt.call(Ln,r)||(Ln[r]=[]),Ln[r].push({name:e,func:n})}})),Ln[Ni(i,2).name]=[{name:"wrapper",func:i}],Hn.prototype.clone=function(){var t=new Hn(this.__wrapped__);return t.__actions__=Ai(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Ai(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Ai(this.__views__),t},Hn.prototype.reverse=function(){if(this.__filtered__){var t=new Hn(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Hn.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=Yo(t),r=e<0,i=n?t.length:0,a=function(t,e,n){for(var r=-1,i=n.length;++r<i;){var a=n[r],o=a.size;switch(a.type){case"drop":t+=o;break;case"dropRight":e-=o;break;case"take":e=yn(e,t+o);break;case"takeRight":t=mn(t,e-o)}}return{start:t,end:e}}(0,i,this.__views__),o=a.start,s=a.end,h=s-o,u=r?s:o-1,l=this.__iteratees__,c=l.length,f=0,d=yn(h,this.__takeCount__);if(!n||!r&&i==h&&d==h)return fi(t,this.__actions__);var g=[];t:for(;h--&&f<d;){for(var p=-1,v=t[u+=e];++p<c;){var m=l[p],y=m.iteratee,_=m.type,b=y(v);if(2==_)v=b;else if(!b){if(1==_)continue t;break t}}g[f++]=v}return g},jn.prototype.at=po,jn.prototype.chain=function(){return fo(this)},jn.prototype.commit=function(){return new Wn(this.value(),this.__chain__)},jn.prototype.next=function(){this.__values__===i&&(this.__values__=ds(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?i:this.__values__[this.__index__++]}},jn.prototype.plant=function(t){for(var e,n=this;n instanceof zn;){var r=ja(n);r.__index__=0,r.__values__=i,e?a.__wrapped__=r:e=r;var a=r;n=n.__wrapped__}return a.__wrapped__=t,e},jn.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof Hn){var e=t;return this.__actions__.length&&(e=new Hn(this)),(e=e.reverse()).__actions__.push({func:go,args:[to],thisArg:i}),new Wn(e,this.__chain__)}return this.thru(to)},jn.prototype.toJSON=jn.prototype.valueOf=jn.prototype.value=function(){return fi(this.__wrapped__,this.__actions__)},jn.prototype.first=jn.prototype.head,oe&&(jn.prototype[oe]=function(){return this}),jn}();ae._=un,(r=function(){return un}.call(e,n,e,t))===i||(t.exports=r)}.call(this)},655:(t,e,n)=>{"use strict";n.r(e),n.d(e,{__extends:()=>i,__assign:()=>a,__rest:()=>o,__decorate:()=>s,__param:()=>h,__metadata:()=>u,__awaiter:()=>l,__generator:()=>c,__createBinding:()=>f,__exportStar:()=>d,__values:()=>g,__read:()=>p,__spread:()=>v,__spreadArrays:()=>m,__spreadArray:()=>y,__await:()=>_,__asyncGenerator:()=>b,__asyncDelegator:()=>x,__asyncValues:()=>w,__makeTemplateObject:()=>S,__importStar:()=>C,__importDefault:()=>P,__classPrivateFieldGet:()=>A,__classPrivateFieldSet:()=>T});var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var a=function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function o(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function s(t,e,n,r){var i,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(o=(a<3?i(o):a>3?i(e,n,o):i(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o}function h(t,e){return function(n,r){e(n,r,t)}}function u(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function l(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{h(r.next(t))}catch(t){a(t)}}function s(t){try{h(r.throw(t))}catch(t){a(t)}}function h(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}h((r=r.apply(t,e||[])).next())}))}function c(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var f=Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]};function d(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||f(e,t,n)}function g(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,a=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}function v(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t}function m(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}function y(t,e,n){if(n||2===arguments.length)for(var r,i=0,a=e.length;i<a;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}function _(t){return this instanceof _?(this.v=t,this):new _(t)}function b(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),a=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){a.push([t,e,n,r])>1||s(t,e)}))})}function s(t,e){try{(n=i[t](e)).value instanceof _?Promise.resolve(n.value.v).then(h,u):l(a[0][2],n)}catch(t){l(a[0][3],t)}var n}function h(t){s("next",t)}function u(t){s("throw",t)}function l(t,e){t(e),a.shift(),a.length&&s(a[0][0],a[0][1])}}function x(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:_(t[r](e)),done:"return"===r}:i?i(e):e}:i}}function w(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=g(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){!function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}(r,i,(e=t[n](e)).done,e.value)}))}}}function S(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var k=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};function C(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&f(e,t,n);return k(e,t),e}function P(t){return t&&t.__esModule?t:{default:t}}function A(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)}function T(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n}},4920:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>an});var r=Math.PI/180;const i="undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope?self:{},a={_global:i,version:"8.2.3",isBrowser:"undefined"!=typeof window&&("[object Window]"==={}.toString.call(window)||"[object global]"==={}.toString.call(window)),isUnminified:/param/.test(function(t){}.toString()),dblClickWindow:400,getAngle:t=>a.angleDeg?t*r:t,enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging:()=>a.DD.isDragging,isDragReady:()=>!!a.DD.node,document:i.document,_injectGlobal(t){i.Konva=t}},o=t=>{a[t.prototype.getClassName()]=t};a._injectGlobal(a);class s{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new s(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){var e=this.m;return{x:e[0]*t.x+e[2]*t.y+e[4],y:e[1]*t.x+e[3]*t.y+e[5]}}translate(t,e){return this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e,this}scale(t,e){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e,this}rotate(t){var e=Math.cos(t),n=Math.sin(t),r=this.m[0]*e+this.m[2]*n,i=this.m[1]*e+this.m[3]*n,a=this.m[0]*-n+this.m[2]*e,o=this.m[1]*-n+this.m[3]*e;return this.m[0]=r,this.m[1]=i,this.m[2]=a,this.m[3]=o,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,e){var n=this.m[0]+this.m[2]*e,r=this.m[1]+this.m[3]*e,i=this.m[2]+this.m[0]*t,a=this.m[3]+this.m[1]*t;return this.m[0]=n,this.m[1]=r,this.m[2]=i,this.m[3]=a,this}multiply(t){var e=this.m[0]*t.m[0]+this.m[2]*t.m[1],n=this.m[1]*t.m[0]+this.m[3]*t.m[1],r=this.m[0]*t.m[2]+this.m[2]*t.m[3],i=this.m[1]*t.m[2]+this.m[3]*t.m[3],a=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],o=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=e,this.m[1]=n,this.m[2]=r,this.m[3]=i,this.m[4]=a,this.m[5]=o,this}invert(){var t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),e=this.m[3]*t,n=-this.m[1]*t,r=-this.m[2]*t,i=this.m[0]*t,a=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),o=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=e,this.m[1]=n,this.m[2]=r,this.m[3]=i,this.m[4]=a,this.m[5]=o,this}getMatrix(){return this.m}setAbsolutePosition(t,e){var n=this.m[0],r=this.m[1],i=this.m[2],a=this.m[3],o=this.m[4],s=(n*(e-this.m[5])-r*(t-o))/(n*a-r*i),h=(t-o-i*s)/n;return this.translate(h,s)}decompose(){var t=this.m[0],e=this.m[1],n=this.m[2],r=this.m[3],i=t*r-e*n;let a={x:this.m[4],y:this.m[5],rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!=t||0!=e){var o=Math.sqrt(t*t+e*e);a.rotation=e>0?Math.acos(t/o):-Math.acos(t/o),a.scaleX=o,a.scaleY=i/o,a.skewX=(t*n+e*r)/i,a.skewY=0}else if(0!=n||0!=r){var s=Math.sqrt(n*n+r*r);a.rotation=Math.PI/2-(r>0?Math.acos(-n/s):-Math.acos(n/s)),a.scaleX=i/s,a.scaleY=s,a.skewX=0,a.skewY=(t*n+e*r)/i}return a.rotation=p._getRotation(a.rotation),a}}var h=Math.PI/180,u=180/Math.PI,l="Konva error: ",c={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},f=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,d=[];const g="undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||function(t){setTimeout(t,60)},p={_isElement:t=>!(!t||1!=t.nodeType),_isFunction:t=>!!(t&&t.constructor&&t.call&&t.apply),_isPlainObject:t=>!!t&&t.constructor===Object,_isArray:t=>"[object Array]"===Object.prototype.toString.call(t),_isNumber:t=>"[object Number]"===Object.prototype.toString.call(t)&&!isNaN(t)&&isFinite(t),_isString:t=>"[object String]"===Object.prototype.toString.call(t),_isBoolean:t=>"[object Boolean]"===Object.prototype.toString.call(t),isObject:t=>t instanceof Object,isValidSelector(t){if("string"!=typeof t)return!1;var e=t[0];return"#"===e||"."===e||e===e.toUpperCase()},_sign:t=>0===t||t>0?1:-1,requestAnimFrame(t){d.push(t),1===d.length&&g((function(){const t=d;d=[],t.forEach((function(t){t()}))}))},createCanvasElement(){var t=document.createElement("canvas");try{t.style=t.style||{}}catch(t){}return t},createImageElement:()=>document.createElement("img"),_isInDocument(t){for(;t=t.parentNode;)if(t==document)return!0;return!1},_urlToImage(t,e){var n=p.createImageElement();n.onload=function(){e(n)},n.src=t},_rgbToHex:(t,e,n)=>((1<<24)+(t<<16)+(e<<8)+n).toString(16).slice(1),_hexToRgb(t){t=t.replace("#","");var e=parseInt(t,16);return{r:e>>16&255,g:e>>8&255,b:255&e}},getRandomColor(){for(var t=(16777215*Math.random()<<0).toString(16);t.length<6;)t="0"+t;return"#"+t},getRGB(t){var e;return t in c?{r:(e=c[t])[0],g:e[1],b:e[2]}:"#"===t[0]?this._hexToRgb(t.substring(1)):"rgb("===t.substr(0,4)?(e=f.exec(t.replace(/ /g,"")),{r:parseInt(e[1],10),g:parseInt(e[2],10),b:parseInt(e[3],10)}):{r:0,g:0,b:0}},colorToRGBA:t=>(t=t||"black",p._namedColorToRBA(t)||p._hex3ColorToRGBA(t)||p._hex6ColorToRGBA(t)||p._rgbColorToRGBA(t)||p._rgbaColorToRGBA(t)||p._hslColorToRGBA(t)),_namedColorToRBA(t){var e=c[t.toLowerCase()];return e?{r:e[0],g:e[1],b:e[2],a:1}:null},_rgbColorToRGBA(t){if(0===t.indexOf("rgb(")){var e=(t=t.match(/rgb\(([^)]+)\)/)[1]).split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:1}}},_rgbaColorToRGBA(t){if(0===t.indexOf("rgba(")){var e=(t=t.match(/rgba\(([^)]+)\)/)[1]).split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:e[3]}}},_hex6ColorToRGBA(t){if("#"===t[0]&&7===t.length)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:1}},_hex3ColorToRGBA(t){if("#"===t[0]&&4===t.length)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:1}},_hslColorToRGBA(t){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(t)){const[e,...n]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t),r=Number(n[0])/360,i=Number(n[1])/100,a=Number(n[2])/100;let o,s,h;if(0===i)return h=255*a,{r:Math.round(h),g:Math.round(h),b:Math.round(h),a:1};o=a<.5?a*(1+i):a+i-a*i;const u=2*a-o,l=[0,0,0];for(let t=0;t<3;t++)s=r+1/3*-(t-1),s<0&&s++,s>1&&s--,h=6*s<1?u+6*(o-u)*s:2*s<1?o:3*s<2?u+(o-u)*(2/3-s)*6:u,l[t]=255*h;return{r:Math.round(l[0]),g:Math.round(l[1]),b:Math.round(l[2]),a:1}}},haveIntersection:(t,e)=>!(e.x>t.x+t.width||e.x+e.width<t.x||e.y>t.y+t.height||e.y+e.height<t.y),cloneObject(t){var e={};for(var n in t)this._isPlainObject(t[n])?e[n]=this.cloneObject(t[n]):this._isArray(t[n])?e[n]=this.cloneArray(t[n]):e[n]=t[n];return e},cloneArray:t=>t.slice(0),degToRad:t=>t*h,radToDeg:t=>t*u,_degToRad:t=>(p.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),p.degToRad(t)),_radToDeg:t=>(p.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),p.radToDeg(t)),_getRotation:t=>a.angleDeg?p.radToDeg(t):t,_capitalize:t=>t.charAt(0).toUpperCase()+t.slice(1),throw(t){throw new Error(l+t)},error(t){console.error(l+t)},warn(t){a.showWarnings&&console.warn("Konva warning: "+t)},each(t,e){for(var n in t)e(n,t[n])},_inRange:(t,e,n)=>e<=t&&t<n,_getProjectionToSegment(t,e,n,r,i,a){var o,s,h,u=(t-n)*(t-n)+(e-r)*(e-r);if(0==u)o=t,s=e,h=(i-n)*(i-n)+(a-r)*(a-r);else{var l=((i-t)*(n-t)+(a-e)*(r-e))/u;l<0?(o=t,s=e,h=(t-i)*(t-i)+(e-a)*(e-a)):l>1?(o=n,s=r,h=(n-i)*(n-i)+(r-a)*(r-a)):h=((o=t+l*(n-t))-i)*(o-i)+((s=e+l*(r-e))-a)*(s-a)}return[o,s,h]},_getProjectionToLine(t,e,n){var r=p.cloneObject(t),i=Number.MAX_VALUE;return e.forEach((function(a,o){if(n||o!==e.length-1){var s=e[(o+1)%e.length],h=p._getProjectionToSegment(a.x,a.y,s.x,s.y,t.x,t.y),u=h[0],l=h[1],c=h[2];c<i&&(r.x=u,r.y=l,i=c)}})),r},_prepareArrayForTween(t,e,n){var r,i=[],a=[];if(t.length>e.length){var o=e;e=t,t=o}for(r=0;r<t.length;r+=2)i.push({x:t[r],y:t[r+1]});for(r=0;r<e.length;r+=2)a.push({x:e[r],y:e[r+1]});var s=[];return a.forEach((function(t){var e=p._getProjectionToLine(t,i,n);s.push(e.x),s.push(e.y)})),s},_prepareToStringify(t){var e;for(var n in t.visitedByCircularReferenceRemoval=!0,t)if(t.hasOwnProperty(n)&&t[n]&&"object"==typeof t[n])if(e=Object.getOwnPropertyDescriptor(t,n),t[n].visitedByCircularReferenceRemoval||p._isElement(t[n])){if(!e.configurable)return null;delete t[n]}else if(null===p._prepareToStringify(t[n])){if(!e.configurable)return null;delete t[n]}return delete t.visitedByCircularReferenceRemoval,t},_assign(t,e){for(var n in e)t[n]=e[n];return t},_getFirstPointerId:t=>t.touches?t.changedTouches[0].identifier:t.pointerId||999};function v(t){return p._isString(t)?'"'+t+'"':"[object Number]"===Object.prototype.toString.call(t)||p._isBoolean(t)?t:Object.prototype.toString.call(t)}function m(t){return t>255?255:t<0?0:Math.round(t)}function y(){if(a.isUnminified)return function(t,e){return p._isNumber(t)||p.warn(v(t)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),t}}function _(t){if(a.isUnminified)return function(e,n){let r=p._isNumber(e),i=p._isArray(e)&&e.length==t;return r||i||p.warn(v(e)+' is a not valid value for "'+n+'" attribute. The value should be a number or Array<number>('+t+")"),e}}function b(){if(a.isUnminified)return function(t,e){return p._isNumber(t)||"auto"===t||p.warn(v(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),t}}function x(){if(a.isUnminified)return function(t,e){return p._isString(t)||p.warn(v(t)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),t}}function w(){if(a.isUnminified)return function(t,e){const n=p._isString(t),r="[object CanvasGradient]"===Object.prototype.toString.call(t)||t&&t.addColorStop;return n||r||p.warn(v(t)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),t}}function S(){if(a.isUnminified)return function(t,e){return!0===t||!1===t||p.warn(v(t)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),t}}var k="get",C="set";const P={addGetterSetter(t,e,n,r,i){P.addGetter(t,e,n),P.addSetter(t,e,r,i),P.addOverloadedGetterSetter(t,e)},addGetter(t,e,n){var r=k+p._capitalize(e);t.prototype[r]=t.prototype[r]||function(){var t=this.attrs[e];return void 0===t?n:t}},addSetter(t,e,n,r){var i=C+p._capitalize(e);t.prototype[i]||P.overWriteSetter(t,e,n,r)},overWriteSetter(t,e,n,r){var i=C+p._capitalize(e);t.prototype[i]=function(t){return n&&null!=t&&(t=n.call(this,t,e)),this._setAttr(e,t),r&&r.call(this),this}},addComponentsGetterSetter(t,e,n,r,i){var o,s,h=n.length,u=p._capitalize,l=k+u(e),c=C+u(e);t.prototype[l]=function(){var t={};for(o=0;o<h;o++)t[s=n[o]]=this.getAttr(e+u(s));return t};var f=function(t){if(a.isUnminified)return function(e,n){return p.isObject(e)||p.warn(v(e)+' is a not valid value for "'+n+'" attribute. The value should be an object with properties '+t),e}}(n);t.prototype[c]=function(t){var n,a=this.attrs[e];for(n in r&&(t=r.call(this,t)),f&&f.call(this,t,e),t)t.hasOwnProperty(n)&&this._setAttr(e+u(n),t[n]);return this._fireChangeEvent(e,a,t),i&&i.call(this),this},P.addOverloadedGetterSetter(t,e)},addOverloadedGetterSetter(t,e){var n=p._capitalize(e),r=C+n,i=k+n;t.prototype[e]=function(){return arguments.length?(this[r](arguments[0]),this):this[i]()}},addDeprecatedGetterSetter(t,e,n,r){p.error("Adding deprecated "+e);var i=k+p._capitalize(e),a=e+" property is deprecated and will be removed soon. Look at Konva change log for more information.";t.prototype[i]=function(){p.error(a);var t=this.attrs[e];return void 0===t?n:t},P.addSetter(t,e,r,(function(){p.error(a)})),P.addOverloadedGetterSetter(t,e)},backCompat(t,e){p.each(e,(function(e,n){var r=t.prototype[n],i=k+p._capitalize(e),a=C+p._capitalize(e);function o(){r.apply(this,arguments),p.error('"'+e+'" method is deprecated and will be removed soon. Use ""'+n+'" instead.')}t.prototype[e]=o,t.prototype[i]=o,t.prototype[a]=o}))},afterSetFilter(){this._filterUpToDate=!1}};function A(t){var e,n,r=[],i=t.length,a=p;for(e=0;e<i;e++)n=t[e],a._isNumber(n)?n=Math.round(1e3*n)/1e3:a._isString(n)||(n+=""),r.push(n);return r}var T,O=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"];class L{constructor(t){this.canvas=t,this._context=t._canvas.getContext("2d"),a.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,e){var n,r,i,a,o=this.traceArr,s=o.length,h="";for(n=0;n<s;n++)(i=(r=o[n]).method)?(a=r.args,h+=i,t?h+="()":p._isArray(a[0])?h+="(["+a.join(",")+"])":(e&&(a=a.map((t=>"number"==typeof t?Math.floor(t):t))),h+="("+a.join(",")+")")):(h+=r.property,t||(h+="="+r.val)),h+=";";return h}clearTrace(){this.traceArr=[]}_trace(t){var e=this.traceArr;e.push(t),e.length>=100&&e.shift()}reset(){var t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){var e=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,e.getWidth()/e.pixelRatio,e.getHeight()/e.pixelRatio)}_applyLineCap(t){var e=t.getLineCap();e&&this.setAttr("lineCap",e)}_applyOpacity(t){var e=t.getAbsoluteOpacity();1!==e&&this.setAttr("globalAlpha",e)}_applyLineJoin(t){var e=t.attrs.lineJoin;e&&this.setAttr("lineJoin",e)}setAttr(t,e){this._context[t]=e}arc(t,e,n,r,i,a){this._context.arc(t,e,n,r,i,a)}arcTo(t,e,n,r,i){this._context.arcTo(t,e,n,r,i)}beginPath(){this._context.beginPath()}bezierCurveTo(t,e,n,r,i,a){this._context.bezierCurveTo(t,e,n,r,i,a)}clearRect(t,e,n,r){this._context.clearRect(t,e,n,r)}clip(){this._context.clip()}closePath(){this._context.closePath()}createImageData(t,e){var n=arguments;return 2===n.length?this._context.createImageData(t,e):1===n.length?this._context.createImageData(t):void 0}createLinearGradient(t,e,n,r){return this._context.createLinearGradient(t,e,n,r)}createPattern(t,e){return this._context.createPattern(t,e)}createRadialGradient(t,e,n,r,i,a){return this._context.createRadialGradient(t,e,n,r,i,a)}drawImage(t,e,n,r,i,a,o,s,h){var u=arguments,l=this._context;3===u.length?l.drawImage(t,e,n):5===u.length?l.drawImage(t,e,n,r,i):9===u.length&&l.drawImage(t,e,n,r,i,a,o,s,h)}ellipse(t,e,n,r,i,a,o,s){this._context.ellipse(t,e,n,r,i,a,o,s)}isPointInPath(t,e){return this._context.isPointInPath(t,e)}fill(t){t?this._context.fill(t):this._context.fill()}fillRect(t,e,n,r){this._context.fillRect(t,e,n,r)}strokeRect(t,e,n,r){this._context.strokeRect(t,e,n,r)}fillText(t,e,n,r){r?this._context.fillText(t,e,n,r):this._context.fillText(t,e,n)}measureText(t){return this._context.measureText(t)}getImageData(t,e,n,r){return this._context.getImageData(t,e,n,r)}lineTo(t,e){this._context.lineTo(t,e)}moveTo(t,e){this._context.moveTo(t,e)}rect(t,e,n,r){this._context.rect(t,e,n,r)}putImageData(t,e,n){this._context.putImageData(t,e,n)}quadraticCurveTo(t,e,n,r){this._context.quadraticCurveTo(t,e,n,r)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,e){this._context.scale(t,e)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,e,n,r,i,a){this._context.setTransform(t,e,n,r,i,a)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,e,n,r){this._context.strokeText(t,e,n,r)}transform(t,e,n,r,i,a){this._context.transform(t,e,n,r,i,a)}translate(t,e){this._context.translate(t,e)}_enableTrace(){var t,e,n=this,r=O.length,i=this.setAttr,a=function(t){var r,i=n[t];n[t]=function(){return e=A(Array.prototype.slice.call(arguments,0)),r=i.apply(n,arguments),n._trace({method:t,args:e}),r}};for(t=0;t<r;t++)a(O[t]);n.setAttr=function(){i.apply(n,arguments);var t=arguments[0],e=arguments[1];"shadowOffsetX"!==t&&"shadowOffsetY"!==t&&"shadowBlur"!==t||(e/=this.canvas.getPixelRatio()),n._trace({property:t,val:e})}}_applyGlobalCompositeOperation(t){const e=t.attrs.globalCompositeOperation;!e||"source-over"===e||this.setAttr("globalCompositeOperation",e)}}["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"].forEach((function(t){Object.defineProperty(L.prototype,t,{get(){return this._context[t]},set(e){this._context[t]=e}})}));class E extends L{_fillColor(t){var e=t.fill();this.setAttr("fillStyle",e),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){var e=t._getLinearGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fillRadialGradient(t){var e=t._getRadialGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fill(t){var e=t.fill(),n=t.getFillPriority();if(e&&"color"===n)this._fillColor(t);else{var r=t.getFillPatternImage();if(r&&"pattern"===n)this._fillPattern(t);else{var i=t.getFillLinearGradientColorStops();if(i&&"linear-gradient"===n)this._fillLinearGradient(t);else{var a=t.getFillRadialGradientColorStops();a&&"radial-gradient"===n?this._fillRadialGradient(t):e?this._fillColor(t):r?this._fillPattern(t):i?this._fillLinearGradient(t):a&&this._fillRadialGradient(t)}}}}_strokeLinearGradient(t){var e=t.getStrokeLinearGradientStartPoint(),n=t.getStrokeLinearGradientEndPoint(),r=t.getStrokeLinearGradientColorStops(),i=this.createLinearGradient(e.x,e.y,n.x,n.y);if(r){for(var a=0;a<r.length;a+=2)i.addColorStop(r[a],r[a+1]);this.setAttr("strokeStyle",i)}}_stroke(t){var e=t.dash(),n=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!n){this.save();var r=this.getCanvas().getPixelRatio();this.setTransform(r,0,0,r,0,0)}this._applyLineCap(t),e&&t.dashEnabled()&&(this.setLineDash(e),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),n||this.restore()}}_applyShadow(t){var e,n,r,i=null!==(e=t.getShadowRGBA())&&void 0!==e?e:"black",a=null!==(n=t.getShadowBlur())&&void 0!==n?n:5,o=null!==(r=t.getShadowOffset())&&void 0!==r?r:{x:0,y:0},s=t.getAbsoluteScale(),h=this.canvas.getPixelRatio(),u=s.x*h,l=s.y*h;this.setAttr("shadowColor",i),this.setAttr("shadowBlur",a*Math.min(Math.abs(u),Math.abs(l))),this.setAttr("shadowOffsetX",o.x*u),this.setAttr("shadowOffsetY",o.y*l)}}class R extends L{_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){var e=t.getStrokeScaleEnabled();if(!e){this.save();var n=this.getCanvas().getPixelRatio();this.setTransform(n,0,0,n,0,0)}this._applyLineCap(t);var r=t.hitStrokeWidth(),i="auto"===r?t.strokeWidth():r;this.setAttr("lineWidth",i),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),e||this.restore()}}}class M{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;var e=(t||{}).pixelRatio||a.pixelRatio||function(){if(T)return T;var t=p.createCanvasElement().getContext("2d");return T=(a._global.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}();this.pixelRatio=e,this._canvas=p.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){var e=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/e,this.getHeight()/e)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";var e=this.pixelRatio;this.getContext()._context.scale(e,e)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";var e=this.pixelRatio;this.getContext()._context.scale(e,e)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,e){this.setWidth(t||0),this.setHeight(e||0)}toDataURL(t,e){try{return this._canvas.toDataURL(t,e)}catch(t){try{return this._canvas.toDataURL()}catch(t){return p.error("Unable to get data URL. "+t.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}P.addGetterSetter(M,"pixelRatio",void 0,y());class G extends M{constructor(t={width:0,height:0}){super(t),this.context=new E(this),this.setSize(t.width,t.height)}}class I extends M{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new R(this),this.setSize(t.width,t.height)}}const D={get isDragging(){var t=!1;return D._dragElements.forEach((e=>{"dragging"===e.dragStatus&&(t=!0)})),t},justDragged:!1,get node(){var t;return D._dragElements.forEach((e=>{t=e.node})),t},_dragElements:new Map,_drag(t){const e=[];D._dragElements.forEach(((n,r)=>{const{node:i}=n,a=i.getStage();a.setPointersPositions(t),void 0===n.pointerId&&(n.pointerId=p._getFirstPointerId(t));const o=a._changedPointerPositions.find((t=>t.id===n.pointerId));if(o){if("dragging"!==n.dragStatus){var s=i.dragDistance();if(Math.max(Math.abs(o.x-n.startPointerPos.x),Math.abs(o.y-n.startPointerPos.y))<s)return;if(i.startDrag({evt:t}),!i.isDragging())return}i._setDragPosition(t,n),e.push(i)}})),e.forEach((e=>{e.fire("dragmove",{type:"dragmove",target:e,evt:t},!0)}))},_endDragBefore(t){D._dragElements.forEach((e=>{const{node:n}=e,r=n.getStage();if(t&&r.setPointersPositions(t),!r._changedPointerPositions.find((t=>t.id===e.pointerId)))return;"dragging"!==e.dragStatus&&"stopped"!==e.dragStatus||(D.justDragged=!0,a._mouseListenClick=!1,a._touchListenClick=!1,a._pointerListenClick=!1,e.dragStatus="stopped");const i=e.node.getLayer()||e.node instanceof a.Stage&&e.node;i&&i.batchDraw()}))},_endDragAfter(t){D._dragElements.forEach(((e,n)=>{"stopped"===e.dragStatus&&e.node.fire("dragend",{type:"dragend",target:e.node,evt:t},!0),"dragging"!==e.dragStatus&&D._dragElements.delete(n)}))}};a.isBrowser&&(window.addEventListener("mouseup",D._endDragBefore,!0),window.addEventListener("touchend",D._endDragBefore,!0),window.addEventListener("mousemove",D._drag),window.addEventListener("touchmove",D._drag),window.addEventListener("mouseup",D._endDragAfter,!1),window.addEventListener("touchend",D._endDragAfter,!1));var F="absoluteOpacity",N="allEventListeners",j="absoluteTransform",B="absoluteScale",z="canvas",W="listening",H="mouseenter",U="mouseleave",Y="Shape",q=" ",X="stage",V="transform",K="visible",$=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(q);let J=1;class Q{constructor(t){this._id=J++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){t!==V&&t!==j||!this._cache.get(t)?t?this._cache.delete(t):this._cache.clear():this._cache.get(t).dirty=!0}_getCache(t,e){var n=this._cache.get(t);return(void 0===n||(t===V||t===j)&&!0===n.dirty)&&(n=e.call(this),this._cache.set(t,n)),n}_calculate(t,e,n){if(!this._attachedDepsListeners.get(t)){const n=e.map((t=>t+"Change.konva")).join(q);this.on(n,(()=>{this._clearCache(t)})),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,n)}_getCanvasCache(){return this._cache.get(z)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===j&&this.fire("absoluteTransformChange")}clearCache(){return this._cache.delete(z),this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){var e=t||{},n={};void 0!==e.x&&void 0!==e.y&&void 0!==e.width&&void 0!==e.height||(n=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()}));var r=Math.ceil(e.width||n.width),i=Math.ceil(e.height||n.height),a=e.pixelRatio,o=void 0===e.x?n.x:e.x,s=void 0===e.y?n.y:e.y,h=e.offset||0,u=e.drawBorder||!1,l=e.hitCanvasPixelRatio||1;if(r&&i){o-=h,s-=h;var c=new G({pixelRatio:a,width:r+=2*h,height:i+=2*h}),f=new G({pixelRatio:a,width:0,height:0}),d=new I({pixelRatio:l,width:r,height:i}),g=c.getContext(),v=d.getContext();return d.isCache=!0,c.isCache=!0,this._cache.delete(z),this._filterUpToDate=!1,!1===e.imageSmoothingEnabled&&(c.getContext()._context.imageSmoothingEnabled=!1,f.getContext()._context.imageSmoothingEnabled=!1),g.save(),v.save(),g.translate(-o,-s),v.translate(-o,-s),this._isUnderCache=!0,this._clearSelfAndDescendantCache(F),this._clearSelfAndDescendantCache(B),this.drawScene(c,this),this.drawHit(d,this),this._isUnderCache=!1,g.restore(),v.restore(),u&&(g.save(),g.beginPath(),g.rect(0,0,r,i),g.closePath(),g.setAttr("strokeStyle","red"),g.setAttr("lineWidth",5),g.stroke(),g.restore()),this._cache.set(z,{scene:c,filter:f,hit:d,x:o,y:s}),this._requestDraw(),this}p.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.")}isCached(){return this._cache.has(z)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,e){var n,r,i,a,o=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],s=this.getAbsoluteTransform(e);return o.forEach((function(t){var e=s.point(t);void 0===n&&(n=i=e.x,r=a=e.y),n=Math.min(n,e.x),r=Math.min(r,e.y),i=Math.max(i,e.x),a=Math.max(a,e.y)})),{x:n,y:r,width:i-n,height:a-r}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const e=this._getCanvasCache();t.translate(e.x,e.y);var n=this._getCachedSceneCanvas(),r=n.pixelRatio;t.drawImage(n._canvas,0,0,n.width/r,n.height/r),t.restore()}_drawCachedHitCanvas(t){var e=this._getCanvasCache(),n=e.hit;t.save(),t.translate(e.x,e.y),t.drawImage(n._canvas,0,0,n.width/n.pixelRatio,n.height/n.pixelRatio),t.restore()}_getCachedSceneCanvas(){var t,e,n,r,i=this.filters(),a=this._getCanvasCache(),o=a.scene,s=a.filter,h=s.getContext();if(i){if(!this._filterUpToDate){var u=o.pixelRatio;s.setSize(o.width/o.pixelRatio,o.height/o.pixelRatio);try{for(t=i.length,h.clear(),h.drawImage(o._canvas,0,0,o.getWidth()/u,o.getHeight()/u),e=h.getImageData(0,0,s.getWidth(),s.getHeight()),n=0;n<t;n++)"function"==typeof(r=i[n])?(r.call(this,e),h.putImageData(e,0,0)):p.error("Filter should be type of function, but got "+typeof r+" instead. Please check correct filters")}catch(t){p.error("Unable to apply filter. "+t.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return s}return o}on(t,e){if(this._cache&&this._cache.delete(N),3===arguments.length)return this._delegate.apply(this,arguments);var n,r,i,a,o=t.split(q),s=o.length;for(n=0;n<s;n++)i=(r=o[n].split("."))[0],a=r[1]||"",this.eventListeners[i]||(this.eventListeners[i]=[]),this.eventListeners[i].push({name:a,handler:e});return this}off(t,e){var n,r,i,a,o,s=(t||"").split(q),h=s.length;if(this._cache&&this._cache.delete(N),!t)for(r in this.eventListeners)this._off(r);for(n=0;n<h;n++)if(a=(i=s[n].split("."))[0],o=i[1],a)this.eventListeners[a]&&this._off(a,o,e);else for(r in this.eventListeners)this._off(r,o,e);return this}dispatchEvent(t){var e={target:this,type:t.type,evt:t};return this.fire(t.type,e),this}addEventListener(t,e){return this.on(t,(function(t){e.call(this,t.evt)})),this}removeEventListener(t){return this.off(t),this}_delegate(t,e,n){var r=this;this.on(t,(function(t){for(var i=t.target.findAncestors(e,!0,r),a=0;a<i.length;a++)(t=p.cloneObject(t)).currentTarget=i[a],n.call(i[a],t)}))}remove(){return this.isDragging()&&this.stopDrag(),D._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(j),this._clearSelfAndDescendantCache(F),this._clearSelfAndDescendantCache(B),this._clearSelfAndDescendantCache(X),this._clearSelfAndDescendantCache(K),this._clearSelfAndDescendantCache(W)}_remove(){this._clearCaches();var t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this}getAttr(t){var e="get"+p._capitalize(t);return p._isFunction(this[e])?this[e]():this.attrs[t]}getAncestors(){for(var t=this.getParent(),e=[];t;)e.push(t),t=t.getParent();return e}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges((()=>{var e,n;if(!t)return this;for(e in t)"children"!==e&&(n="set"+p._capitalize(e),p._isFunction(this[n])?this[n](t[e]):this._setAttr(e,t[e]))})),this}isListening(){return this._getCache(W,this._isListening)}_isListening(t){if(!this.listening())return!1;const e=this.getParent();return!e||e===t||this===t||e._isListening(t)}isVisible(){return this._getCache(K,this._isVisible)}_isVisible(t){if(!this.visible())return!1;const e=this.getParent();return!e||e===t||this===t||e._isVisible(t)}shouldDrawHit(t,e=!1){if(t)return this._isVisible(t)&&this._isListening(t);var n=this.getLayer(),r=!1;D._dragElements.forEach((t=>{"dragging"===t.dragStatus&&("Stage"===t.node.nodeType||t.node.getLayer()===n)&&(r=!0)}));var i=!e&&!a.hitOnDragEnabled&&r;return this.isListening()&&this.isVisible()&&!i}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){var t,e,n,r,i=this.getDepth(),a=this,o=0;return"Stage"!==a.nodeType&&function s(h){for(t=[],e=h.length,n=0;n<e;n++)r=h[n],o++,r.nodeType!==Y&&(t=t.concat(r.getChildren().slice())),r._id===a._id&&(n=e);t.length>0&&t[0].getDepth()<=i&&s(t)}(a.getStage().getChildren()),o}getDepth(){for(var t=0,e=this.parent;e;)t++,e=e.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(V),this._clearSelfAndDescendantCache(j)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges((()=>{this.x(t.x),this.y(t.y)})),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){if(!this.getStage())return null;var t=this.getStage().getPointerPosition();if(!t)return null;var e=this.getAbsoluteTransform().copy();return e.invert(),e.point(t)}getAbsolutePosition(t){let e=!1,n=this.parent;for(;n;){if(n.isCached()){e=!0;break}n=n.parent}e&&!t&&(t=!0);var r=this.getAbsoluteTransform(t).getMatrix(),i=new s,a=this.offset();return i.m=r.slice(),i.translate(a.x,a.y),i.getTranslation()}setAbsolutePosition(t){var e=this._clearTransform();this.attrs.x=e.x,this.attrs.y=e.y,delete e.x,delete e.y,this._clearCache(V);var n=this._getAbsoluteTransform().copy();return n.invert(),n.translate(t.x,t.y),t={x:this.attrs.x+n.getTranslation().x,y:this.attrs.y+n.getTranslation().y},this._setTransform(e),this.setPosition({x:t.x,y:t.y}),this._clearCache(V),this._clearSelfAndDescendantCache(j),this}_setTransform(t){var e;for(e in t)this.attrs[e]=t[e]}_clearTransform(){var t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){var e=t.x,n=t.y,r=this.x(),i=this.y();return void 0!==e&&(r+=e),void 0!==n&&(i+=n),this.setPosition({x:r,y:i}),this}_eachAncestorReverse(t,e){var n,r,i=[],a=this.getParent();if(!e||e._id!==this._id){for(i.unshift(this);a&&(!e||a._id!==e._id);)i.unshift(a),a=a.parent;for(n=i.length,r=0;r<n;r++)t(i[r])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return p.warn("Node has no parent. moveToTop function is ignored."),!1;var t=this.index;return this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0}moveUp(){if(!this.parent)return p.warn("Node has no parent. moveUp function is ignored."),!1;var t=this.index;return t<this.parent.getChildren().length-1&&(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0)}moveDown(){if(!this.parent)return p.warn("Node has no parent. moveDown function is ignored."),!1;var t=this.index;return t>0&&(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0)}moveToBottom(){if(!this.parent)return p.warn("Node has no parent. moveToBottom function is ignored."),!1;var t=this.index;return t>0&&(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0)}setZIndex(t){if(!this.parent)return p.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&p.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");var e=this.index;return this.parent.children.splice(e,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(F,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){var t=this.opacity(),e=this.getParent();return e&&!e._isUnderCache&&(t*=e.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){var t,e,n,r,i={},a=this.getAttrs();for(t in i.attrs={},a)e=a[t],p.isObject(e)&&!p._isPlainObject(e)&&!p._isArray(e)||(n="function"==typeof this[t]&&this[t],delete a[t],r=n?n.call(this):null,a[t]=e,r!==e&&(i.attrs[t]=e));return i.className=this.getClassName(),p._prepareToStringify(i)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,e,n){var r=[];e&&this._isMatch(t)&&r.push(this);for(var i=this.parent;i;){if(i===n)return r;i._isMatch(t)&&r.push(i),i=i.parent}return r}isAncestorOf(t){return!1}findAncestor(t,e,n){return this.findAncestors(t,e,n)[0]}_isMatch(t){if(!t)return!1;if("function"==typeof t)return t(this);var e,n,r=t.replace(/ /g,"").split(","),i=r.length;for(e=0;e<i;e++)if(n=r[e],p.isValidSelector(n)||(p.warn('Selector "'+n+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),p.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),p.warn("Konva is awesome, right?")),"#"===n.charAt(0)){if(this.id()===n.slice(1))return!0}else if("."===n.charAt(0)){if(this.hasName(n.slice(1)))return!0}else if(this.className===n||this.nodeType===n)return!0;return!1}getLayer(){var t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(X,this._getStage)}_getStage(){var t=this.getParent();return t?t.getStage():void 0}fire(t,e={},n){return e.target=e.target||this,n?this._fireAndBubble(t,e):this._fire(t,e),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(j,this._getAbsoluteTransform)}_getAbsoluteTransform(t){var e;if(t)return e=new s,this._eachAncestorReverse((function(t){var n=t.transformsEnabled();"all"===n?e.multiply(t.getTransform()):"position"===n&&e.translate(t.x()-t.offsetX(),t.y()-t.offsetY())}),t),e;e=this._cache.get(j)||new s,this.parent?this.parent.getAbsoluteTransform().copyInto(e):e.reset();var n=this.transformsEnabled();if("all"===n)e.multiply(this.getTransform());else if("position"===n){const t=this.attrs.x||0,n=this.attrs.y||0,r=this.attrs.offsetX||0,i=this.attrs.offsetY||0;e.translate(t-r,n-i)}return e.dirty=!1,e}getAbsoluteScale(t){for(var e=this;e;)e._isUnderCache&&(t=e),e=e.getParent();const n=this.getAbsoluteTransform(t).decompose();return{x:n.scaleX,y:n.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(V,this._getTransform)}_getTransform(){var t,e,n=this._cache.get(V)||new s;n.reset();var r=this.x(),i=this.y(),o=a.getAngle(this.rotation()),h=null!==(t=this.attrs.scaleX)&&void 0!==t?t:1,u=null!==(e=this.attrs.scaleY)&&void 0!==e?e:1,l=this.attrs.skewX||0,c=this.attrs.skewY||0,f=this.attrs.offsetX||0,d=this.attrs.offsetY||0;return 0===r&&0===i||n.translate(r,i),0!==o&&n.rotate(o),0===l&&0===c||n.skew(l,c),1===h&&1===u||n.scale(h,u),0===f&&0===d||n.translate(-1*f,-1*d),n.dirty=!1,n}clone(t){var e,n,r,i,a,o=p.cloneObject(this.attrs);for(e in t)o[e]=t[e];var s=new this.constructor(o);for(e in this.eventListeners)for(r=(n=this.eventListeners[e]).length,i=0;i<r;i++)(a=n[i]).name.indexOf("konva")<0&&(s.eventListeners[e]||(s.eventListeners[e]=[]),s.eventListeners[e].push(a));return s}_toKonvaCanvas(t){t=t||{};var e=this.getClientRect(),n=this.getStage(),r=void 0!==t.x?t.x:e.x,i=void 0!==t.y?t.y:e.y,a=t.pixelRatio||1,o=new G({width:t.width||e.width||(n?n.width():0),height:t.height||e.height||(n?n.height():0),pixelRatio:a}),s=o.getContext();return s.save(),(r||i)&&s.translate(-1*r,-1*i),this.drawScene(o),s.restore(),o}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){var e=(t=t||{}).mimeType||null,n=t.quality||null,r=this._toKonvaCanvas(t).toDataURL(e,n);return t.callback&&t.callback(r),r}toImage(t){if(!t||!t.callback)throw"callback required for toImage method config argument";var e=t.callback;delete t.callback,p._urlToImage(this.toDataURL(t),(function(t){e(t)}))}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return void 0!==this.attrs.dragDistance?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():a.dragDistance}_off(t,e,n){var r,i,a,o=this.eventListeners[t];for(r=0;r<o.length;r++)if(i=o[r].name,a=o[r].handler,!("konva"===i&&"konva"!==e||e&&i!==e||n&&n!==a)){if(o.splice(r,1),0===o.length){delete this.eventListeners[t];break}r--}}_fireChangeEvent(t,e,n){this._fire(t+"Change",{oldVal:e,newVal:n})}addName(t){if(!this.hasName(t)){var e=this.name(),n=e?e+" "+t:t;this.name(n)}return this}hasName(t){if(!t)return!1;const e=this.name();return!!e&&-1!==(e||"").split(/\s/g).indexOf(t)}removeName(t){var e=(this.name()||"").split(/\s/g),n=e.indexOf(t);return-1!==n&&(e.splice(n,1),this.name(e.join(" "))),this}setAttr(t,e){var n=this["set"+p._capitalize(t)];return p._isFunction(n)?n.call(this,e):this._setAttr(t,e),this}_requestDraw(){if(a.autoDrawEnabled){const t=this.getLayer()||this.getStage();null==t||t.batchDraw()}}_setAttr(t,e){var n=this.attrs[t];(n!==e||p.isObject(e))&&(null==e?delete this.attrs[t]:this.attrs[t]=e,this._shouldFireChangeEvents&&this._fireChangeEvent(t,n,e),this._requestDraw())}_setComponentAttr(t,e,n){var r;void 0!==n&&((r=this.attrs[t])||(this.attrs[t]=this.getAttr(t)),this.attrs[t][e]=n,this._fireChangeEvent(t,r,n))}_fireAndBubble(t,e,n){if(e&&this.nodeType===Y&&(e.target=this),t!==H&&t!==U||!(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||"Stage"===this.nodeType&&!n)){this._fire(t,e);var r=(t===H||t===U)&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(e&&!e.cancelBubble||!e)&&this.parent&&this.parent.isListening()&&!r&&(n&&n.parent?this._fireAndBubble.call(this.parent,t,e,n):this._fireAndBubble.call(this.parent,t,e))}}_getProtoListeners(t){let e=this._cache.get(N);if(!e){e={};let t=Object.getPrototypeOf(this);for(;t;)if(t.eventListeners){for(var n in t.eventListeners){const r=t.eventListeners[n],i=e[n]||[];e[n]=r.concat(i)}t=Object.getPrototypeOf(t)}else t=Object.getPrototypeOf(t);this._cache.set(N,e)}return e[t]}_fire(t,e){(e=e||{}).currentTarget=this,e.type=t;const n=this._getProtoListeners(t);if(n)for(var r=0;r<n.length;r++)n[r].handler.call(this,e);const i=this.eventListeners[t];if(i)for(r=0;r<i.length;r++)i[r].handler.call(this,e)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){var e=t?t.pointerId:void 0,n=this.getStage(),r=this.getAbsolutePosition(),i=n._getPointerById(e)||n._changedPointerPositions[0]||r;D._dragElements.set(this._id,{node:this,startPointerPos:i,offset:{x:i.x-r.x,y:i.y-r.y},dragStatus:"ready",pointerId:e})}startDrag(t,e=!0){D._dragElements.has(this._id)||this._createDragElement(t),D._dragElements.get(this._id).dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},e)}_setDragPosition(t,e){const n=this.getStage()._getPointerById(e.pointerId);if(n){var r={x:n.x-e.offset.x,y:n.y-e.offset.y},i=this.dragBoundFunc();if(void 0!==i){const e=i.call(this,r,t);e?r=e:p.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}this._lastPos&&this._lastPos.x===r.x&&this._lastPos.y===r.y||(this.setAbsolutePosition(r),this._requestDraw()),this._lastPos=r}}stopDrag(t){const e=D._dragElements.get(this._id);e&&(e.dragStatus="stopped"),D._endDragBefore(t),D._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=D._dragElements.get(this._id);return!!t&&"dragging"===t.dragStatus}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",(function(t){if((void 0===t.evt.button||a.dragButtons.indexOf(t.evt.button)>=0)&&!this.isDragging()){var e=!1;D._dragElements.forEach((t=>{this.isAncestorOf(t.node)&&(e=!0)})),e||this._createDragElement(t)}}))}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const t=D._dragElements.get(this._id),e=t&&"dragging"===t.dragStatus,n=t&&"ready"===t.dragStatus;e?this.stopDrag():n&&D._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const e=this.getStage();if(!e)return!1;const n={x:-t.x,y:-t.y,width:e.width()+t.x,height:e.height()+t.y};return p.haveIntersection(n,this.getClientRect())}static create(t,e){return p._isString(t)&&(t=JSON.parse(t)),this._createNode(t,e)}static _createNode(t,e){var n,r,i,o=Q.prototype.getClassName.call(t),s=t.children;if(e&&(t.attrs.container=e),a[o]||(p.warn('Can not find a node with class name "'+o+'". Fallback to "Shape".'),o="Shape"),n=new(0,a[o])(t.attrs),s)for(r=s.length,i=0;i<r;i++)n.add(Q._createNode(s[i]));return n}}Q.prototype.nodeType="Node",Q.prototype._attrsAffectingSize=[],Q.prototype.eventListeners={},Q.prototype.on.call(Q.prototype,$,(function(){this._batchingTransformChange?this._needClearTransformCache=!0:(this._clearCache(V),this._clearSelfAndDescendantCache(j))})),Q.prototype.on.call(Q.prototype,"visibleChange.konva",(function(){this._clearSelfAndDescendantCache(K)})),Q.prototype.on.call(Q.prototype,"listeningChange.konva",(function(){this._clearSelfAndDescendantCache(W)})),Q.prototype.on.call(Q.prototype,"opacityChange.konva",(function(){this._clearSelfAndDescendantCache(F)}));const Z=P.addGetterSetter;Z(Q,"zIndex"),Z(Q,"absolutePosition"),Z(Q,"position"),Z(Q,"x",0,y()),Z(Q,"y",0,y()),Z(Q,"globalCompositeOperation","source-over",x()),Z(Q,"opacity",1,y()),Z(Q,"name","",x()),Z(Q,"id","",x()),Z(Q,"rotation",0,y()),P.addComponentsGetterSetter(Q,"scale",["x","y"]),Z(Q,"scaleX",1,y()),Z(Q,"scaleY",1,y()),P.addComponentsGetterSetter(Q,"skew",["x","y"]),Z(Q,"skewX",0,y()),Z(Q,"skewY",0,y()),P.addComponentsGetterSetter(Q,"offset",["x","y"]),Z(Q,"offsetX",0,y()),Z(Q,"offsetY",0,y()),Z(Q,"dragDistance",null,y()),Z(Q,"width",0,y()),Z(Q,"height",0,y()),Z(Q,"listening",!0,S()),Z(Q,"preventDefault",!0,S()),Z(Q,"filters",null,(function(t){return this._filterUpToDate=!1,t})),Z(Q,"visible",!0,S()),Z(Q,"transformsEnabled","all",x()),Z(Q,"size"),Z(Q,"dragBoundFunc"),Z(Q,"draggable",!1,S()),P.backCompat(Q,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});class tt extends Q{constructor(){super(...arguments),this.children=[]}getChildren(t){if(!t)return this.children||[];const e=this.children||[];var n=[];return e.forEach((function(e){t(e)&&n.push(e)})),n}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach((t=>{t.parent=null,t.index=0,t.remove()})),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach((t=>{t.parent=null,t.index=0,t.destroy()})),this.children=[],this._requestDraw(),this}add(...t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}var n=t[0];return n.getParent()?(n.moveTo(this),this):(this._validateAdd(n),n.index=this.getChildren().length,n.parent=this,n._clearCaches(),this.getChildren().push(n),this._fire("add",{child:n}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){var e=this._generalFind(t,!0);return e.length>0?e[0]:void 0}_generalFind(t,e){var n=[];return this._descendants((r=>{const i=r._isMatch(t);return i&&n.push(r),!(!i||!e)})),n}_descendants(t){let e=!1;const n=this.getChildren();for(const r of n){if(e=t(r),e)return!0;if(r.hasChildren()&&(e=r._descendants(t),e))return!0}return!1}toObject(){var t=Q.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach((e=>{t.children.push(e.toObject())})),t}isAncestorOf(t){for(var e=t.getParent();e;){if(e._id===this._id)return!0;e=e.getParent()}return!1}clone(t){var e=Q.prototype.clone.call(this,t);return this.getChildren().forEach((function(t){e.add(t.clone())})),e}getAllIntersections(t){var e=[];return this.find("Shape").forEach((function(n){n.isVisible()&&n.intersects(t)&&e.push(n)})),e}_clearSelfAndDescendantCache(t){var e;super._clearSelfAndDescendantCache(t),this.isCached()||null===(e=this.children)||void 0===e||e.forEach((function(e){e._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;null===(t=this.children)||void 0===t||t.forEach((function(t,e){t.index=e})),this._requestDraw()}drawScene(t,e){var n=this.getLayer(),r=t||n&&n.getCanvas(),i=r&&r.getContext(),a=this._getCanvasCache(),o=a&&a.scene,s=r&&r.isCache;if(!this.isVisible()&&!s)return this;if(o){i.save();var h=this.getAbsoluteTransform(e).getMatrix();i.transform(h[0],h[1],h[2],h[3],h[4],h[5]),this._drawCachedSceneCanvas(i),i.restore()}else this._drawChildren("drawScene",r,e);return this}drawHit(t,e){if(!this.shouldDrawHit(e))return this;var n=this.getLayer(),r=t||n&&n.hitCanvas,i=r&&r.getContext(),a=this._getCanvasCache();if(a&&a.hit){i.save();var o=this.getAbsoluteTransform(e).getMatrix();i.transform(o[0],o[1],o[2],o[3],o[4],o[5]),this._drawCachedHitCanvas(i),i.restore()}else this._drawChildren("drawHit",r,e);return this}_drawChildren(t,e,n){var r,i=e&&e.getContext(),a=this.clipWidth(),o=this.clipHeight(),s=this.clipFunc(),h=a&&o||s;const u=n===this;if(h){i.save();var l=this.getAbsoluteTransform(n),c=l.getMatrix();if(i.transform(c[0],c[1],c[2],c[3],c[4],c[5]),i.beginPath(),s)s.call(this,i,this);else{var f=this.clipX(),d=this.clipY();i.rect(f,d,a,o)}i.clip(),c=l.copy().invert().getMatrix(),i.transform(c[0],c[1],c[2],c[3],c[4],c[5])}var g=!u&&"source-over"!==this.globalCompositeOperation()&&"drawScene"===t;g&&(i.save(),i._applyGlobalCompositeOperation(this)),null===(r=this.children)||void 0===r||r.forEach((function(r){r[t](e,n)})),g&&i.restore(),h&&i.restore()}getClientRect(t){var e,n,r,i,a,o,s=(t=t||{}).skipTransform,h=t.relativeTo,u=this;null===(e=this.children)||void 0===e||e.forEach((function(e){if(e.visible()){var o=e.getClientRect({relativeTo:u,skipShadow:t.skipShadow,skipStroke:t.skipStroke});0===o.width&&0===o.height||(void 0===n?(n=o.x,r=o.y,i=o.x+o.width,a=o.y+o.height):(n=Math.min(n,o.x),r=Math.min(r,o.y),i=Math.max(i,o.x+o.width),a=Math.max(a,o.y+o.height)))}}));for(var l=this.find("Shape"),c=!1,f=0;f<l.length;f++)if(l[f]._isVisible(this)){c=!0;break}return o=c&&void 0!==n?{x:n,y:r,width:i-n,height:a-r}:{x:0,y:0,width:0,height:0},s?o:this._transformedRect(o,h)}}P.addComponentsGetterSetter(tt,"clip",["x","y","width","height"]),P.addGetterSetter(tt,"clipX",void 0,y()),P.addGetterSetter(tt,"clipY",void 0,y()),P.addGetterSetter(tt,"clipWidth",void 0,y()),P.addGetterSetter(tt,"clipHeight",void 0,y()),P.addGetterSetter(tt,"clipFunc");const et=new Map,nt=void 0!==a._global.PointerEvent;function rt(t){return et.get(t)}function it(t){return{evt:t,pointerId:t.pointerId}}function at(t,e){return et.get(t)===e}function ot(t,e){st(t),e.getStage()&&(et.set(t,e),nt&&e._fire("gotpointercapture",it(new PointerEvent("gotpointercapture"))))}function st(t,e){const n=et.get(t);if(!n)return;const r=n.getStage();r&&r.content,et.delete(t),nt&&n._fire("lostpointercapture",it(new PointerEvent("lostpointercapture")))}var ht="mouseleave",ut="mouseover",lt="mouseenter",ct="mousemove",ft="mousedown",dt="mouseup",gt="pointermove",pt="pointerdown",vt="pointerup",mt="pointercancel",yt="pointerout",_t="pointerleave",bt="pointerover",xt="pointerenter",wt="contextmenu",St="touchstart",kt="touchend",Ct="touchmove",Pt="touchcancel",At="wheel",Tt=[[lt,"_pointerenter"],[ft,"_pointerdown"],[ct,"_pointermove"],[dt,"_pointerup"],[ht,"_pointerleave"],[St,"_pointerdown"],[Ct,"_pointermove"],[kt,"_pointerup"],[Pt,"_pointercancel"],[ut,"_pointerover"],[At,"_wheel"],[wt,"_contextmenu"],[pt,"_pointerdown"],[gt,"_pointermove"],[vt,"_pointerup"],[mt,"_pointercancel"],["lostpointercapture","_lostpointercapture"]];const Ot={mouse:{[yt]:"mouseout",[_t]:ht,[bt]:ut,[xt]:lt,[gt]:ct,[pt]:ft,[vt]:dt,[mt]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[yt]:"touchout",[_t]:"touchleave",[bt]:"touchover",[xt]:"touchenter",[gt]:Ct,[pt]:St,[vt]:kt,[mt]:Pt,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[yt]:yt,[_t]:_t,[bt]:bt,[xt]:xt,[gt]:gt,[pt]:pt,[vt]:vt,[mt]:mt,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},Lt=t=>t.indexOf("pointer")>=0?"pointer":t.indexOf("touch")>=0?"touch":"mouse",Et=t=>{const e=Lt(t);return"pointer"===e?a.pointerEventsEnabled&&Ot.pointer:"touch"===e?Ot.touch:"mouse"===e?Ot.mouse:void 0};function Rt(t={}){return(t.clipFunc||t.clipWidth||t.clipHeight)&&p.warn("Stage does not support clipping. Please use clip for Layers or Groups."),t}const Mt=[];class Gt extends tt{constructor(t){super(Rt(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),Mt.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",(()=>{Rt(this.attrs)})),this._checkVisibility()}_validateAdd(t){const e="Layer"===t.getType(),n="FastLayer"===t.getType();e||n||p.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if("string"==typeof t){if("."===t.charAt(0)){var e=t.slice(1);t=document.getElementsByClassName(e)[0]}else{var n;n="#"!==t.charAt(0)?t:t.slice(1),t=document.getElementById(n)}if(!t)throw"Can not find container in document with id "+n}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){var t,e=this.children,n=e.length;for(t=0;t<n;t++)e[t].clear();return this}clone(t){return t||(t={}),t.container="undefined"!=typeof document&&document.createElement("div"),tt.prototype.clone.call(this,t)}destroy(){super.destroy();var t=this.content;t&&p._isInDocument(t)&&this.container().removeChild(t);var e=Mt.indexOf(this);return e>-1&&Mt.splice(e,1),this}getPointerPosition(){const t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(p.warn("Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);"),null)}_getPointerById(t){return this._pointerPositions.find((e=>e.id===t))}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){(t=t||{}).x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();var e=new G({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),n=e.getContext()._context,r=this.children;return(t.x||t.y)&&n.translate(-1*t.x,-1*t.y),r.forEach((function(e){if(e.isVisible()){var r=e._toKonvaCanvas(t);n.drawImage(r._canvas,t.x,t.y,r.getWidth()/r.getPixelRatio(),r.getHeight()/r.getPixelRatio())}})),e}getIntersection(t){if(!t)return null;var e,n=this.children;for(e=n.length-1;e>=0;e--){const r=n[e].getIntersection(t);if(r)return r}return null}_resizeDOM(){var t=this.width(),e=this.height();this.content&&(this.content.style.width=t+"px",this.content.style.height=e+"px"),this.bufferCanvas.setSize(t,e),this.bufferHitCanvas.setSize(t,e),this.children.forEach((n=>{n.setSize({width:t,height:e}),n.draw()}))}add(t,...e){if(arguments.length>1){for(var n=0;n<arguments.length;n++)this.add(arguments[n]);return this}super.add(t);var r=this.children.length;return r>5&&p.warn("The stage has "+r+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),a.isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return at(t,this)}setPointerCapture(t){ot(t,this)}releaseCapture(t){st(t)}getLayers(){return this.children}_bindContentEvents(){a.isBrowser&&Tt.forEach((([t,e])=>{this.content.addEventListener(t,(t=>{this[e](t)}))}))}_pointerenter(t){this.setPointersPositions(t);const e=Et(t.type);this._fire(e.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);const e=Et(t.type);this._fire(e.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let e=this[t+"targetShape"];return e&&!e.getStage()&&(e=null),e}_pointerleave(t){const e=Et(t.type),n=Lt(t.type);if(e){this.setPointersPositions(t);var r=this._getTargetShape(n),i=!D.isDragging||a.hitOnDragEnabled;r&&i?(r._fireAndBubble(e.pointerout,{evt:t}),r._fireAndBubble(e.pointerleave,{evt:t}),this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this[n+"targetShape"]=null):i&&(this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(e.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=void 0,this._pointerPositions=[]}}_pointerdown(t){const e=Et(t.type),n=Lt(t.type);if(e){this.setPointersPositions(t);var r=!1;this._changedPointerPositions.forEach((i=>{var o=this.getIntersection(i);if(D.justDragged=!1,a["_"+n+"ListenClick"]=!0,!o||!o.isListening())return;a.capturePointerEventsEnabled&&o.setPointerCapture(i.id),this[n+"ClickStartShape"]=o,o._fireAndBubble(e.pointerdown,{evt:t,pointerId:i.id}),r=!0;const s=t.type.indexOf("touch")>=0;o.preventDefault()&&t.cancelable&&s&&t.preventDefault()})),r||this._fire(e.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}}_pointermove(t){const e=Et(t.type),n=Lt(t.type);if(!e)return;if(D.isDragging&&D.node.preventDefault()&&t.cancelable&&t.preventDefault(),this.setPointersPositions(t),D.isDragging&&!a.hitOnDragEnabled)return;var r={};let i=!1;var o=this._getTargetShape(n);this._changedPointerPositions.forEach((a=>{const s=rt(a.id)||this.getIntersection(a),h=a.id,u={evt:t,pointerId:h};var l=o!==s;if(l&&o&&(o._fireAndBubble(e.pointerout,Object.assign({},u),s),o._fireAndBubble(e.pointerleave,Object.assign({},u),s)),s){if(r[s._id])return;r[s._id]=!0}s&&s.isListening()?(i=!0,l&&(s._fireAndBubble(e.pointerover,Object.assign({},u),o),s._fireAndBubble(e.pointerenter,Object.assign({},u),o),this[n+"targetShape"]=s),s._fireAndBubble(e.pointermove,Object.assign({},u))):o&&(this._fire(e.pointerover,{evt:t,target:this,currentTarget:this,pointerId:h}),this[n+"targetShape"]=null)})),i||this._fire(e.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){const e=Et(t.type),n=Lt(t.type);if(!e)return;this.setPointersPositions(t);const r=this[n+"ClickStartShape"],i=this[n+"ClickEndShape"];var o={};let s=!1;this._changedPointerPositions.forEach((h=>{const u=rt(h.id)||this.getIntersection(h);if(u){if(u.releaseCapture(h.id),o[u._id])return;o[u._id]=!0}const l=h.id,c={evt:t,pointerId:l};let f=!1;a["_"+n+"InDblClickWindow"]&&a["_"+n+"InDblClickWindowId"]===l?(f=!0,clearTimeout(this[n+"DblTimeout"])):D.justDragged||(a["_"+n+"InDblClickWindow"]=!0,a["_"+n+"InDblClickWindowId"]=l,clearTimeout(this[n+"DblTimeout"])),this[n+"DblTimeout"]=setTimeout((function(){a["_"+n+"InDblClickWindow"]=!1}),a.dblClickWindow),u&&u.isListening()?(s=!0,this[n+"ClickEndShape"]=u,u._fireAndBubble(e.pointerup,Object.assign({},c)),a["_"+n+"ListenClick"]&&r&&r===u&&(u._fireAndBubble(e.pointerclick,Object.assign({},c)),f&&i&&i===u&&u._fireAndBubble(e.pointerdblclick,Object.assign({},c)))):(this[n+"ClickEndShape"]=null,a["_"+n+"ListenClick"]&&this._fire(e.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:l}),f&&this._fire(e.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:l}))})),s||this._fire(e.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),a["_"+n+"ListenClick"]=!1,t.cancelable&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);var e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(wt,{evt:t}):this._fire(wt,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);var e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(At,{evt:t}):this._fire(At,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);const e=rt(t.pointerId)||this.getIntersection(this.getPointerPosition());e&&e._fireAndBubble(vt,it(t)),st(t.pointerId)}_lostpointercapture(t){st(t.pointerId)}setPointersPositions(t){var e=this._getContentPosition(),n=null,r=null;void 0!==(t=t||window.event).touches?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,(t=>{this._pointerPositions.push({id:t.identifier,x:(t.clientX-e.left)/e.scaleX,y:(t.clientY-e.top)/e.scaleY})})),Array.prototype.forEach.call(t.changedTouches||t.touches,(t=>{this._changedPointerPositions.push({id:t.identifier,x:(t.clientX-e.left)/e.scaleX,y:(t.clientY-e.top)/e.scaleY})}))):(n=(t.clientX-e.left)/e.scaleX,r=(t.clientY-e.top)/e.scaleY,this.pointerPos={x:n,y:r},this._pointerPositions=[{x:n,y:r,id:p._getFirstPointerId(t)}],this._changedPointerPositions=[{x:n,y:r,id:p._getFirstPointerId(t)}])}_setPointerPosition(t){p.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};var t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new G({width:this.width(),height:this.height()}),this.bufferHitCanvas=new I({pixelRatio:1,width:this.width(),height:this.height()}),a.isBrowser){var t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}}cache(){return p.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach((function(t){t.batchDraw()})),this}}Gt.prototype.nodeType="Stage",o(Gt),P.addGetterSetter(Gt,"container");var It="hasShadow",Dt="shadowRGBA",Ft="patternImage",Nt="linearGradient",jt="radialGradient";let Bt;function zt(){return Bt||(Bt=p.createCanvasElement().getContext("2d"),Bt)}const Wt={};class Ht extends Q{constructor(t){let e;for(super(t);e=p.getRandomColor(),!e||e in Wt;);this.colorKey=e,Wt[e]=this}getContext(){return p.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return p.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(It,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&0!==this.shadowOpacity()&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(Ft,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const t=zt().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(t&&t.setTransform){const e=new s;e.translate(this.fillPatternX(),this.fillPatternY()),e.rotate(a.getAngle(this.fillPatternRotation())),e.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),e.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const n=e.getMatrix();t.setTransform({a:n[0],b:n[1],c:n[2],d:n[3],e:n[4],f:n[5]})}return t}}_getLinearGradient(){return this._getCache(Nt,this.__getLinearGradient)}__getLinearGradient(){var t=this.fillLinearGradientColorStops();if(t){for(var e=zt(),n=this.fillLinearGradientStartPoint(),r=this.fillLinearGradientEndPoint(),i=e.createLinearGradient(n.x,n.y,r.x,r.y),a=0;a<t.length;a+=2)i.addColorStop(t[a],t[a+1]);return i}}_getRadialGradient(){return this._getCache(jt,this.__getRadialGradient)}__getRadialGradient(){var t=this.fillRadialGradientColorStops();if(t){for(var e=zt(),n=this.fillRadialGradientStartPoint(),r=this.fillRadialGradientEndPoint(),i=e.createRadialGradient(n.x,n.y,this.fillRadialGradientStartRadius(),r.x,r.y,this.fillRadialGradientEndRadius()),a=0;a<t.length;a+=2)i.addColorStop(t[a],t[a+1]);return i}}getShadowRGBA(){return this._getCache(Dt,this._getShadowRGBA)}_getShadowRGBA(){if(this.hasShadow()){var t=p.colorToRGBA(this.shadowColor());return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],(()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops())))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],(()=>this.strokeEnabled()&&this.strokeWidth()&&!(!this.stroke()&&!this.strokeLinearGradientColorStops())))}hasHitStroke(){const t=this.hitStrokeWidth();return"auto"===t?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){var e=this.getStage().bufferHitCanvas;return e.getContext().clear(),this.drawHit(e,null,!0),e.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data[3]>0}destroy(){return Q.prototype.destroy.call(this),delete Wt[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var e;if(!this.getStage())return!1;if(null!==(e=this.attrs.perfectDrawEnabled)&&void 0!==e&&!e)return!1;const n=t||this.hasFill(),r=this.hasStroke(),i=1!==this.getAbsoluteOpacity();if(n&&r&&i)return!0;const a=this.hasShadow(),o=this.shadowForStrokeEnabled();return!!(n&&r&&a&&o)}setStrokeHitEnabled(t){p.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return 0!==this.hitStrokeWidth()}getSelfRect(){var t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){const e=t.skipTransform,n=t.relativeTo,r=this.getSelfRect(),i=!t.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,a=r.width+i,o=r.height+i,s=!t.skipShadow&&this.hasShadow(),h=s?this.shadowOffsetX():0,u=s?this.shadowOffsetY():0,l=a+Math.abs(h),c=o+Math.abs(u),f=s&&this.shadowBlur()||0,d=l+2*f,g=c+2*f;let p=0;Math.round(i/2)!==i/2&&(p=1);const v={width:d+p,height:g+p,x:-Math.round(i/2+f)+Math.min(h,0)+r.x,y:-Math.round(i/2+f)+Math.min(u,0)+r.y};return e?v:this._transformedRect(v,n)}drawScene(t,e){var n,r,i=this.getLayer(),a=t||i.getCanvas(),o=a.getContext(),s=this._getCanvasCache(),h=this.getSceneFunc(),u=this.hasShadow(),l=a.isCache,c=e===this;if(!this.isVisible()&&!c)return this;if(s){o.save();var f=this.getAbsoluteTransform(e).getMatrix();return o.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this._drawCachedSceneCanvas(o),o.restore(),this}if(!h)return this;if(o.save(),this._useBufferCanvas()&&!l){(r=(n=this.getStage().bufferCanvas).getContext()).clear(),r.save(),r._applyLineJoin(this);var d=this.getAbsoluteTransform(e).getMatrix();r.transform(d[0],d[1],d[2],d[3],d[4],d[5]),h.call(this,r,this),r.restore();var g=n.pixelRatio;u&&o._applyShadow(this),o._applyOpacity(this),o._applyGlobalCompositeOperation(this),o.drawImage(n._canvas,0,0,n.width/g,n.height/g)}else o._applyLineJoin(this),c||(d=this.getAbsoluteTransform(e).getMatrix(),o.transform(d[0],d[1],d[2],d[3],d[4],d[5]),o._applyOpacity(this),o._applyGlobalCompositeOperation(this)),u&&o._applyShadow(this),h.call(this,o,this);return o.restore(),this}drawHit(t,e,n=!1){if(!this.shouldDrawHit(e,n))return this;var r=this.getLayer(),i=t||r.hitCanvas,a=i&&i.getContext(),o=this.hitFunc()||this.sceneFunc(),s=this._getCanvasCache(),h=s&&s.hit;if(this.colorKey||p.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),h){a.save();var u=this.getAbsoluteTransform(e).getMatrix();return a.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedHitCanvas(a),a.restore(),this}if(!o)return this;if(a.save(),a._applyLineJoin(this),this!==e){var l=this.getAbsoluteTransform(e).getMatrix();a.transform(l[0],l[1],l[2],l[3],l[4],l[5])}return o.call(this,a,this),a.restore(),this}drawHitFromCache(t=0){var e,n,r,i,a,o=this._getCanvasCache(),s=this._getCachedSceneCanvas(),h=o.hit,u=h.getContext(),l=h.getWidth(),c=h.getHeight();u.clear(),u.drawImage(s._canvas,0,0,l,c);try{for(r=(n=(e=u.getImageData(0,0,l,c)).data).length,i=p._hexToRgb(this.colorKey),a=0;a<r;a+=4)n[a+3]>t?(n[a]=i.r,n[a+1]=i.g,n[a+2]=i.b,n[a+3]=255):n[a+3]=0;u.putImageData(e,0,0)}catch(t){p.error("Unable to draw hit graph from cached scene canvas. "+t.message)}return this}hasPointerCapture(t){return at(t,this)}setPointerCapture(t){ot(t,this)}releaseCapture(t){st(t)}}Ht.prototype._fillFunc=function(t){t.fill()},Ht.prototype._strokeFunc=function(t){t.stroke()},Ht.prototype._fillFuncHit=function(t){t.fill()},Ht.prototype._strokeFuncHit=function(t){t.stroke()},Ht.prototype._centroid=!1,Ht.prototype.nodeType="Shape",o(Ht),Ht.prototype.eventListeners={},Ht.prototype.on.call(Ht.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",(function(){this._clearCache(It)})),Ht.prototype.on.call(Ht.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",(function(){this._clearCache(Dt)})),Ht.prototype.on.call(Ht.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",(function(){this._clearCache(Ft)})),Ht.prototype.on.call(Ht.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",(function(){this._clearCache(Nt)})),Ht.prototype.on.call(Ht.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",(function(){this._clearCache(jt)})),P.addGetterSetter(Ht,"stroke",void 0,w()),P.addGetterSetter(Ht,"strokeWidth",2,y()),P.addGetterSetter(Ht,"fillAfterStrokeEnabled",!1),P.addGetterSetter(Ht,"hitStrokeWidth","auto",b()),P.addGetterSetter(Ht,"strokeHitEnabled",!0,S()),P.addGetterSetter(Ht,"perfectDrawEnabled",!0,S()),P.addGetterSetter(Ht,"shadowForStrokeEnabled",!0,S()),P.addGetterSetter(Ht,"lineJoin"),P.addGetterSetter(Ht,"lineCap"),P.addGetterSetter(Ht,"sceneFunc"),P.addGetterSetter(Ht,"hitFunc"),P.addGetterSetter(Ht,"dash"),P.addGetterSetter(Ht,"dashOffset",0,y()),P.addGetterSetter(Ht,"shadowColor",void 0,x()),P.addGetterSetter(Ht,"shadowBlur",0,y()),P.addGetterSetter(Ht,"shadowOpacity",1,y()),P.addComponentsGetterSetter(Ht,"shadowOffset",["x","y"]),P.addGetterSetter(Ht,"shadowOffsetX",0,y()),P.addGetterSetter(Ht,"shadowOffsetY",0,y()),P.addGetterSetter(Ht,"fillPatternImage"),P.addGetterSetter(Ht,"fill",void 0,w()),P.addGetterSetter(Ht,"fillPatternX",0,y()),P.addGetterSetter(Ht,"fillPatternY",0,y()),P.addGetterSetter(Ht,"fillLinearGradientColorStops"),P.addGetterSetter(Ht,"strokeLinearGradientColorStops"),P.addGetterSetter(Ht,"fillRadialGradientStartRadius",0),P.addGetterSetter(Ht,"fillRadialGradientEndRadius",0),P.addGetterSetter(Ht,"fillRadialGradientColorStops"),P.addGetterSetter(Ht,"fillPatternRepeat","repeat"),P.addGetterSetter(Ht,"fillEnabled",!0),P.addGetterSetter(Ht,"strokeEnabled",!0),P.addGetterSetter(Ht,"shadowEnabled",!0),P.addGetterSetter(Ht,"dashEnabled",!0),P.addGetterSetter(Ht,"strokeScaleEnabled",!0),P.addGetterSetter(Ht,"fillPriority","color"),P.addComponentsGetterSetter(Ht,"fillPatternOffset",["x","y"]),P.addGetterSetter(Ht,"fillPatternOffsetX",0,y()),P.addGetterSetter(Ht,"fillPatternOffsetY",0,y()),P.addComponentsGetterSetter(Ht,"fillPatternScale",["x","y"]),P.addGetterSetter(Ht,"fillPatternScaleX",1,y()),P.addGetterSetter(Ht,"fillPatternScaleY",1,y()),P.addComponentsGetterSetter(Ht,"fillLinearGradientStartPoint",["x","y"]),P.addComponentsGetterSetter(Ht,"strokeLinearGradientStartPoint",["x","y"]),P.addGetterSetter(Ht,"fillLinearGradientStartPointX",0),P.addGetterSetter(Ht,"strokeLinearGradientStartPointX",0),P.addGetterSetter(Ht,"fillLinearGradientStartPointY",0),P.addGetterSetter(Ht,"strokeLinearGradientStartPointY",0),P.addComponentsGetterSetter(Ht,"fillLinearGradientEndPoint",["x","y"]),P.addComponentsGetterSetter(Ht,"strokeLinearGradientEndPoint",["x","y"]),P.addGetterSetter(Ht,"fillLinearGradientEndPointX",0),P.addGetterSetter(Ht,"strokeLinearGradientEndPointX",0),P.addGetterSetter(Ht,"fillLinearGradientEndPointY",0),P.addGetterSetter(Ht,"strokeLinearGradientEndPointY",0),P.addComponentsGetterSetter(Ht,"fillRadialGradientStartPoint",["x","y"]),P.addGetterSetter(Ht,"fillRadialGradientStartPointX",0),P.addGetterSetter(Ht,"fillRadialGradientStartPointY",0),P.addComponentsGetterSetter(Ht,"fillRadialGradientEndPoint",["x","y"]),P.addGetterSetter(Ht,"fillRadialGradientEndPointX",0),P.addGetterSetter(Ht,"fillRadialGradientEndPointY",0),P.addGetterSetter(Ht,"fillPatternRotation",0),P.backCompat(Ht,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});var Ut=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],Yt=Ut.length;class qt extends tt{constructor(t){super(t),this.canvas=new G,this.hitCanvas=new I({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);var e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),t<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[t+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Q.prototype.moveToTop.call(this);var t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!Q.prototype.moveUp.call(this))return!1;var t=this.getStage();return!(!t||!t.content||(t.content.removeChild(this.getNativeCanvasElement()),this.index<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[this.index+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement()),0))}moveDown(){if(Q.prototype.moveDown.call(this)){var t=this.getStage();if(t){var e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Q.prototype.moveToBottom.call(this)){var t=this.getStage();if(t){var e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){var t=this.getNativeCanvasElement();return Q.prototype.remove.call(this),t&&t.parentNode&&p._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:e}){return this.canvas.setSize(t,e),this.hitCanvas.setSize(t,e),this._setSmoothEnabled(),this}_validateAdd(t){var e=t.getType();"Group"!==e&&"Shape"!==e&&p.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return(t=t||{}).width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=void 0!==t.x?t.x:this.x(),t.y=void 0!==t.y?t.y:this.y(),Q.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){const t=this.visible();this.canvas._canvas.style.display=t?"block":"none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){p.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){p.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,p.requestAnimFrame((()=>{this.draw(),this._waitingForDraw=!1}))),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;for(var e=1,n=!1;;){for(let r=0;r<Yt;r++){const i=Ut[r],a=this._getIntersection({x:t.x+i.x*e,y:t.y+i.y*e}),o=a.shape;if(o)return o;if(n=!!a.antialiased,!a.antialiased)break}if(!n)return null;e+=1}}_getIntersection(t){const e=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(t.x*e),Math.round(t.y*e),1,1).data,r=n[3];if(255===r){const t=p._rgbToHex(n[0],n[1],n[2]),e=Wt["#"+t];return e?{shape:e}:{antialiased:!0}}return r>0?{antialiased:!0}:{}}drawScene(t,e){var n=this.getLayer(),r=t||n&&n.getCanvas();return this._fire("beforeDraw",{node:this}),this.clearBeforeDraw()&&r.getContext().clear(),tt.prototype.drawScene.call(this,r,e),this._fire("draw",{node:this}),this}drawHit(t,e){var n=this.getLayer(),r=t||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),tt.prototype.drawHit.call(this,r,e),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){p.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return p.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(this.parent&&this.parent.content){var t=this.parent;this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}}}qt.prototype.nodeType="Layer",o(qt),P.addGetterSetter(qt,"imageSmoothingEnabled",!0),P.addGetterSetter(qt,"clearBeforeDraw",!0),P.addGetterSetter(qt,"hitGraphEnabled",!0,S());class Xt extends qt{constructor(t){super(t),this.listening(!1),p.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}Xt.prototype.nodeType="FastLayer",o(Xt);class Vt extends tt{_validateAdd(t){var e=t.getType();"Group"!==e&&"Shape"!==e&&p.throw("You may only add groups and shapes to groups.")}}Vt.prototype.nodeType="Group",o(Vt);var Kt=i.performance&&i.performance.now?function(){return i.performance.now()}:function(){return(new Date).getTime()};class $t{constructor(t,e){this.id=$t.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Kt(),frameRate:0},this.func=t,this.setLayers(e)}setLayers(t){var e;return e=t?t.length>0?t:[t]:[],this.layers=e,this}getLayers(){return this.layers}addLayer(t){var e,n=this.layers,r=n.length;for(e=0;e<r;e++)if(n[e]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){var t,e=$t.animations,n=e.length;for(t=0;t<n;t++)if(e[t].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Kt(),$t._addAnimation(this),this}stop(){return $t._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){var e,n=t.id,r=this.animations,i=r.length;for(e=0;e<i;e++)if(r[e].id===n){this.animations.splice(e,1);break}}static _runFrames(){var t,e,n,r,i,a,o,s,h={},u=this.animations;for(r=0;r<u.length;r++)if(e=(t=u[r]).layers,n=t.func,t._updateFrameObject(Kt()),a=e.length,!n||!1!==n.call(t,t.frame))for(i=0;i<a;i++)void 0!==(o=e[i])._id&&(h[o._id]=o);for(s in h)h.hasOwnProperty(s)&&h[s].batchDraw()}static _animationLoop(){var t=$t;t.animations.length?(t._runFrames(),p.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,p.requestAnimFrame(this._animationLoop))}}$t.animations=[],$t.animIdCounter=0,$t.animRunning=!1;var Jt={node:1,duration:1,easing:1,onFinish:1,yoyo:1},Qt=0,Zt=["fill","stroke","shadowColor"];class te{constructor(t,e,n,r,i,a,o){this.prop=t,this.propFunc=e,this.begin=r,this._pos=r,this.duration=a,this._change=0,this.prevPos=0,this.yoyo=o,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=n,this._change=i-this.begin,this.pause()}fire(t){var e=this[t];e&&e()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return void 0===t&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=2,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=3,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){var t=this.getTimer()-this._startTime;2===this.state?this.setTime(t):3===this.state&&this.setTime(this.duration-t)}pause(){this.state=1,this.fire("onPause")}getTimer(){return(new Date).getTime()}}class ee{constructor(t){var e,n,r=this,i=t.node,o=i._id,s=t.easing||ne.Linear,h=!!t.yoyo;e=void 0===t.duration?.3:0===t.duration?.001:t.duration,this.node=i,this._id=Qt++;var u=i.getLayer()||(i instanceof a.Stage?i.getLayers():null);for(n in u||p.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new $t((function(){r.tween.onEnterFrame()}),u),this.tween=new te(n,(function(t){r._tweenFunc(t)}),s,0,1,1e3*e,h),this._addListeners(),ee.attrs[o]||(ee.attrs[o]={}),ee.attrs[o][this._id]||(ee.attrs[o][this._id]={}),ee.tweens[o]||(ee.tweens[o]={}),t)void 0===Jt[n]&&this._addAttr(n,t[n]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,e){var n,r,i,a,o,s,h,u,l=this.node,c=l._id;if((i=ee.tweens[c][t])&&delete ee.attrs[c][i][t],n=l.getAttr(t),p._isArray(e))if(r=[],o=Math.max(e.length,n.length),"points"===t&&e.length!==n.length&&(e.length>n.length?(h=n,n=p._prepareArrayForTween(n,e,l.closed())):(s=e,e=p._prepareArrayForTween(e,n,l.closed()))),0===t.indexOf("fill"))for(a=0;a<o;a++)if(a%2==0)r.push(e[a]-n[a]);else{var f=p.colorToRGBA(n[a]);u=p.colorToRGBA(e[a]),n[a]=f,r.push({r:u.r-f.r,g:u.g-f.g,b:u.b-f.b,a:u.a-f.a})}else for(a=0;a<o;a++)r.push(e[a]-n[a]);else-1!==Zt.indexOf(t)?(n=p.colorToRGBA(n),r={r:(u=p.colorToRGBA(e)).r-n.r,g:u.g-n.g,b:u.b-n.b,a:u.a-n.a}):r=e-n;ee.attrs[c][this._id][t]={start:n,diff:r,end:e,trueEnd:s,trueStart:h},ee.tweens[c][t]=this._id}_tweenFunc(t){var e,n,r,i,a,o,s,h,u=this.node,l=ee.attrs[u._id][this._id];for(e in l){if(r=(n=l[e]).start,i=n.diff,h=n.end,p._isArray(r))if(a=[],s=Math.max(r.length,h.length),0===e.indexOf("fill"))for(o=0;o<s;o++)o%2==0?a.push((r[o]||0)+i[o]*t):a.push("rgba("+Math.round(r[o].r+i[o].r*t)+","+Math.round(r[o].g+i[o].g*t)+","+Math.round(r[o].b+i[o].b*t)+","+(r[o].a+i[o].a*t)+")");else for(o=0;o<s;o++)a.push((r[o]||0)+i[o]*t);else a=-1!==Zt.indexOf(e)?"rgba("+Math.round(r.r+i.r*t)+","+Math.round(r.g+i.g*t)+","+Math.round(r.b+i.b*t)+","+(r.a+i.a*t)+")":r+i*t;u.setAttr(e,a)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{var t=this.node,e=ee.attrs[t._id][this._id];e.points&&e.points.trueEnd&&t.setAttr("points",e.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{var t=this.node,e=ee.attrs[t._id][this._id];e.points&&e.points.trueStart&&t.points(e.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(1e3*t),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){var t,e=this.node._id,n=this._id,r=ee.tweens[e];for(t in this.pause(),r)delete ee.tweens[e][t];delete ee.attrs[e][n]}}ee.attrs={},ee.tweens={},Q.prototype.to=function(t){var e=t.onFinish;t.node=this,t.onFinish=function(){this.destroy(),e&&e()},new ee(t).play()};const ne={BackEaseIn(t,e,n,r){var i=1.70158;return n*(t/=r)*t*((i+1)*t-i)+e},BackEaseOut(t,e,n,r){var i=1.70158;return n*((t=t/r-1)*t*((i+1)*t+i)+1)+e},BackEaseInOut(t,e,n,r){var i=1.70158;return(t/=r/2)<1?n/2*(t*t*((1+(i*=1.525))*t-i))+e:n/2*((t-=2)*t*((1+(i*=1.525))*t+i)+2)+e},ElasticEaseIn(t,e,n,r,i,a){var o=0;return 0===t?e:1==(t/=r)?e+n:(a||(a=.3*r),!i||i<Math.abs(n)?(i=n,o=a/4):o=a/(2*Math.PI)*Math.asin(n/i),-i*Math.pow(2,10*(t-=1))*Math.sin((t*r-o)*(2*Math.PI)/a)+e)},ElasticEaseOut(t,e,n,r,i,a){var o=0;return 0===t?e:1==(t/=r)?e+n:(a||(a=.3*r),!i||i<Math.abs(n)?(i=n,o=a/4):o=a/(2*Math.PI)*Math.asin(n/i),i*Math.pow(2,-10*t)*Math.sin((t*r-o)*(2*Math.PI)/a)+n+e)},ElasticEaseInOut(t,e,n,r,i,a){var o=0;return 0===t?e:2==(t/=r/2)?e+n:(a||(a=r*(.3*1.5)),!i||i<Math.abs(n)?(i=n,o=a/4):o=a/(2*Math.PI)*Math.asin(n/i),t<1?i*Math.pow(2,10*(t-=1))*Math.sin((t*r-o)*(2*Math.PI)/a)*-.5+e:i*Math.pow(2,-10*(t-=1))*Math.sin((t*r-o)*(2*Math.PI)/a)*.5+n+e)},BounceEaseOut:(t,e,n,r)=>(t/=r)<1/2.75?n*(7.5625*t*t)+e:t<2/2.75?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e,BounceEaseIn:(t,e,n,r)=>n-ne.BounceEaseOut(r-t,0,n,r)+e,BounceEaseInOut:(t,e,n,r)=>t<r/2?.5*ne.BounceEaseIn(2*t,0,n,r)+e:.5*ne.BounceEaseOut(2*t-r,0,n,r)+.5*n+e,EaseIn:(t,e,n,r)=>n*(t/=r)*t+e,EaseOut:(t,e,n,r)=>-n*(t/=r)*(t-2)+e,EaseInOut:(t,e,n,r)=>(t/=r/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e,StrongEaseIn:(t,e,n,r)=>n*(t/=r)*t*t*t*t+e,StrongEaseOut:(t,e,n,r)=>n*((t=t/r-1)*t*t*t*t+1)+e,StrongEaseInOut:(t,e,n,r)=>(t/=r/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e,Linear:(t,e,n,r)=>n*t/r+e},re=p._assign(a,{Util:p,Transform:s,Node:Q,Container:tt,Stage:Gt,stages:Mt,Layer:qt,FastLayer:Xt,Group:Vt,DD:D,Shape:Ht,shapes:Wt,Animation:$t,Tween:ee,Easings:ne,Context:L,Canvas:M});class ie extends Ht{_sceneFunc(t){var e=a.getAngle(this.angle()),n=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,e,n),t.arc(0,0,this.innerRadius(),e,0,!n),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}function ae(t,e,n,r,i,a,o){var s=Math.sqrt(Math.pow(n-t,2)+Math.pow(r-e,2)),h=Math.sqrt(Math.pow(i-n,2)+Math.pow(a-r,2)),u=o*s/(s+h),l=o*h/(s+h);return[n-u*(i-t),r-u*(a-e),n+l*(i-t),r+l*(a-e)]}function oe(t,e){var n,r,i=t.length,a=[];for(n=2;n<i-2;n+=2)r=ae(t[n-2],t[n-1],t[n],t[n+1],t[n+2],t[n+3],e),isNaN(r[0])||(a.push(r[0]),a.push(r[1]),a.push(t[n]),a.push(t[n+1]),a.push(r[2]),a.push(r[3]));return a}ie.prototype._centroid=!0,ie.prototype.className="Arc",ie.prototype._attrsAffectingSize=["innerRadius","outerRadius"],o(ie),P.addGetterSetter(ie,"innerRadius",0,y()),P.addGetterSetter(ie,"outerRadius",0,y()),P.addGetterSetter(ie,"angle",0,y()),P.addGetterSetter(ie,"clockwise",!1,S());class se extends Ht{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",(function(){this._clearCache("tensionPoints")}))}_sceneFunc(t){var e,n,r,i=this.points(),a=i.length,o=this.tension(),s=this.closed(),h=this.bezier();if(a){if(t.beginPath(),t.moveTo(i[0],i[1]),0!==o&&a>4){for(n=(e=this.getTensionPoints()).length,r=s?0:4,s||t.quadraticCurveTo(e[0],e[1],e[2],e[3]);r<n-2;)t.bezierCurveTo(e[r++],e[r++],e[r++],e[r++],e[r++],e[r++]);s||t.quadraticCurveTo(e[n-2],e[n-1],i[a-2],i[a-1])}else if(h)for(r=2;r<a;)t.bezierCurveTo(i[r++],i[r++],i[r++],i[r++],i[r++],i[r++]);else for(r=2;r<a;r+=2)t.lineTo(i[r],i[r+1]);s?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():oe(this.points(),this.tension())}_getTensionPointsClosed(){var t=this.points(),e=t.length,n=this.tension(),r=ae(t[e-2],t[e-1],t[0],t[1],t[2],t[3],n),i=ae(t[e-4],t[e-3],t[e-2],t[e-1],t[0],t[1],n),a=oe(t,n);return[r[2],r[3]].concat(a).concat([i[0],i[1],t[e-2],t[e-1],i[2],i[3],r[0],r[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){var t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};for(var e,n,r=(t=0!==this.tension()?[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:this.points())[0],i=t[0],a=t[1],o=t[1],s=0;s<t.length/2;s++)e=t[2*s],n=t[2*s+1],r=Math.min(r,e),i=Math.max(i,e),a=Math.min(a,n),o=Math.max(o,n);return{x:r,y:a,width:i-r,height:o-a}}}se.prototype.className="Line",se.prototype._attrsAffectingSize=["points","bezier","tension"],o(se),P.addGetterSetter(se,"closed",!1),P.addGetterSetter(se,"bezier",!1),P.addGetterSetter(se,"tension",0,y()),P.addGetterSetter(se,"points",[],function(){if(a.isUnminified)return function(t,e){return p._isArray(t)?t.forEach((function(t){p._isNumber(t)||p.warn('"'+e+'" attribute has non numeric element '+t+". Make sure that all elements are numbers.")})):p.warn(v(t)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.'),t}}());class he extends Ht{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this.dataArray=he.parsePathData(this.data()),this.pathLength=0;for(var e=0;e<this.dataArray.length;++e)this.pathLength+=this.dataArray[e].pathLength;this.on("dataChange.konva",(function(){this.dataArray=he.parsePathData(this.data()),this.pathLength=0;for(var t=0;t<this.dataArray.length;++t)this.pathLength+=this.dataArray[t].pathLength}))}_sceneFunc(t){var e=this.dataArray;t.beginPath();for(var n=!1,r=0;r<e.length;r++){var i=e[r].command,a=e[r].points;switch(i){case"L":t.lineTo(a[0],a[1]);break;case"M":t.moveTo(a[0],a[1]);break;case"C":t.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case"Q":t.quadraticCurveTo(a[0],a[1],a[2],a[3]);break;case"A":var o=a[0],s=a[1],h=a[2],u=a[3],l=a[4],c=a[5],f=a[6],d=a[7],g=h>u?h:u,p=h>u?1:h/u,v=h>u?u/h:1;t.translate(o,s),t.rotate(f),t.scale(p,v),t.arc(0,0,g,l,l+c,1-d),t.scale(1/p,1/v),t.rotate(-f),t.translate(-o,-s);break;case"z":n=!0,t.closePath()}}n||this.hasFill()?t.fillStrokeShape(this):t.strokeShape(this)}getSelfRect(){var t=[];this.dataArray.forEach((function(e){if("A"===e.command){var n=e.points[4],r=e.points[5],i=e.points[4]+r,a=Math.PI/180;if(Math.abs(n-i)<a&&(a=Math.abs(n-i)),r<0)for(let r=n-a;r>i;r-=a){const n=he.getPointOnEllipticalArc(e.points[0],e.points[1],e.points[2],e.points[3],r,0);t.push(n.x,n.y)}else for(let r=n+a;r<i;r+=a){const n=he.getPointOnEllipticalArc(e.points[0],e.points[1],e.points[2],e.points[3],r,0);t.push(n.x,n.y)}}else if("C"===e.command)for(let n=0;n<=1;n+=.01){const r=he.getPointOnCubicBezier(n,e.start.x,e.start.y,e.points[0],e.points[1],e.points[2],e.points[3],e.points[4],e.points[5]);t.push(r.x,r.y)}else t=t.concat(e.points)}));for(var e,n,r=t[0],i=t[0],a=t[1],o=t[1],s=0;s<t.length/2;s++)e=t[2*s],n=t[2*s+1],isNaN(e)||(r=Math.min(r,e),i=Math.max(i,e)),isNaN(n)||(a=Math.min(a,n),o=Math.max(o,n));return{x:Math.round(r),y:Math.round(a),width:Math.round(i-r),height:Math.round(o-a)}}getLength(){return this.pathLength}getPointAtLength(t){var e,n=0,r=this.dataArray.length;if(!r)return null;for(;n<r&&t>this.dataArray[n].pathLength;)t-=this.dataArray[n].pathLength,++n;if(n===r)return{x:(e=this.dataArray[n-1].points.slice(-2))[0],y:e[1]};if(t<.01)return{x:(e=this.dataArray[n].points.slice(0,2))[0],y:e[1]};var i=this.dataArray[n],a=i.points;switch(i.command){case"L":return he.getPointOnLine(t,i.start.x,i.start.y,a[0],a[1]);case"C":return he.getPointOnCubicBezier(t/i.pathLength,i.start.x,i.start.y,a[0],a[1],a[2],a[3],a[4],a[5]);case"Q":return he.getPointOnQuadraticBezier(t/i.pathLength,i.start.x,i.start.y,a[0],a[1],a[2],a[3]);case"A":var o=a[0],s=a[1],h=a[2],u=a[3],l=a[4],c=a[5],f=a[6];return l+=c*t/i.pathLength,he.getPointOnEllipticalArc(o,s,h,u,l,f)}return null}static getLineLength(t,e,n,r){return Math.sqrt((n-t)*(n-t)+(r-e)*(r-e))}static getPointOnLine(t,e,n,r,i,a,o){void 0===a&&(a=e),void 0===o&&(o=n);var s=(i-n)/(r-e+1e-8),h=Math.sqrt(t*t/(1+s*s));r<e&&(h*=-1);var u,l=s*h;if(r===e)u={x:a,y:o+l};else if((o-n)/(a-e+1e-8)===s)u={x:a+h,y:o+l};else{var c,f,d=this.getLineLength(e,n,r,i),g=(a-e)*(r-e)+(o-n)*(i-n);c=e+(g/=d*d)*(r-e),f=n+g*(i-n);var p=this.getLineLength(a,o,c,f),v=Math.sqrt(t*t-p*p);h=Math.sqrt(v*v/(1+s*s)),r<e&&(h*=-1),u={x:c+h,y:f+(l=s*h)}}return u}static getPointOnCubicBezier(t,e,n,r,i,a,o,s,h){function u(t){return t*t*t}function l(t){return 3*t*t*(1-t)}function c(t){return 3*t*(1-t)*(1-t)}function f(t){return(1-t)*(1-t)*(1-t)}return{x:s*u(t)+a*l(t)+r*c(t)+e*f(t),y:h*u(t)+o*l(t)+i*c(t)+n*f(t)}}static getPointOnQuadraticBezier(t,e,n,r,i,a,o){function s(t){return t*t}function h(t){return 2*t*(1-t)}function u(t){return(1-t)*(1-t)}return{x:a*s(t)+r*h(t)+e*u(t),y:o*s(t)+i*h(t)+n*u(t)}}static getPointOnEllipticalArc(t,e,n,r,i,a){var o=Math.cos(a),s=Math.sin(a),h=n*Math.cos(i),u=r*Math.sin(i);return{x:t+(h*o-u*s),y:e+(h*s+u*o)}}static parsePathData(t){if(!t)return[];var e=t,n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];e=e.replace(new RegExp(" ","g"),",");for(var r=0;r<n.length;r++)e=e.replace(new RegExp(n[r],"g"),"|"+n[r]);var i,a=e.split("|"),o=[],s=[],h=0,u=0,l=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;for(r=1;r<a.length;r++){var c=a[r],f=c.charAt(0);for(c=c.slice(1),s.length=0;i=l.exec(c);)s.push(i[0]);for(var d=[],g=0,p=s.length;g<p;g++)if("00"!==s[g]){var v=parseFloat(s[g]);isNaN(v)?d.push(0):d.push(v)}else d.push(0,0);for(;d.length>0&&!isNaN(d[0]);){var m,y,_,b,x,w,S,k,C,P,A=null,T=[],O=h,L=u;switch(f){case"l":h+=d.shift(),u+=d.shift(),A="L",T.push(h,u);break;case"L":h=d.shift(),u=d.shift(),T.push(h,u);break;case"m":var E=d.shift(),R=d.shift();if(h+=E,u+=R,A="M",o.length>2&&"z"===o[o.length-1].command)for(var M=o.length-2;M>=0;M--)if("M"===o[M].command){h=o[M].points[0]+E,u=o[M].points[1]+R;break}T.push(h,u),f="l";break;case"M":h=d.shift(),u=d.shift(),A="M",T.push(h,u),f="L";break;case"h":h+=d.shift(),A="L",T.push(h,u);break;case"H":h=d.shift(),A="L",T.push(h,u);break;case"v":u+=d.shift(),A="L",T.push(h,u);break;case"V":u=d.shift(),A="L",T.push(h,u);break;case"C":T.push(d.shift(),d.shift(),d.shift(),d.shift()),h=d.shift(),u=d.shift(),T.push(h,u);break;case"c":T.push(h+d.shift(),u+d.shift(),h+d.shift(),u+d.shift()),h+=d.shift(),u+=d.shift(),A="C",T.push(h,u);break;case"S":y=h,_=u,"C"===(m=o[o.length-1]).command&&(y=h+(h-m.points[2]),_=u+(u-m.points[3])),T.push(y,_,d.shift(),d.shift()),h=d.shift(),u=d.shift(),A="C",T.push(h,u);break;case"s":y=h,_=u,"C"===(m=o[o.length-1]).command&&(y=h+(h-m.points[2]),_=u+(u-m.points[3])),T.push(y,_,h+d.shift(),u+d.shift()),h+=d.shift(),u+=d.shift(),A="C",T.push(h,u);break;case"Q":T.push(d.shift(),d.shift()),h=d.shift(),u=d.shift(),T.push(h,u);break;case"q":T.push(h+d.shift(),u+d.shift()),h+=d.shift(),u+=d.shift(),A="Q",T.push(h,u);break;case"T":y=h,_=u,"Q"===(m=o[o.length-1]).command&&(y=h+(h-m.points[0]),_=u+(u-m.points[1])),h=d.shift(),u=d.shift(),A="Q",T.push(y,_,h,u);break;case"t":y=h,_=u,"Q"===(m=o[o.length-1]).command&&(y=h+(h-m.points[0]),_=u+(u-m.points[1])),h+=d.shift(),u+=d.shift(),A="Q",T.push(y,_,h,u);break;case"A":b=d.shift(),x=d.shift(),w=d.shift(),S=d.shift(),k=d.shift(),C=h,P=u,h=d.shift(),u=d.shift(),A="A",T=this.convertEndpointToCenterParameterization(C,P,h,u,S,k,b,x,w);break;case"a":b=d.shift(),x=d.shift(),w=d.shift(),S=d.shift(),k=d.shift(),C=h,P=u,h+=d.shift(),u+=d.shift(),A="A",T=this.convertEndpointToCenterParameterization(C,P,h,u,S,k,b,x,w)}o.push({command:A||f,points:T,start:{x:O,y:L},pathLength:this.calcLength(O,L,A||f,T)})}"z"!==f&&"Z"!==f||o.push({command:"z",points:[],start:void 0,pathLength:0})}return o}static calcLength(t,e,n,r){var i,a,o,s,h=he;switch(n){case"L":return h.getLineLength(t,e,r[0],r[1]);case"C":for(i=0,a=h.getPointOnCubicBezier(0,t,e,r[0],r[1],r[2],r[3],r[4],r[5]),s=.01;s<=1;s+=.01)o=h.getPointOnCubicBezier(s,t,e,r[0],r[1],r[2],r[3],r[4],r[5]),i+=h.getLineLength(a.x,a.y,o.x,o.y),a=o;return i;case"Q":for(i=0,a=h.getPointOnQuadraticBezier(0,t,e,r[0],r[1],r[2],r[3]),s=.01;s<=1;s+=.01)o=h.getPointOnQuadraticBezier(s,t,e,r[0],r[1],r[2],r[3]),i+=h.getLineLength(a.x,a.y,o.x,o.y),a=o;return i;case"A":i=0;var u=r[4],l=r[5],c=r[4]+l,f=Math.PI/180;if(Math.abs(u-c)<f&&(f=Math.abs(u-c)),a=h.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],u,0),l<0)for(s=u-f;s>c;s-=f)o=h.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],s,0),i+=h.getLineLength(a.x,a.y,o.x,o.y),a=o;else for(s=u+f;s<c;s+=f)o=h.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],s,0),i+=h.getLineLength(a.x,a.y,o.x,o.y),a=o;return o=h.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],c,0),i+h.getLineLength(a.x,a.y,o.x,o.y)}return 0}static convertEndpointToCenterParameterization(t,e,n,r,i,a,o,s,h){var u=h*(Math.PI/180),l=Math.cos(u)*(t-n)/2+Math.sin(u)*(e-r)/2,c=-1*Math.sin(u)*(t-n)/2+Math.cos(u)*(e-r)/2,f=l*l/(o*o)+c*c/(s*s);f>1&&(o*=Math.sqrt(f),s*=Math.sqrt(f));var d=Math.sqrt((o*o*(s*s)-o*o*(c*c)-s*s*(l*l))/(o*o*(c*c)+s*s*(l*l)));i===a&&(d*=-1),isNaN(d)&&(d=0);var g=d*o*c/s,p=d*-s*l/o,v=(t+n)/2+Math.cos(u)*g-Math.sin(u)*p,m=(e+r)/2+Math.sin(u)*g+Math.cos(u)*p,y=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])},_=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(y(t)*y(e))},b=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(_(t,e))},x=b([1,0],[(l-g)/o,(c-p)/s]),w=[(l-g)/o,(c-p)/s],S=[(-1*l-g)/o,(-1*c-p)/s],k=b(w,S);return _(w,S)<=-1&&(k=Math.PI),_(w,S)>=1&&(k=0),0===a&&k>0&&(k-=2*Math.PI),1===a&&k<0&&(k+=2*Math.PI),[v,m,o,s,x,k,u,a]}}he.prototype.className="Path",he.prototype._attrsAffectingSize=["data"],o(he),P.addGetterSetter(he,"data");class ue extends se{_sceneFunc(t){super._sceneFunc(t);var e=2*Math.PI,n=this.points(),r=n,i=0!==this.tension()&&n.length>4;i&&(r=this.getTensionPoints());var a,o,s=this.pointerLength(),h=n.length;if(i){const t=[r[r.length-4],r[r.length-3],r[r.length-2],r[r.length-1],n[h-2],n[h-1]],e=he.calcLength(r[r.length-4],r[r.length-3],"C",t),i=he.getPointOnQuadraticBezier(Math.min(1,1-s/e),t[0],t[1],t[2],t[3],t[4],t[5]);a=n[h-2]-i.x,o=n[h-1]-i.y}else a=n[h-2]-n[h-4],o=n[h-1]-n[h-3];var u=(Math.atan2(o,a)+e)%e,l=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(n[h-2],n[h-1]),t.rotate(u),t.moveTo(0,0),t.lineTo(-s,l/2),t.lineTo(-s,-l/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(n[0],n[1]),i?(a=(r[0]+r[2])/2-n[0],o=(r[1]+r[3])/2-n[1]):(a=n[2]-n[0],o=n[3]-n[1]),t.rotate((Math.atan2(-o,-a)+e)%e),t.moveTo(0,0),t.lineTo(-s,l/2),t.lineTo(-s,-l/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){var e=this.dashEnabled();e&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),e&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),e=this.pointerWidth()/2;return{x:t.x-e,y:t.y-e,width:t.width+2*e,height:t.height+2*e}}}ue.prototype.className="Arrow",o(ue),P.addGetterSetter(ue,"pointerLength",10,y()),P.addGetterSetter(ue,"pointerWidth",10,y()),P.addGetterSetter(ue,"pointerAtBeginning",!1),P.addGetterSetter(ue,"pointerAtEnding",!0);class le extends Ht{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,2*Math.PI,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}}le.prototype._centroid=!0,le.prototype.className="Circle",le.prototype._attrsAffectingSize=["radius"],o(le),P.addGetterSetter(le,"radius",0,y());class ce extends Ht{_sceneFunc(t){var e=this.radiusX(),n=this.radiusY();t.beginPath(),t.save(),e!==n&&t.scale(1,n/e),t.arc(0,0,e,0,2*Math.PI,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.radiusX()}getHeight(){return 2*this.radiusY()}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}ce.prototype.className="Ellipse",ce.prototype._centroid=!0,ce.prototype._attrsAffectingSize=["radiusX","radiusY"],o(ce),P.addComponentsGetterSetter(ce,"radius",["x","y"]),P.addGetterSetter(ce,"radiusX",0,y()),P.addGetterSetter(ce,"radiusY",0,y());class fe extends Ht{constructor(t){super(t),this.on("imageChange.konva",(()=>{this._setImageLoad()})),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&4===t.readyState||t&&t.addEventListener&&t.addEventListener("load",(()=>{this._requestDraw()}))}_useBufferCanvas(){return super._useBufferCanvas(!0)}_sceneFunc(t){const e=this.getWidth(),n=this.getHeight(),r=this.attrs.image;let i;if(r){const t=this.attrs.cropWidth,a=this.attrs.cropHeight;i=t&&a?[r,this.cropX(),this.cropY(),t,a,0,0,e,n]:[r,0,0,e,n]}(this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,e,n),t.closePath(),t.fillStrokeShape(this)),r&&t.drawImage.apply(t,i)}_hitFunc(t){var e=this.width(),n=this.height();t.beginPath(),t.rect(0,0,e,n),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,e;return null!==(t=this.attrs.width)&&void 0!==t?t:null===(e=this.image())||void 0===e?void 0:e.width}getHeight(){var t,e;return null!==(t=this.attrs.height)&&void 0!==t?t:null===(e=this.image())||void 0===e?void 0:e.height}static fromURL(t,e){var n=p.createImageElement();n.onload=function(){var t=new fe({image:n});e(t)},n.crossOrigin="Anonymous",n.src=t}}fe.prototype.className="Image",o(fe),P.addGetterSetter(fe,"image"),P.addComponentsGetterSetter(fe,"crop",["x","y","width","height"]),P.addGetterSetter(fe,"cropX",0,y()),P.addGetterSetter(fe,"cropY",0,y()),P.addGetterSetter(fe,"cropWidth",0,y()),P.addGetterSetter(fe,"cropHeight",0,y());var de=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height"],ge="up",pe="right",ve="down",me="left",ye=de.length;class _e extends Vt{constructor(t){super(t),this.on("add.konva",(function(t){this._addListeners(t.child),this._sync()}))}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){var e,n=this,r=function(){n._sync()};for(e=0;e<ye;e++)t.on(de[e]+"Change.konva",r)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){var t,e,n,r,i,a,o,s=this.getText(),h=this.getTag();if(s&&h){switch(t=s.width(),e=s.height(),n=h.pointerDirection(),r=h.pointerWidth(),o=h.pointerHeight(),i=0,a=0,n){case ge:i=t/2,a=-1*o;break;case pe:i=t+r,a=e/2;break;case ve:i=t/2,a=e+o;break;case me:i=-1*r,a=e/2}h.setAttrs({x:-1*i,y:-1*a,width:t,height:e}),s.setAttrs({x:-1*i,y:-1*a})}}}_e.prototype.className="Label",o(_e);class be extends Ht{_sceneFunc(t){var e=this.width(),n=this.height(),r=this.pointerDirection(),i=this.pointerWidth(),a=this.pointerHeight(),o=this.cornerRadius();let s=0,h=0,u=0,l=0;"number"==typeof o?s=h=u=l=Math.min(o,e/2,n/2):(s=Math.min(o[0]||0,e/2,n/2),h=Math.min(o[1]||0,e/2,n/2),l=Math.min(o[2]||0,e/2,n/2),u=Math.min(o[3]||0,e/2,n/2)),t.beginPath(),t.moveTo(s,0),r===ge&&(t.lineTo((e-i)/2,0),t.lineTo(e/2,-1*a),t.lineTo((e+i)/2,0)),t.lineTo(e-h,0),t.arc(e-h,h,h,3*Math.PI/2,0,!1),r===pe&&(t.lineTo(e,(n-a)/2),t.lineTo(e+i,n/2),t.lineTo(e,(n+a)/2)),t.lineTo(e,n-l),t.arc(e-l,n-l,l,0,Math.PI/2,!1),r===ve&&(t.lineTo((e+i)/2,n),t.lineTo(e/2,n+a),t.lineTo((e-i)/2,n)),t.lineTo(u,n),t.arc(u,n-u,u,Math.PI/2,Math.PI,!1),r===me&&(t.lineTo(0,(n+a)/2),t.lineTo(-1*i,n/2),t.lineTo(0,(n-a)/2)),t.lineTo(0,s),t.arc(s,s,s,Math.PI,3*Math.PI/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){var t=0,e=0,n=this.pointerWidth(),r=this.pointerHeight(),i=this.pointerDirection(),a=this.width(),o=this.height();return i===ge?(e-=r,o+=r):i===ve?o+=r:i===me?(t-=1.5*n,a+=n):i===pe&&(a+=1.5*n),{x:t,y:e,width:a,height:o}}}be.prototype.className="Tag",o(be),P.addGetterSetter(be,"pointerDirection","none"),P.addGetterSetter(be,"pointerWidth",0,y()),P.addGetterSetter(be,"pointerHeight",0,y()),P.addGetterSetter(be,"cornerRadius",0,_(4));class xe extends Ht{_sceneFunc(t){var e=this.cornerRadius(),n=this.width(),r=this.height();if(t.beginPath(),e){let i=0,a=0,o=0,s=0;"number"==typeof e?i=a=o=s=Math.min(e,n/2,r/2):(i=Math.min(e[0]||0,n/2,r/2),a=Math.min(e[1]||0,n/2,r/2),s=Math.min(e[2]||0,n/2,r/2),o=Math.min(e[3]||0,n/2,r/2)),t.moveTo(i,0),t.lineTo(n-a,0),t.arc(n-a,a,a,3*Math.PI/2,0,!1),t.lineTo(n,r-s),t.arc(n-s,r-s,s,0,Math.PI/2,!1),t.lineTo(o,r),t.arc(o,r-o,o,Math.PI/2,Math.PI,!1),t.lineTo(0,i),t.arc(i,i,i,Math.PI,3*Math.PI/2,!1)}else t.rect(0,0,n,r);t.closePath(),t.fillStrokeShape(this)}}xe.prototype.className="Rect",o(xe),P.addGetterSetter(xe,"cornerRadius",0,_(4));class we extends Ht{_sceneFunc(t){const e=this._getPoints();t.beginPath(),t.moveTo(e[0].x,e[0].y);for(var n=1;n<e.length;n++)t.lineTo(e[n].x,e[n].y);t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,e=this.attrs.radius||0,n=[];for(var r=0;r<t;r++)n.push({x:e*Math.sin(2*r*Math.PI/t),y:-1*e*Math.cos(2*r*Math.PI/t)});return n}getSelfRect(){const t=this._getPoints();var e=t[0].x,n=t[0].y,r=t[0].x,i=t[0].y;return t.forEach((t=>{e=Math.min(e,t.x),n=Math.max(n,t.x),r=Math.min(r,t.y),i=Math.max(i,t.y)})),{x:e,y:r,width:n-e,height:i-r}}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}we.prototype.className="RegularPolygon",we.prototype._centroid=!0,we.prototype._attrsAffectingSize=["radius"],o(we),P.addGetterSetter(we,"radius",0,y()),P.addGetterSetter(we,"sides",0,y());var Se=2*Math.PI;class ke extends Ht{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,Se,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),Se,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}ke.prototype.className="Ring",ke.prototype._centroid=!0,ke.prototype._attrsAffectingSize=["innerRadius","outerRadius"],o(ke),P.addGetterSetter(ke,"innerRadius",0,y()),P.addGetterSetter(ke,"outerRadius",0,y());class Ce extends Ht{constructor(t){super(t),this._updated=!0,this.anim=new $t((()=>{var t=this._updated;return this._updated=!1,t})),this.on("animationChange.konva",(function(){this.frameIndex(0)})),this.on("frameIndexChange.konva",(function(){this._updated=!0})),this.on("frameRateChange.konva",(function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())}))}_sceneFunc(t){var e=this.animation(),n=this.frameIndex(),r=4*n,i=this.animations()[e],a=this.frameOffsets(),o=i[r+0],s=i[r+1],h=i[r+2],u=i[r+3],l=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,h,u),t.closePath(),t.fillStrokeShape(this)),l)if(a){var c=a[e],f=2*n;t.drawImage(l,o,s,h,u,c[f+0],c[f+1],h,u)}else t.drawImage(l,o,s,h,u,0,0,h,u)}_hitFunc(t){var e=this.animation(),n=this.frameIndex(),r=4*n,i=this.animations()[e],a=this.frameOffsets(),o=i[r+2],s=i[r+3];if(t.beginPath(),a){var h=a[e],u=2*n;t.rect(h[u+0],h[u+1],o,s)}else t.rect(0,0,o,s);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){var t=this;this.interval=setInterval((function(){t._updateIndex()}),1e3/this.frameRate())}start(){if(!this.isRunning()){var t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){var t=this.frameIndex(),e=this.animation();t<this.animations()[e].length/4-1?this.frameIndex(t+1):this.frameIndex(0)}}Ce.prototype.className="Sprite",o(Ce),P.addGetterSetter(Ce,"animation"),P.addGetterSetter(Ce,"animations"),P.addGetterSetter(Ce,"frameOffsets"),P.addGetterSetter(Ce,"image"),P.addGetterSetter(Ce,"frameIndex",0,y()),P.addGetterSetter(Ce,"frameRate",17,y()),P.backCompat(Ce,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});class Pe extends Ht{_sceneFunc(t){var e=this.innerRadius(),n=this.outerRadius(),r=this.numPoints();t.beginPath(),t.moveTo(0,0-n);for(var i=1;i<2*r;i++){var a=i%2==0?n:e,o=a*Math.sin(i*Math.PI/r),s=-1*a*Math.cos(i*Math.PI/r);t.lineTo(o,s)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}function Ae(t){return Array.from(t)}Pe.prototype.className="Star",Pe.prototype._centroid=!0,Pe.prototype._attrsAffectingSize=["innerRadius","outerRadius"],o(Pe),P.addGetterSetter(Pe,"numPoints",5,y()),P.addGetterSetter(Pe,"innerRadius",0,y()),P.addGetterSetter(Pe,"outerRadius",0,y());var Te,Oe="auto",Le="justify",Ee="left",Re="middle",Me="normal",Ge=" ",Ie=["fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],De=Ie.length;function Fe(){return Te||(Te=p.createCanvasElement().getContext("2d"))}class Ne extends Ht{constructor(t){super(function(t){return(t=t||{}).fillLinearGradientColorStops||t.fillRadialGradientColorStops||t.fillPatternImage||(t.fill=t.fill||"black"),t}(t)),this._partialTextX=0,this._partialTextY=0;for(var e=0;e<De;e++)this.on(Ie[e]+"Change.konva",this._setTextData);this._setTextData()}_sceneFunc(t){var e=this.textArr,n=e.length;if(this.text()){var r,i=this.padding(),a=this.fontSize(),o=this.lineHeight()*a,s=this.verticalAlign(),h=0,u=this.align(),l=this.getWidth(),c=this.letterSpacing(),f=this.fill(),d=this.textDecoration(),g=-1!==d.indexOf("underline"),p=-1!==d.indexOf("line-through"),v=0,m=(v=o/2,0),y=0;for(t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",Re),t.setAttr("textAlign",Ee),s===Re?h=(this.getHeight()-n*o-2*i)/2:"bottom"===s&&(h=this.getHeight()-n*o-2*i),t.translate(i,h+i),r=0;r<n;r++){m=0,y=0;var _,b,x,w=e[r],S=w.text,k=w.width,C=r!==n-1;if(t.save(),"right"===u?m+=l-k-2*i:"center"===u&&(m+=(l-k-2*i)/2),g&&(t.save(),t.beginPath(),t.moveTo(m,v+y+Math.round(a/2)),b=0==(_=S.split(" ").length-1),x=u===Le&&C&&!b?l-2*i:k,t.lineTo(m+Math.round(x),v+y+Math.round(a/2)),t.lineWidth=a/15,t.strokeStyle=f,t.stroke(),t.restore()),p&&(t.save(),t.beginPath(),t.moveTo(m,v+y),b=0==(_=S.split(" ").length-1),x=u===Le&&C&&!b?l-2*i:k,t.lineTo(m+Math.round(x),v+y),t.lineWidth=a/15,t.strokeStyle=f,t.stroke(),t.restore()),0!==c||u===Le){_=S.split(" ").length-1;for(var P=Ae(S),A=0;A<P.length;A++){var T=P[A];" "===T&&r!==n-1&&u===Le&&(m+=(l-2*i-k)/_),this._partialTextX=m,this._partialTextY=v+y,this._partialText=T,t.fillStrokeShape(this),m+=this.measureSize(T).width+c}}else this._partialTextX=m,this._partialTextY=v+y,this._partialText=S,t.fillStrokeShape(this);t.restore(),n>1&&(v+=o)}}}_hitFunc(t){var e=this.getWidth(),n=this.getHeight();t.beginPath(),t.rect(0,0,e,n),t.closePath(),t.fillStrokeShape(this)}setText(t){var e=p._isString(t)?t:null==t?"":t+"";return this._setAttr("text",e),this}getWidth(){return this.attrs.width===Oe||void 0===this.attrs.width?this.getTextWidth()+2*this.padding():this.attrs.width}getHeight(){return this.attrs.height===Oe||void 0===this.attrs.height?this.fontSize()*this.textArr.length*this.lineHeight()+2*this.padding():this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return p.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var e,n=Fe(),r=this.fontSize();return n.save(),n.font=this._getContextFont(),e=n.measureText(t),n.restore(),{width:e.width,height:r}}_getContextFont(){return this.fontStyle()+Ge+this.fontVariant()+Ge+(this.fontSize()+"px ")+this.fontFamily().split(",").map((t=>{const e=(t=t.trim()).indexOf(" ")>=0,n=t.indexOf('"')>=0||t.indexOf("'")>=0;return e&&!n&&(t=`"${t}"`),t})).join(", ")}_addTextLine(t){this.align()===Le&&(t=t.trim());var e=this._getTextWidth(t);return this.textArr.push({text:t,width:e})}_getTextWidth(t){var e=this.letterSpacing(),n=t.length;return Fe().measureText(t).width+(n?e*(n-1):0)}_setTextData(){var t=this.text().split("\n"),e=+this.fontSize(),n=0,r=this.lineHeight()*e,i=this.attrs.width,a=this.attrs.height,o=i!==Oe&&void 0!==i,s=a!==Oe&&void 0!==a,h=this.padding(),u=i-2*h,l=a-2*h,c=0,f=this.wrap(),d="none"!==f,g="char"!==f&&d,p=this.ellipsis();this.textArr=[],Fe().font=this._getContextFont();for(var v=p?this._getTextWidth(""):0,m=0,y=t.length;m<y;++m){var _=t[m],b=this._getTextWidth(_);if(o&&b>u)for(;_.length>0;){for(var x=0,w=_.length,S="",k=0;x<w;){var C=x+w>>>1,P=_.slice(0,C+1),A=this._getTextWidth(P)+v;A<=u?(x=C+1,S=P,k=A):w=C}if(!S)break;if(g){var T,O=_[S.length];(T=(O===Ge||"-"===O)&&k<=u?S.length:Math.max(S.lastIndexOf(Ge),S.lastIndexOf("-"))+1)>0&&(x=T,S=S.slice(0,x),k=this._getTextWidth(S))}if(S=S.trimRight(),this._addTextLine(S),n=Math.max(n,k),c+=r,!d||s&&c+r>l){var L=this.textArr[this.textArr.length-1];L&&p&&(this._getTextWidth(L.text+"")<u||(L.text=L.text.slice(0,L.text.length-3)),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(L.text+""));break}if((_=(_=_.slice(x)).trimLeft()).length>0&&(b=this._getTextWidth(_))<=u){this._addTextLine(_),c+=r,n=Math.max(n,b);break}}else this._addTextLine(_),c+=r,n=Math.max(n,b);if(s&&c+r>l)break}this.textHeight=e,this.textWidth=n}getStrokeScaleEnabled(){return!0}}Ne.prototype._fillFunc=function(t){t.fillText(this._partialText,this._partialTextX,this._partialTextY)},Ne.prototype._strokeFunc=function(t){t.strokeText(this._partialText,this._partialTextX,this._partialTextY)},Ne.prototype.className="Text",Ne.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],o(Ne),P.overWriteSetter(Ne,"width",b()),P.overWriteSetter(Ne,"height",b()),P.addGetterSetter(Ne,"fontFamily","Arial"),P.addGetterSetter(Ne,"fontSize",12,y()),P.addGetterSetter(Ne,"fontStyle",Me),P.addGetterSetter(Ne,"fontVariant",Me),P.addGetterSetter(Ne,"padding",0,y()),P.addGetterSetter(Ne,"align",Ee),P.addGetterSetter(Ne,"verticalAlign","top"),P.addGetterSetter(Ne,"lineHeight",1,y()),P.addGetterSetter(Ne,"wrap","word"),P.addGetterSetter(Ne,"ellipsis",!1,S()),P.addGetterSetter(Ne,"letterSpacing",0,y()),P.addGetterSetter(Ne,"text","",x()),P.addGetterSetter(Ne,"textDecoration","");var je="normal";function Be(t){t.fillText(this.partialText,0,0)}function ze(t){t.strokeText(this.partialText,0,0)}class We extends Ht{constructor(t){super(t),this.dummyCanvas=p.createCanvasElement(),this.dataArray=[],this.dataArray=he.parsePathData(this.attrs.data),this.on("dataChange.konva",(function(){this.dataArray=he.parsePathData(this.attrs.data),this._setTextData()})),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva",this._setTextData),this._setTextData()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();var e=this.textDecoration(),n=this.fill(),r=this.fontSize(),i=this.glyphInfo;"underline"===e&&t.beginPath();for(var a=0;a<i.length;a++){t.save();var o=i[a].p0;t.translate(o.x,o.y),t.rotate(i[a].rotation),this.partialText=i[a].text,t.fillStrokeShape(this),"underline"===e&&(0===a&&t.moveTo(0,r/2+1),t.lineTo(r,r/2+1)),t.restore()}"underline"===e&&(t.strokeStyle=n,t.lineWidth=r/20,t.stroke()),t.restore()}_hitFunc(t){t.beginPath();var e=this.glyphInfo;if(e.length>=1){var n=e[0].p0;t.moveTo(n.x,n.y)}for(var r=0;r<e.length;r++){var i=e[r].p1;t.lineTo(i.x,i.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return p.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return Ne.prototype.setText.call(this,t)}_getContextFont(){return Ne.prototype._getContextFont.call(this)}_getTextSize(t){var e=this.dummyCanvas.getContext("2d");e.save(),e.font=this._getContextFont();var n=e.measureText(t);return e.restore(),{width:n.width,height:parseInt(this.attrs.fontSize,10)}}_setTextData(){var t=this,e=this._getTextSize(this.attrs.text),n=this.letterSpacing(),r=this.align(),i=this.kerningFunc();this.textWidth=e.width,this.textHeight=e.height;var a=Math.max(this.textWidth+((this.attrs.text||"").length-1)*n,0);this.glyphInfo=[];for(var o=0,s=0;s<t.dataArray.length;s++)t.dataArray[s].pathLength>0&&(o+=t.dataArray[s].pathLength);var h=0;"center"===r&&(h=Math.max(0,o/2-a/2)),"right"===r&&(h=Math.max(0,o-a));for(var u,l,c,f=Ae(this.text()),d=this.text().split(" ").length-1,g=-1,p=0,v=function(){p=0;for(var e=t.dataArray,n=g+1;n<e.length;n++){if(e[n].pathLength>0)return g=n,e[n];"M"===e[n].command&&(u={x:e[n].points[0],y:e[n].points[1]})}return{}},m=function(e){var i=t._getTextSize(e).width+n;" "===e&&"justify"===r&&(i+=(o-a)/d);var s=0,h=0;for(l=void 0;Math.abs(i-s)/i>.01&&h<20;){h++;for(var f=s;void 0===c;)(c=v())&&f+c.pathLength<i&&(f+=c.pathLength,c=void 0);if(c==={}||void 0===u)return;var g=!1;switch(c.command){case"L":he.getLineLength(u.x,u.y,c.points[0],c.points[1])>i?l=he.getPointOnLine(i,u.x,u.y,c.points[0],c.points[1],u.x,u.y):c=void 0;break;case"A":var m=c.points[4],y=c.points[5],_=c.points[4]+y;0===p?p=m+1e-8:i>s?p+=Math.PI/180*y/Math.abs(y):p-=Math.PI/360*y/Math.abs(y),(y<0&&p<_||y>=0&&p>_)&&(p=_,g=!0),l=he.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],p,c.points[6]);break;case"C":0===p?p=i>c.pathLength?1e-8:i/c.pathLength:i>s?p+=(i-s)/c.pathLength/2:p=Math.max(p-(s-i)/c.pathLength/2,0),p>1&&(p=1,g=!0),l=he.getPointOnCubicBezier(p,c.start.x,c.start.y,c.points[0],c.points[1],c.points[2],c.points[3],c.points[4],c.points[5]);break;case"Q":0===p?p=i/c.pathLength:i>s?p+=(i-s)/c.pathLength:p-=(s-i)/c.pathLength,p>1&&(p=1,g=!0),l=he.getPointOnQuadraticBezier(p,c.start.x,c.start.y,c.points[0],c.points[1],c.points[2],c.points[3])}void 0!==l&&(s=he.getLineLength(u.x,u.y,l.x,l.y)),g&&(g=!1,c=void 0)}},y=h/(t._getTextSize("C").width+n)-1,_=0;_<y&&(m("C"),void 0!==u&&void 0!==l);_++)u=l;for(var b=0;b<f.length&&(m(f[b]),void 0!==u&&void 0!==l);b++){var x=he.getLineLength(u.x,u.y,l.x,l.y),w=0;if(i)try{w=i(f[b-1],f[b])*this.fontSize()}catch(t){w=0}u.x+=w,l.x+=w,this.textWidth+=w;var S=he.getPointOnLine(w+x/2,u.x,u.y,l.x,l.y),k=Math.atan2(l.y-u.y,l.x-u.x);this.glyphInfo.push({transposeX:S.x,transposeY:S.y,text:f[b],rotation:k,p0:u,p1:l}),u=l}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};var t=[];this.glyphInfo.forEach((function(e){t.push(e.p0.x),t.push(e.p0.y),t.push(e.p1.x),t.push(e.p1.y)}));for(var e,n,r=t[0]||0,i=t[0]||0,a=t[1]||0,o=t[1]||0,s=0;s<t.length/2;s++)e=t[2*s],n=t[2*s+1],r=Math.min(r,e),i=Math.max(i,e),a=Math.min(a,n),o=Math.max(o,n);var h=this.fontSize();return{x:r-h/2,y:a-h/2,width:i-r+h,height:o-a+h}}}We.prototype._fillFunc=Be,We.prototype._strokeFunc=ze,We.prototype._fillFuncHit=Be,We.prototype._strokeFuncHit=ze,We.prototype.className="TextPath",We.prototype._attrsAffectingSize=["text","fontSize","data"],o(We),P.addGetterSetter(We,"data"),P.addGetterSetter(We,"fontFamily","Arial"),P.addGetterSetter(We,"fontSize",12,y()),P.addGetterSetter(We,"fontStyle",je),P.addGetterSetter(We,"align","left"),P.addGetterSetter(We,"letterSpacing",0,y()),P.addGetterSetter(We,"textBaseline","middle"),P.addGetterSetter(We,"fontVariant",je),P.addGetterSetter(We,"text",""),P.addGetterSetter(We,"textDecoration",null),P.addGetterSetter(We,"kerningFunc",null);var He=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange"].map((t=>t+".tr-konva")).join(" "),Ue="nodesRect",Ye=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"].map((t=>t+".tr-konva")).join(" "),qe={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135};const Xe="ontouchstart"in a._global;var Ve=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function Ke(t,e,n){const r=n.x+(t.x-n.x)*Math.cos(e)-(t.y-n.y)*Math.sin(e),i=n.y+(t.x-n.x)*Math.sin(e)+(t.y-n.y)*Math.cos(e);return Object.assign(Object.assign({},t),{rotation:t.rotation+e,x:r,y:i})}class $e extends Vt{constructor(t){super(t),this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(He,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return p.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}setNodes(t=[]){return this._nodes&&this._nodes.length&&this.detach(),this._nodes=t,1===t.length&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach((t=>{const e=t._attrsAffectingSize.map((t=>t+"Change.tr-konva")).join(" "),n=()=>{1===this.nodes().length&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),this._transforming||this.isDragging()||this.update()};t.on(e,n),t.on(Ye,n),t.on("absoluteTransformChange.tr-konva",n),t.on("xChange.tr-konva yChange.tr-konva",n),this._proxyDrag(t)})),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let e;t.on("dragstart.tr-konva",(n=>{e=t.getAbsolutePosition(),this.isDragging()||t===this.findOne(".back")||this.startDrag(n,!1)})),t.on("dragmove.tr-konva",(n=>{if(!e)return;const r=t.getAbsolutePosition(),i=r.x-e.x,a=r.y-e.y;this.nodes().forEach((e=>{if(e===t)return;if(e.isDragging())return;const r=e.getAbsolutePosition();e.setAbsolutePosition({x:r.x+i,y:r.y+a}),e.startDrag(n)})),e=null}))}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach((t=>{t.off(".tr-konva")})),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(Ue),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(Ue,this.__getNodeRect)}__getNodeShape(t,e=this.rotation(),n){var r=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),i=t.getAbsoluteScale(n),o=t.getAbsolutePosition(n),s=r.x*i.x-t.offsetX()*i.x,h=r.y*i.y-t.offsetY()*i.y;const u=(a.getAngle(t.getAbsoluteRotation())+2*Math.PI)%(2*Math.PI);return Ke({x:o.x+s*Math.cos(u)+h*Math.sin(-u),y:o.y+h*Math.cos(u)+s*Math.sin(u),width:r.width*i.x,height:r.height*i.y,rotation:u},-a.getAngle(e),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const t=[];this.nodes().map((e=>{const n=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()});var r=[{x:n.x,y:n.y},{x:n.x+n.width,y:n.y},{x:n.x+n.width,y:n.y+n.height},{x:n.x,y:n.y+n.height}],i=e.getAbsoluteTransform();r.forEach((function(e){var n=i.point(e);t.push(n)}))}));const e=new s;var n,r,i,o;e.rotate(-a.getAngle(this.rotation())),t.forEach((function(t){var a=e.point(t);void 0===n&&(n=i=a.x,r=o=a.y),n=Math.min(n,a.x),r=Math.min(r,a.y),i=Math.max(i,a.x),o=Math.max(o,a.y)})),e.invert();const h=e.point({x:n,y:r});return{x:h.x,y:h.y,width:i-n,height:o-r,rotation:a.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Ve.forEach(function(t){this._createAnchor(t)}.bind(this)),this._createAnchor("rotater")}_createAnchor(t){var e=new xe({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:Xe?10:"auto"}),n=this;e.on("mousedown touchstart",(function(t){n._handleMouseDown(t)})),e.on("dragstart",(t=>{e.stopDrag(),t.cancelBubble=!0})),e.on("dragend",(t=>{t.cancelBubble=!0})),e.on("mouseenter",(()=>{var n=a.getAngle(this.rotation()),r=function(t,e){if("rotater"===t)return"crosshair";e+=p.degToRad(qe[t]||0);var n=(p.radToDeg(e)%360+360)%360;return p._inRange(n,337.5,360)||p._inRange(n,0,22.5)?"ns-resize":p._inRange(n,22.5,67.5)?"nesw-resize":p._inRange(n,67.5,112.5)?"ew-resize":p._inRange(n,112.5,157.5)?"nwse-resize":p._inRange(n,157.5,202.5)?"ns-resize":p._inRange(n,202.5,247.5)?"nesw-resize":p._inRange(n,247.5,292.5)?"ew-resize":p._inRange(n,292.5,337.5)?"nwse-resize":(p.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}(t,n);e.getStage().content&&(e.getStage().content.style.cursor=r),this._cursorChange=!0})),e.on("mouseout",(()=>{e.getStage().content&&(e.getStage().content.style.cursor=""),this._cursorChange=!1})),this.add(e)}_createBack(){var t=new Ht({name:"back",width:0,height:0,draggable:!0,sceneFunc(t){var e=this.getParent(),n=e.padding();t.beginPath(),t.rect(-n,-n,this.width()+2*n,this.height()+2*n),t.moveTo(this.width()/2,-n),e.rotateEnabled()&&t.lineTo(this.width()/2,-e.rotateAnchorOffset()*p._sign(this.height())-n),t.fillStrokeShape(this)},hitFunc:(t,e)=>{if(this.shouldOverdrawWholeArea()){var n=this.padding();t.beginPath(),t.rect(-n,-n,e.width()+2*n,e.height()+2*n),t.fillStrokeShape(e)}}});this.add(t),this._proxyDrag(t),t.on("dragstart",(t=>{t.cancelBubble=!0})),t.on("dragmove",(t=>{t.cancelBubble=!0})),t.on("dragend",(t=>{t.cancelBubble=!0})),this.on("dragmove",(t=>{this.update()}))}_handleMouseDown(t){this._movingAnchorName=t.target.name().split(" ")[0];var e=this._getNodeRect(),n=e.width,r=e.height,i=Math.sqrt(Math.pow(n,2)+Math.pow(r,2));this.sin=Math.abs(r/i),this.cos=Math.abs(n/i),"undefined"!=typeof window&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;var a=t.target.getAbsolutePosition(),o=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:o.x-a.x,y:o.y-a.y},this._fire("transformstart",{evt:t,target:this.getNode()}),this._nodes.forEach((e=>{e._fire("transformstart",{evt:t,target:e})}))}_handleMouseMove(t){var e,n,r,i=this.findOne("."+this._movingAnchorName),o=i.getStage();o.setPointersPositions(t);const s=o.getPointerPosition();var h={x:s.x-this._anchorDragOffset.x,y:s.y-this._anchorDragOffset.y};const u=i.getAbsolutePosition();i.setAbsolutePosition(h);const l=i.getAbsolutePosition();if(u.x!==l.x||u.y!==l.y)if("rotater"!==this._movingAnchorName){var c=this.keepRatio()||t.shiftKey,f=this.centeredScaling()||t.altKey;if("top-left"===this._movingAnchorName){if(c){var d=f?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};r=Math.sqrt(Math.pow(d.x-i.x(),2)+Math.pow(d.y-i.y(),2));var g=this.findOne(".top-left").x()>d.x?-1:1,p=this.findOne(".top-left").y()>d.y?-1:1;e=r*this.cos*g,n=r*this.sin*p,this.findOne(".top-left").x(d.x-e),this.findOne(".top-left").y(d.y-n)}}else if("top-center"===this._movingAnchorName)this.findOne(".top-left").y(i.y());else if("top-right"===this._movingAnchorName){c&&(d=f?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()},r=Math.sqrt(Math.pow(i.x()-d.x,2)+Math.pow(d.y-i.y(),2)),g=this.findOne(".top-right").x()<d.x?-1:1,p=this.findOne(".top-right").y()>d.y?-1:1,e=r*this.cos*g,n=r*this.sin*p,this.findOne(".top-right").x(d.x+e),this.findOne(".top-right").y(d.y-n));var v=i.position();this.findOne(".top-left").y(v.y),this.findOne(".bottom-right").x(v.x)}else"middle-left"===this._movingAnchorName?this.findOne(".top-left").x(i.x()):"middle-right"===this._movingAnchorName?this.findOne(".bottom-right").x(i.x()):"bottom-left"===this._movingAnchorName?(c&&(d=f?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()},r=Math.sqrt(Math.pow(d.x-i.x(),2)+Math.pow(i.y()-d.y,2)),g=d.x<i.x()?-1:1,p=i.y()<d.y?-1:1,e=r*this.cos*g,n=r*this.sin*p,i.x(d.x-e),i.y(d.y+n)),v=i.position(),this.findOne(".top-left").x(v.x),this.findOne(".bottom-right").y(v.y)):"bottom-center"===this._movingAnchorName?this.findOne(".bottom-right").y(i.y()):"bottom-right"===this._movingAnchorName?c&&(d=f?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()},r=Math.sqrt(Math.pow(i.x()-d.x,2)+Math.pow(i.y()-d.y,2)),g=this.findOne(".bottom-right").x()<d.x?-1:1,p=this.findOne(".bottom-right").y()<d.y?-1:1,e=r*this.cos*g,n=r*this.sin*p,this.findOne(".bottom-right").x(d.x+e),this.findOne(".bottom-right").y(d.y+n)):console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(f=this.centeredScaling()||t.altKey){var m=this.findOne(".top-left"),y=this.findOne(".bottom-right"),_=m.x(),b=m.y(),x=this.getWidth()-y.x(),w=this.getHeight()-y.y();y.move({x:-_,y:-b}),m.move({x,y:w})}var S=this.findOne(".top-left").getAbsolutePosition();e=S.x,n=S.y;var k=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),C=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:e,y:n,width:k,height:C,rotation:a.getAngle(this.rotation())},t)}else{var P=this._getNodeRect();e=i.x()-P.width/2,n=-i.y()+P.height/2;let r=Math.atan2(-n,e)+Math.PI/2;P.height<0&&(r-=Math.PI);const o=a.getAngle(this.rotation())+r,s=a.getAngle(this.rotationSnapTolerance()),h=function(t,e){return Ke(t,e,function(t){return{x:t.x+t.width/2*Math.cos(t.rotation)+t.height/2*Math.sin(-t.rotation),y:t.y+t.height/2*Math.cos(t.rotation)+t.width/2*Math.sin(t.rotation)}}(t))}(P,function(t,e,n){let r=e;for(let i=0;i<t.length;i++){const o=a.getAngle(t[i]),s=Math.abs(o-e)%(2*Math.PI);Math.min(s,2*Math.PI-s)<n&&(r=o)}return r}(this.rotationSnaps(),o,s)-P.rotation);this._fitNodesInto(h,t)}}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){if(this._transforming){this._transforming=!1,"undefined"!=typeof window&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));var e=this.getNode();this._fire("transformend",{evt:t,target:e}),e&&this._nodes.forEach((e=>{e._fire("transformend",{evt:t,target:e})})),this._movingAnchorName=null}}_fitNodesInto(t,e){var n=this._getNodeRect();if(p._inRange(t.width,2*-this.padding()-1,1))return void this.update();if(p._inRange(t.height,2*-this.padding()-1,1))return void this.update();const r=this.flipEnabled();var i=new s;if(i.rotate(a.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const e=i.point({x:2*-this.padding(),y:0});if(t.x+=e.x,t.y+=e.y,t.width+=2*this.padding(),this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,!r)return void this.update()}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const e=i.point({x:2*this.padding(),y:0});if(this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,t.width+=2*this.padding(),!r)return void this.update()}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const e=i.point({x:0,y:2*-this.padding()});if(t.x+=e.x,t.y+=e.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,t.height+=2*this.padding(),!r)return void this.update()}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const e=i.point({x:0,y:2*this.padding()});if(this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,t.height+=2*this.padding(),!r)return void this.update()}if(this.boundBoxFunc()){const e=this.boundBoxFunc()(n,t);e?t=e:p.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const o=1e7,h=new s;h.translate(n.x,n.y),h.rotate(n.rotation),h.scale(n.width/o,n.height/o);const u=new s;u.translate(t.x,t.y),u.rotate(t.rotation),u.scale(t.width/o,t.height/o);const l=u.multiply(h.invert());this._nodes.forEach((t=>{var n;const r=t.getParent().getAbsoluteTransform(),i=t.getTransform().copy();i.translate(t.offsetX(),t.offsetY());const a=new s;a.multiply(r.copy().invert()).multiply(l).multiply(r).multiply(i);const o=a.decompose();t.setAttrs(o),this._fire("transform",{evt:e,target:t}),t._fire("transform",{evt:e,target:t}),null===(n=t.getLayer())||void 0===n||n.batchDraw()})),this.rotation(p._getRotation(t.rotation)),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,e){this.findOne(t).setAttrs(e)}update(){var t,e=this._getNodeRect();this.rotation(p._getRotation(e.rotation));var n=e.width,r=e.height,i=this.enabledAnchors(),a=this.resizeEnabled(),o=this.padding(),s=this.anchorSize();this.find("._anchor").forEach((t=>{t.setAttrs({width:s,height:s,offsetX:s/2,offsetY:s/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})})),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:s/2+o,offsetY:s/2+o,visible:a&&i.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:n/2,y:0,offsetY:s/2+o,visible:a&&i.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:n,y:0,offsetX:s/2-o,offsetY:s/2+o,visible:a&&i.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:r/2,offsetX:s/2+o,visible:a&&i.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:n,y:r/2,offsetX:s/2-o,visible:a&&i.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:r,offsetX:s/2+o,offsetY:s/2-o,visible:a&&i.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:n/2,y:r,offsetY:s/2-o,visible:a&&i.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:n,y:r,offsetX:s/2-o,offsetY:s/2-o,visible:a&&i.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:n/2,y:-this.rotateAnchorOffset()*p._sign(r)-o,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:n,height:r,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0}),null===(t=this.getLayer())||void 0===t||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();var t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),Vt.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return Q.prototype.toObject.call(this)}}$e.prototype.className="Transformer",o($e),P.addGetterSetter($e,"enabledAnchors",Ve,(function(t){return t instanceof Array||p.warn("enabledAnchors value should be an array"),t instanceof Array&&t.forEach((function(t){-1===Ve.indexOf(t)&&p.warn("Unknown anchor name: "+t+". Available names are: "+Ve.join(", "))})),t||[]})),P.addGetterSetter($e,"flipEnabled",!0,S()),P.addGetterSetter($e,"resizeEnabled",!0),P.addGetterSetter($e,"anchorSize",10,y()),P.addGetterSetter($e,"rotateEnabled",!0),P.addGetterSetter($e,"rotationSnaps",[]),P.addGetterSetter($e,"rotateAnchorOffset",50,y()),P.addGetterSetter($e,"rotationSnapTolerance",5,y()),P.addGetterSetter($e,"borderEnabled",!0),P.addGetterSetter($e,"anchorStroke","rgb(0, 161, 255)"),P.addGetterSetter($e,"anchorStrokeWidth",1,y()),P.addGetterSetter($e,"anchorFill","white"),P.addGetterSetter($e,"anchorCornerRadius",0,y()),P.addGetterSetter($e,"borderStroke","rgb(0, 161, 255)"),P.addGetterSetter($e,"borderStrokeWidth",1,y()),P.addGetterSetter($e,"borderDash"),P.addGetterSetter($e,"keepRatio",!0),P.addGetterSetter($e,"centeredScaling",!1),P.addGetterSetter($e,"ignoreStroke",!1),P.addGetterSetter($e,"padding",0,y()),P.addGetterSetter($e,"node"),P.addGetterSetter($e,"nodes"),P.addGetterSetter($e,"boundBoxFunc"),P.addGetterSetter($e,"shouldOverdrawWholeArea",!1),P.addGetterSetter($e,"useSingleNodeRotation",!0),P.backCompat($e,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});class Je extends Ht{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,a.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}function Qe(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}Je.prototype.className="Wedge",Je.prototype._centroid=!0,Je.prototype._attrsAffectingSize=["radius"],o(Je),P.addGetterSetter(Je,"radius",0,y()),P.addGetterSetter(Je,"angle",0,y()),P.addGetterSetter(Je,"clockwise",!1),P.backCompat(Je,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var Ze=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],tn=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function en(t,e,n,r,i){var a=n-e,o=i-r;return 0===a?r+o/2:0===o?r:o*((t-e)/a)+r}function nn(t,e,n){var r=4*(n*t.width+e),i=[];return i.push(t.data[r++],t.data[r++],t.data[r++],t.data[r++]),i}function rn(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}P.addGetterSetter(Q,"blurRadius",0,y(),P.afterSetFilter),P.addGetterSetter(Q,"brightness",0,y(),P.afterSetFilter),P.addGetterSetter(Q,"contrast",0,y(),P.afterSetFilter),P.addGetterSetter(Q,"embossStrength",.5,y(),P.afterSetFilter),P.addGetterSetter(Q,"embossWhiteLevel",.5,y(),P.afterSetFilter),P.addGetterSetter(Q,"embossDirection","top-left",null,P.afterSetFilter),P.addGetterSetter(Q,"embossBlend",!1,null,P.afterSetFilter),P.addGetterSetter(Q,"enhance",0,y(),P.afterSetFilter),P.addGetterSetter(Q,"hue",0,y(),P.afterSetFilter),P.addGetterSetter(Q,"saturation",0,y(),P.afterSetFilter),P.addGetterSetter(Q,"luminance",0,y(),P.afterSetFilter),P.addGetterSetter(Q,"hue",0,y(),P.afterSetFilter),P.addGetterSetter(Q,"saturation",0,y(),P.afterSetFilter),P.addGetterSetter(Q,"value",0,y(),P.afterSetFilter),P.addGetterSetter(Q,"kaleidoscopePower",2,y(),P.afterSetFilter),P.addGetterSetter(Q,"kaleidoscopeAngle",0,y(),P.afterSetFilter),P.addGetterSetter(Q,"threshold",0,y(),P.afterSetFilter),P.addGetterSetter(Q,"noise",.2,y(),P.afterSetFilter),P.addGetterSetter(Q,"pixelSize",8,y(),P.afterSetFilter),P.addGetterSetter(Q,"levels",.5,y(),P.afterSetFilter),P.addGetterSetter(Q,"red",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),P.addGetterSetter(Q,"green",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),P.addGetterSetter(Q,"blue",0,m,P.afterSetFilter),P.addGetterSetter(Q,"red",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),P.addGetterSetter(Q,"green",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),P.addGetterSetter(Q,"blue",0,m,P.afterSetFilter),P.addGetterSetter(Q,"alpha",1,(function(t){return this._filterUpToDate=!1,t>1?1:t<0?0:t})),P.addGetterSetter(Q,"threshold",.5,y(),P.afterSetFilter);const an=re.Util._assign(re,{Arc:ie,Arrow:ue,Circle:le,Ellipse:ce,Image:fe,Label:_e,Tag:be,Line:se,Path:he,Rect:xe,RegularPolygon:we,Ring:ke,Sprite:Ce,Star:Pe,Text:Ne,TextPath:We,Transformer:$e,Wedge:Je,Filters:{Blur:function(t){var e=Math.round(this.blurRadius());e>0&&function(t,e){var n,r,i,a,o,s,h,u,l,c,f,d,g,p,v,m,y,_,b,x,w,S,k,C,P=t.data,A=t.width,T=t.height,O=e+e+1,L=A-1,E=T-1,R=e+1,M=R*(R+1)/2,G=new Qe,I=null,D=G,F=null,N=null,j=Ze[e],B=tn[e];for(i=1;i<O;i++)D=D.next=new Qe,i===R&&(I=D);for(D.next=G,h=s=0,r=0;r<T;r++){for(m=y=_=b=u=l=c=f=0,d=R*(x=P[s]),g=R*(w=P[s+1]),p=R*(S=P[s+2]),v=R*(k=P[s+3]),u+=M*x,l+=M*w,c+=M*S,f+=M*k,D=G,i=0;i<R;i++)D.r=x,D.g=w,D.b=S,D.a=k,D=D.next;for(i=1;i<R;i++)a=s+((L<i?L:i)<<2),u+=(D.r=x=P[a])*(C=R-i),l+=(D.g=w=P[a+1])*C,c+=(D.b=S=P[a+2])*C,f+=(D.a=k=P[a+3])*C,m+=x,y+=w,_+=S,b+=k,D=D.next;for(F=G,N=I,n=0;n<A;n++)P[s+3]=k=f*j>>B,0!==k?(k=255/k,P[s]=(u*j>>B)*k,P[s+1]=(l*j>>B)*k,P[s+2]=(c*j>>B)*k):P[s]=P[s+1]=P[s+2]=0,u-=d,l-=g,c-=p,f-=v,d-=F.r,g-=F.g,p-=F.b,v-=F.a,a=h+((a=n+e+1)<L?a:L)<<2,u+=m+=F.r=P[a],l+=y+=F.g=P[a+1],c+=_+=F.b=P[a+2],f+=b+=F.a=P[a+3],F=F.next,d+=x=N.r,g+=w=N.g,p+=S=N.b,v+=k=N.a,m-=x,y-=w,_-=S,b-=k,N=N.next,s+=4;h+=A}for(n=0;n<A;n++){for(y=_=b=m=l=c=f=u=0,d=R*(x=P[s=n<<2]),g=R*(w=P[s+1]),p=R*(S=P[s+2]),v=R*(k=P[s+3]),u+=M*x,l+=M*w,c+=M*S,f+=M*k,D=G,i=0;i<R;i++)D.r=x,D.g=w,D.b=S,D.a=k,D=D.next;for(o=A,i=1;i<=e;i++)s=o+n<<2,u+=(D.r=x=P[s])*(C=R-i),l+=(D.g=w=P[s+1])*C,c+=(D.b=S=P[s+2])*C,f+=(D.a=k=P[s+3])*C,m+=x,y+=w,_+=S,b+=k,D=D.next,i<E&&(o+=A);for(s=n,F=G,N=I,r=0;r<T;r++)P[3+(a=s<<2)]=k=f*j>>B,k>0?(k=255/k,P[a]=(u*j>>B)*k,P[a+1]=(l*j>>B)*k,P[a+2]=(c*j>>B)*k):P[a]=P[a+1]=P[a+2]=0,u-=d,l-=g,c-=p,f-=v,d-=F.r,g-=F.g,p-=F.b,v-=F.a,a=n+((a=r+R)<E?a:E)*A<<2,u+=m+=F.r=P[a],l+=y+=F.g=P[a+1],c+=_+=F.b=P[a+2],f+=b+=F.a=P[a+3],F=F.next,d+=x=N.r,g+=w=N.g,p+=S=N.b,v+=k=N.a,m-=x,y-=w,_-=S,b-=k,N=N.next,s+=A}}(t,e)},Brighten:function(t){var e,n=255*this.brightness(),r=t.data,i=r.length;for(e=0;e<i;e+=4)r[e]+=n,r[e+1]+=n,r[e+2]+=n},Contrast:function(t){var e,n=Math.pow((this.contrast()+100)/100,2),r=t.data,i=r.length,a=150,o=150,s=150;for(e=0;e<i;e+=4)a=r[e],o=r[e+1],s=r[e+2],a/=255,a-=.5,a*=n,a+=.5,o/=255,o-=.5,o*=n,o+=.5,s/=255,s-=.5,s*=n,s+=.5,a=(a*=255)<0?0:a>255?255:a,o=(o*=255)<0?0:o>255?255:o,s=(s*=255)<0?0:s>255?255:s,r[e]=a,r[e+1]=o,r[e+2]=s},Emboss:function(t){var e=10*this.embossStrength(),n=255*this.embossWhiteLevel(),r=this.embossDirection(),i=this.embossBlend(),a=0,o=0,s=t.data,h=t.width,u=t.height,l=4*h,c=u;switch(r){case"top-left":a=-1,o=-1;break;case"top":a=-1,o=0;break;case"top-right":a=-1,o=1;break;case"right":a=0,o=1;break;case"bottom-right":a=1,o=1;break;case"bottom":a=1,o=0;break;case"bottom-left":a=1,o=-1;break;case"left":a=0,o=-1;break;default:p.error("Unknown emboss direction: "+r)}do{var f=(c-1)*l,d=a;c+d<1&&(d=0),c+d>u&&(d=0);var g=(c-1+d)*h*4,v=h;do{var m=f+4*(v-1),y=o;v+y<1&&(y=0),v+y>h&&(y=0);var _=g+4*(v-1+y),b=s[m]-s[_],x=s[m+1]-s[_+1],w=s[m+2]-s[_+2],S=b,k=S>0?S:-S;if((x>0?x:-x)>k&&(S=x),(w>0?w:-w)>k&&(S=w),S*=e,i){var C=s[m]+S,P=s[m+1]+S,A=s[m+2]+S;s[m]=C>255?255:C<0?0:C,s[m+1]=P>255?255:P<0?0:P,s[m+2]=A>255?255:A<0?0:A}else{var T=n-S;T<0?T=0:T>255&&(T=255),s[m]=s[m+1]=s[m+2]=T}}while(--v)}while(--c)},Enhance:function(t){var e,n,r,i,a=t.data,o=a.length,s=a[0],h=s,u=a[1],l=u,c=a[2],f=c,d=this.enhance();if(0!==d){for(i=0;i<o;i+=4)(e=a[i+0])<s?s=e:e>h&&(h=e),(n=a[i+1])<u?u=n:n>l&&(l=n),(r=a[i+2])<c?c=r:r>f&&(f=r);var g,p,v,m,y,_,b,x,w;for(h===s&&(h=255,s=0),l===u&&(l=255,u=0),f===c&&(f=255,c=0),d>0?(p=h+d*(255-h),v=s-d*(s-0),y=l+d*(255-l),_=u-d*(u-0),x=f+d*(255-f),w=c-d*(c-0)):(p=h+d*(h-(g=.5*(h+s))),v=s+d*(s-g),y=l+d*(l-(m=.5*(l+u))),_=u+d*(u-m),x=f+d*(f-(b=.5*(f+c))),w=c+d*(c-b)),i=0;i<o;i+=4)a[i+0]=en(a[i+0],s,h,v,p),a[i+1]=en(a[i+1],u,l,_,y),a[i+2]=en(a[i+2],c,f,w,x)}},Grayscale:function(t){var e,n,r=t.data,i=r.length;for(e=0;e<i;e+=4)n=.34*r[e]+.5*r[e+1]+.16*r[e+2],r[e]=n,r[e+1]=n,r[e+2]=n},HSL:function(t){var e,n,r,i,a,o=t.data,s=o.length,h=Math.pow(2,this.saturation()),u=Math.abs(this.hue()+360)%360,l=127*this.luminance(),c=1*h*Math.cos(u*Math.PI/180),f=1*h*Math.sin(u*Math.PI/180),d=.299+.701*c+.167*f,g=.587-.587*c+.33*f,p=.114-.114*c-.497*f,v=.299-.299*c-.328*f,m=.587+.413*c+.035*f,y=.114-.114*c+.293*f,_=.299-.3*c+1.25*f,b=.587-.586*c-1.05*f,x=.114+.886*c-.2*f;for(e=0;e<s;e+=4)n=o[e+0],r=o[e+1],i=o[e+2],a=o[e+3],o[e+0]=d*n+g*r+p*i+l,o[e+1]=v*n+m*r+y*i+l,o[e+2]=_*n+b*r+x*i+l,o[e+3]=a},HSV:function(t){var e,n,r,i,a,o=t.data,s=o.length,h=Math.pow(2,this.value()),u=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,c=h*u*Math.cos(l*Math.PI/180),f=h*u*Math.sin(l*Math.PI/180),d=.299*h+.701*c+.167*f,g=.587*h-.587*c+.33*f,p=.114*h-.114*c-.497*f,v=.299*h-.299*c-.328*f,m=.587*h+.413*c+.035*f,y=.114*h-.114*c+.293*f,_=.299*h-.3*c+1.25*f,b=.587*h-.586*c-1.05*f,x=.114*h+.886*c-.2*f;for(e=0;e<s;e+=4)n=o[e+0],r=o[e+1],i=o[e+2],a=o[e+3],o[e+0]=d*n+g*r+p*i,o[e+1]=v*n+m*r+y*i,o[e+2]=_*n+b*r+x*i,o[e+3]=a},Invert:function(t){var e,n=t.data,r=n.length;for(e=0;e<r;e+=4)n[e]=255-n[e],n[e+1]=255-n[e+1],n[e+2]=255-n[e+2]},Kaleidoscope:function(t){var e,n,r,i,a,o,s,h,u,l=t.width,c=t.height,f=Math.round(this.kaleidoscopePower()),d=Math.round(this.kaleidoscopeAngle()),g=Math.floor(l*(d%360)/360);if(!(f<1)){var v=p.createCanvasElement();v.width=l,v.height=c;var m=v.getContext("2d").getImageData(0,0,l,c);!function(t,e,n){var r,i,a,o,s=t.data,h=e.data,u=t.width,l=t.height,c=n.polarCenterX||u/2,f=n.polarCenterY||l/2,d=0,g=0,p=0,v=0,m=Math.sqrt(c*c+f*f);i=u-c,a=l-f,m=(o=Math.sqrt(i*i+a*a))>m?o:m;var y,_,b,x,w=l,S=u,k=360/S*Math.PI/180;for(_=0;_<S;_+=1)for(b=Math.sin(_*k),x=Math.cos(_*k),y=0;y<w;y+=1)i=Math.floor(c+m*y/w*x),d=s[0+(r=4*((a=Math.floor(f+m*y/w*b))*u+i))],g=s[r+1],p=s[r+2],v=s[r+3],h[0+(r=4*(_+y*u))]=d,h[r+1]=g,h[r+2]=p,h[r+3]=v}(t,m,{polarCenterX:l/2,polarCenterY:c/2});for(var y=l/Math.pow(2,f);y<=8;)y*=2,f-=1;var _=y=Math.ceil(y),b=0,x=_,w=1;for(g+y>l&&(b=_,x=0,w=-1),n=0;n<c;n+=1)for(e=b;e!==x;e+=w)h=4*(l*n+Math.round(e+g)%l),i=m.data[h+0],a=m.data[h+1],o=m.data[h+2],s=m.data[h+3],u=4*(l*n+e),m.data[u+0]=i,m.data[u+1]=a,m.data[u+2]=o,m.data[u+3]=s;for(n=0;n<c;n+=1)for(_=Math.floor(y),r=0;r<f;r+=1){for(e=0;e<_+1;e+=1)h=4*(l*n+e),i=m.data[h+0],a=m.data[h+1],o=m.data[h+2],s=m.data[h+3],u=4*(l*n+2*_-e-1),m.data[u+0]=i,m.data[u+1]=a,m.data[u+2]=o,m.data[u+3]=s;_*=2}!function(t,e,n){var r,i,a,o,s,h,u=t.data,l=e.data,c=t.width,f=t.height,d=n.polarCenterX||c/2,g=n.polarCenterY||f/2,p=0,v=0,m=0,y=0,_=Math.sqrt(d*d+g*g);i=c-d,a=f-g,_=(h=Math.sqrt(i*i+a*a))>_?h:_;var b,x,w,S=f,k=c,C=n.polarRotation||0;for(i=0;i<c;i+=1)for(a=0;a<f;a+=1)o=i-d,s=a-g,b=Math.sqrt(o*o+s*s)*S/_,x=(x=(180*Math.atan2(s,o)/Math.PI+360+C)%360)*k/360,w=Math.floor(x),p=u[0+(r=4*(Math.floor(b)*c+w))],v=u[r+1],m=u[r+2],y=u[r+3],l[0+(r=4*(a*c+i))]=p,l[r+1]=v,l[r+2]=m,l[r+3]=y}(m,t,{polarRotation:0})}},Mask:function(t){var e=function(t,e){var n=nn(t,0,0),r=nn(t,t.width-1,0),i=nn(t,0,t.height-1),a=nn(t,t.width-1,t.height-1),o=e||10;if(rn(n,r)<o&&rn(r,a)<o&&rn(a,i)<o&&rn(i,n)<o){for(var s=function(t){for(var e=[0,0,0],n=0;n<t.length;n++)e[0]+=t[n][0],e[1]+=t[n][1],e[2]+=t[n][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}([r,n,a,i]),h=[],u=0;u<t.width*t.height;u++){var l=rn(s,[t.data[4*u],t.data[4*u+1],t.data[4*u+2]]);h[u]=l<o?0:255}return h}}(t,this.threshold());return e&&function(t,e){for(var n=0;n<t.width*t.height;n++)t.data[4*n+3]=e[n]}(t,e=function(t,e,n){for(var r=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9],i=Math.round(Math.sqrt(r.length)),a=Math.floor(i/2),o=[],s=0;s<n;s++)for(var h=0;h<e;h++){for(var u=s*e+h,l=0,c=0;c<i;c++)for(var f=0;f<i;f++){var d=s+c-a,g=h+f-a;if(d>=0&&d<n&&g>=0&&g<e){var p=r[c*i+f];l+=t[d*e+g]*p}}o[u]=l}return o}(e=function(t,e,n){for(var r=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(r.length)),a=Math.floor(i/2),o=[],s=0;s<n;s++)for(var h=0;h<e;h++){for(var u=s*e+h,l=0,c=0;c<i;c++)for(var f=0;f<i;f++){var d=s+c-a,g=h+f-a;if(d>=0&&d<n&&g>=0&&g<e){var p=r[c*i+f];l+=t[d*e+g]*p}}o[u]=l>=1020?255:0}return o}(e=function(t,e,n){for(var r=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(r.length)),a=Math.floor(i/2),o=[],s=0;s<n;s++)for(var h=0;h<e;h++){for(var u=s*e+h,l=0,c=0;c<i;c++)for(var f=0;f<i;f++){var d=s+c-a,g=h+f-a;if(d>=0&&d<n&&g>=0&&g<e){var p=r[c*i+f];l+=t[d*e+g]*p}}o[u]=2040===l?255:0}return o}(e,t.width,t.height),t.width,t.height),t.width,t.height)),t},Noise:function(t){var e,n=255*this.noise(),r=t.data,i=r.length,a=n/2;for(e=0;e<i;e+=4)r[e+0]+=a-2*a*Math.random(),r[e+1]+=a-2*a*Math.random(),r[e+2]+=a-2*a*Math.random()},Pixelate:function(t){var e,n,r,i,a,o,s,h,u,l,c,f,d,g,v=Math.ceil(this.pixelSize()),m=t.width,y=t.height,_=Math.ceil(m/v),b=Math.ceil(y/v),x=t.data;if(v<=0)p.error("pixelSize value can not be <= 0");else for(f=0;f<_;f+=1)for(d=0;d<b;d+=1){for(i=0,a=0,o=0,s=0,u=(h=f*v)+v,c=(l=d*v)+v,g=0,e=h;e<u;e+=1)if(!(e>=m))for(n=l;n<c;n+=1)n>=y||(i+=x[0+(r=4*(m*n+e))],a+=x[r+1],o+=x[r+2],s+=x[r+3],g+=1);for(i/=g,a/=g,o/=g,s/=g,e=h;e<u;e+=1)if(!(e>=m))for(n=l;n<c;n+=1)n>=y||(x[0+(r=4*(m*n+e))]=i,x[r+1]=a,x[r+2]=o,x[r+3]=s)}},Posterize:function(t){var e,n=Math.round(254*this.levels())+1,r=t.data,i=r.length,a=255/n;for(e=0;e<i;e+=1)r[e]=Math.floor(r[e]/a)*a},RGB:function(t){var e,n,r=t.data,i=r.length,a=this.red(),o=this.green(),s=this.blue();for(e=0;e<i;e+=4)n=(.34*r[e]+.5*r[e+1]+.16*r[e+2])/255,r[e]=n*a,r[e+1]=n*o,r[e+2]=n*s,r[e+3]=r[e+3]},RGBA:function(t){var e,n,r=t.data,i=r.length,a=this.red(),o=this.green(),s=this.blue(),h=this.alpha();for(e=0;e<i;e+=4)n=1-h,r[e]=a*h+r[e]*n,r[e+1]=o*h+r[e+1]*n,r[e+2]=s*h+r[e+2]*n},Sepia:function(t){var e,n,r,i,a=t.data,o=a.length;for(e=0;e<o;e+=4)n=a[e+0],r=a[e+1],i=a[e+2],a[e+0]=Math.min(255,.393*n+.769*r+.189*i),a[e+1]=Math.min(255,.349*n+.686*r+.168*i),a[e+2]=Math.min(255,.272*n+.534*r+.131*i)},Solarize:function(t){var e=t.data,n=t.width,r=4*n,i=t.height;do{var a=(i-1)*r,o=n;do{var s=a+4*(o-1),h=e[s],u=e[s+1],l=e[s+2];h>127&&(h=255-h),u>127&&(u=255-u),l>127&&(l=255-l),e[s]=h,e[s+1]=u,e[s+2]=l}while(--o)}while(--i)},Threshold:function(t){var e,n=255*this.threshold(),r=t.data,i=r.length;for(e=0;e<i;e+=1)r[e]=r[e]<n?0:255}}})}}]);